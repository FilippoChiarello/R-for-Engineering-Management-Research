<document>

<filing_date>
2016-12-02
</filing_date>

<publication_date>
2020-11-03
</publication_date>

<priority_date>
2016-03-11
</priority_date>

<ipc_classes>
G06F16/28,G06F16/951,G06F17/30,G06F21/00,G06F21/62,H04L12/58,H04L29/06
</ipc_classes>

<assignee>
NETSKOPE
</assignee>

<inventors>
KULKARNI, ABHAY
NARAYANASWAMY KRISHNA
ITHAL, RAVI
CHENG, LEBIN
ANAND, CHETAN
CHOPRA, RAJNEESH
</inventors>

<docdb_family_id>
59787331
</docdb_family_id>

<title>
Systems and methods of enforcing multi-part policies on data-deficient transactions of cloud computing services
</title>

<abstract>
The technology disclosed relates to enforcing multi-part policies on data-deficient transactions of independent data stores. In particular, it relates to combining active analysis of access requests for the independent object stores with inspection of objects in the independent object stores, each of the analysis and inspection generating and persisting object metadata in a supplemental data store, actively processing data-deficient transactions that apply to the objects by accessing the supplemental data store to retrieve object metadata not available in transaction streams of the data-deficient transactions, and actively enforcing the multi-part policies using the retrieved object metadata.
</abstract>

<claims>
1. A method of actively enforcing multi-part policies on data-deficient transactions with independent data stores provided by a hosted service or a cloud service, the method including: applying active analysis of deposits of objects through a proxy for the independent data stores and inspection of objects deposited in the independent data stores bypassing the proxy, each of the analysis and inspection executed using a processor, generating and persisting object metadata in a supplemental data store; wherein the objects are content files or virtual machines or user profiles or application sessions or devices, the object metadata identifies sensitivity of the content files, and the object metadata is used when applying policies governing sensitivity of the object; actively processing data-deficient transactions that apply to the objects by accessing the supplemental data store to retrieve object metadata not available in transaction streams of the data-deficient transactions; wherein, a data-deficient transaction involves request message to the supplemental data store that requests a data manipulation activity that would cause manipulation of objects, wherein the request message does not include or provide the data or content in a transaction stream or activity that is necessary or required to enforce or apply a given a multi-part policy; and actively enforcing the multi-part policies using the retrieved object metadata, including wherein the data-deficient transaction is attachment of a first content file in a web-based e-mail of a sender and the multi-part policy prevents e-mailing a sensitive content file to recipients outside an organization of the sender, persisting sensitivity classification metadata of the first content file in the supplemental data store when the first content file traverses a security enforcement point for inclusion in an independent object store, prior to transmission of the web-based e-mail to the recipients looking up the persisted sensitivity classification metadata of the first content file when the data-deficient transaction substitutes a reference link to identify the first content file included in the independent object store, determining sensitivity of the first content file based on the sensitivity classification metadata, and triggering a security action based on the multi-part policy, including preventing transmission of the first content file to recipients outside the sender's organization when the first content file is determined to be sensitive.
2. The method of claim 1, wherein the data-deficient transaction is content file share of a first content file and the multi-part policy prevents sharing of a content file that is sensitive, further including: identifying a file identifier (ID) from the data-deficient transaction; looking up a file profile of the first content file in the supplemental data store; determining sensitivity of the first content file based on corresponding object metadata; and triggering a security action based on the multi-part policy.
3. The method of claim 1, wherein the data-deficient transaction is online access of a first content file within a cloud computing service (CCS) environment and the multi-part policy prevents online accessing of a content file with the CCS environment that is sensitive, further including: identifying a file identifier (ID) from the data-deficient transaction that includes a portion of the first content file; looking up a file profile of the first content file in the supplemental data store; determining sensitivity of the first content file based on corresponding object metadata; and triggering a security action based on the multi-part policy.
4. The method of claim 1, wherein the persisted sensitivity classification metadata classifies the first content file and the reference link identifying the first content file.
5. The method of claim 1, wherein the object metadata identify sharee lists for the content files.
6. The method of claim 1, wherein the object metadata identify owners of the content files.
7. The method of claim 1, wherein the object metadata identify a true file type of the content files.
8. The method of claim 7, wherein the data-deficient transaction is content file upload, download, or modification of a first content file having a first file type and the multi-part policy prevents upload, download, or modification of a particular file type different from the first file type, further including: identifying the first content file from the data-deficient transaction; looking up a file profile of the first content file in the supplemental data store; determining a true file type of the content file based on corresponding object metadata; and when the true file type fails to match the first file type, determining the first content file to be compromised and triggering a security action based on the multi-part policy.
9. The method of claim 7, wherein the data-deficient transaction is content file upload, download, or modification of a first content file having a first file type and the multi-part policy prevents upload, download, or modification of a particular file type different from the first file type, further including: identifying the first content file from the data-deficient transaction; looking up a file profile of the first content file in the supplemental data store; determining a true file type of the content file based on corresponding object metadata; and when the true file type matches the particular file type, triggering a security action based on the multi-part policy.
10. The method of claim 1, wherein the object metadata identify an integrity checksum of the content files.
11. The method of claim 10, further including detecting a data-deficient transaction that attempts to transfer a content file from a sanctioned cloud computing service (CCS) to an unsanctioned CCS through modification of a file identifier (ID) of the content file by: using an integrity checksum of the content file to look up a file profile of the content file in the supplemental data store; determining sensitivity of the first content file based on corresponding object metadata; and triggering a security action based on the multi-part policy.
12. The method of claim 10, further including detecting an attempt to bypass the multi-part policy with a data-deficient transaction that modifies a file identifier (ID) of a first content file by: using an integrity checksum of the first content file to look up a file profile of the first content file in the supplemental data store; determining sensitivity of the first content file based on corresponding object metadata; and triggering a security action based on the multi-part policy.
13. The method of claim 1, wherein the object metadata identify criticality levels of the virtual machines.
14. The method of claim 10, wherein the data-deficient transaction is deletion of a first virtual machine and the multi-part policy prevents deletion of a virtual machine if the virtual machine is critical, further including: identifying the first virtual machine from the data-deficient transaction; looking up a machine profile of the first virtual machine in the supplemental data store; determining a criticality level of the first virtual machine based on corresponding object metadata; and triggering a security action based on the multi-part policy.
15. The method of claim 1, wherein the object metadata identify anomalous user activity determined by an anomaly detection engine.
16. The method of claim 15, wherein the data-deficient transaction is content file upload, download, or modification by a first user and the multi-part policy prevents upload, download, or modification of a content file initiated by a compromised user, further including: identifying the first user from the data-deficient transaction; looking up a user profile of the first user in the supplemental data store; determining anomalous user activity of the first user based on corresponding object metadata; and triggering a security action based on the multi-part policy.
17. The method of claim 1, wherein the object metadata identify locations of users.
18. The method of claim 1, wherein the object metadata identify at-risk application sessions determined by an anomaly detection engine.
19. The method of claim 1, wherein the object metadata identify malicious devices determined by a malware detection engine.
20. The method of claim 19, wherein a data-deficient transaction is content file upload, download, or modification by a first device and the multi-part policy prevents upload, download, or modification of a content file initiated by an at-risk device, further including: identifying the first device from the data-deficient transaction; looking up a device profile of the first device in the supplemental data store; determining malicious activity via the first device based on corresponding object metadata; and triggering a security action based on the multi-part policy.
21. A non-transitory computer readable storage medium impressed with computer program instructions to actively enforce multi-part policies on data-deficient transactions with independent data stores provided by a hosted service or a cloud service, the instructions, when executed on a processor, implement a method comprising: applying active analysis of deposits of objects through a proxy for the independent data stores and inspection of objects deposited in the independent data stores bypassing the proxy, each of the analysis and inspection executed using a processor, generating and persisting object metadata in a supplemental data store; wherein the objects are content files or virtual machines or user profiles or application sessions or devices, the object metadata identifies sensitivity of the content files, and the object metadata is used when applying policies governing sensitivity of the object; actively processing data-deficient transactions that apply to the objects by accessing the supplemental data store to retrieve object metadata not available in transaction streams of the data-deficient transactions; wherein, a data-deficient transaction involves request message to the supplemental data store that requests a data manipulation activity that would cause manipulation of objects, wherein the request message does not include or provide the data or content in a transaction stream or activity that is necessary or required to enforce or apply a given a multi-part policy; and actively enforcing the multi-part policies using the retrieved object metadata, including wherein the data-deficient transaction is attachment of a first content file in a web-based e-mail of a sender and the multi-part policy prevents e-mailing a sensitive content file to recipients outside an organization of the sender, persisting sensitivity classification metadata of the first content file in the supplemental data store when the first content file traverses a security enforcement point for inclusion in an independent object store, prior to transmission of the web-based e-mail to the recipients looking up the persisted sensitivity classification metadata of the first content file when the data-deficient transaction substitutes a reference link to identify the first content file included in the independent object store, determining sensitivity of the first content file based on the sensitivity classification metadata, and triggering a security action based on the multi-part policy, including preventing transmission of the first content file to recipients outside the sender's organization when the first content file is determined to be sensitive.
22. A system including one or more processors coupled to memory, the memory loaded with computer instructions, the instructions, when executed on the processors, implement a method including: applying active analysis of deposits of objects through a proxy for the independent data stores and inspection of objects deposited in the independent data stores bypassing the proxy, each of the analysis and inspection executed using a processor, generating and persisting object metadata in a supplemental data store; wherein the objects are content files or virtual machines or user profiles or application sessions or devices, the object metadata identifies sensitivity of the content files, and the object metadata is used when applying policies governing sensitivity of the object; actively processing data-deficient transactions that apply to the objects by accessing the supplemental data store to retrieve object metadata not available in transaction streams of the data-deficient transactions; wherein, a data-deficient transaction involves request message to the supplemental data store that requests a data manipulation activity that would cause manipulation of objects, wherein the request message does not include or provide the data or content in a transaction stream or activity that is necessary or required to enforce or apply a given a multi-part policy; and actively enforcing the multi-part policies using the retrieved object metadata, including wherein the data-deficient transaction is attachment of a first content file in a web-based e-mail of a sender and the multi-part policy prevents e-mailing a sensitive content file to recipients outside an organization of the sender, persisting sensitivity classification metadata of the first content file in the supplemental data store when the first content file traverses a security enforcement point for inclusion in an independent object store, prior to transmission of the web-based e-mail to the recipients looking up the persisted sensitivity classification metadata of the first content file when the data-deficient transaction substitutes a reference link to identify the first content file included in the independent object store, determining sensitivity of the first content file based on the sensitivity classification metadata, and triggering a security action based on the multi-part policy, including preventing transmission of the first content file to recipients outside the sender's organization when the first content file is determined to be sensitive.
</claims>
</document>

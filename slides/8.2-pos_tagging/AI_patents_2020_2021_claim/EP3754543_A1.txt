<document>

<filing_date>
2020-05-14
</filing_date>

<publication_date>
2020-12-23
</publication_date>

<priority_date>
2019-05-16
</priority_date>

<ipc_classes>
G06K9/00,G06K9/62
</ipc_classes>

<assignee>
BASF (BADISCHE ANILIN & SODA FABRIK)
</assignee>

<inventors>
PICON, Artzai
ALVAREZ-GILA, Aitor
SEITZ, Maximilian
ORTIZ BARREDO, Amaia Maria
MOHNKE, Patrick
ECHAZARRA HUGUET, Jone
EGGERS, Till
NACHTMANN, Matthias
NAVARRA-MESTRE, Ramon
JOHANNES, Alexander
</inventors>

<docdb_family_id>
66589337
</docdb_family_id>

<title>
SYSTEM AND METHOD FOR PLANT DISEASE DETECTION SUPPORT
</title>

<abstract>
A computer-implemented method, computer program product and computer system (100) for detecting plant diseases. The system stores a convolutional neural network (120) trained with a multi-crop dataset. The convolutional neural network (120) has an extended topology comprising an image branch (121) based on a classification convolutional neural network for classifying the input images according to plant disease specific features, a crop identification branch (122) for adding plant species information, and a branch integrator for integrating the plant species information with each input image. The plant species information (20) specifies the crop on the respective input image (10). The system receives a test input comprising an image (10) of a particular crop (1) showing one or more particular plant disease symptoms, and further receives a respective crop identifier (20) associated with the test input via an interface (110). A classifier module (130) of the system applies the trained convolutional network (120) to the received test input, and provides a classification result (CR1) according to the output vector of the convolutional neural network (120). The classification result (CR1) indicates the one or more plant diseases associated with the one or more particular plant disease symptoms.
</abstract>

<claims>
1. A computer-implemented method (1000) for detecting plant diseases using a convolutional neural network (120) trained with a multi-crop dataset, the training dataset comprising training input images showing various crops, and each of the training input images shows a part of a particular crop with one or more disease symptoms associated with one or more diseases of interest, or shows a part of a particular crop with abiotic marks, or shows a healthy part of a particular crop, the convolutional neural network (120) with an extended topology comprising an image branch (121) based on a classification convolutional neural network for classifying test input images according to plant disease specific features, a crop identification branch (122) for adding plant species information, and a branch integrator for integrating the plant species information with each test input image, the plant species information (20) specifying the crop on the respective test input image (10), the method comprising: receiving (1100) a test input comprising an image of a particular crop showing one or more particular plant disease symptoms, and a respective crop identifier; applying (1200) the trained convolutional network (120) to the received test input; and providing (1300) a classification result according to the output vector of the convolutional neural network, the classification result indicating the one or more plant diseases associated with the one or more particular plant disease symptoms.
2. The method of claim 1, wherein approximately equal shares in the number of input images used for the training of the convolutional neural network belong to initial stages of an infection, early stages of the infection, medium stages of the infection, and advanced stages of the infection.
3. The method of any of the previous claims, wherein a new input image comprising a part showing a plant main portion with a main leaf or main stem or main panicle is cropped to a region surrounding the main portion, the main portion being segmented by a segmentation neural network with a pixel-wise categorical cross-entropy loss function being complemented with a total variation term.
4. The method of any of the previous claims, wherein the convolutional neural network topology comprises: a backbone topology implemented by a classification convolutional neural network topology configured to gradually reduce the dimensionality of the image representation in the spatial domain while growing on the feature domain being able to learn image representations as sets of high level features; following the backbone topology, an image representation layer with an average pooling operation integrating the high level features, and with a reshaping operation matching the dimensions of the average pooling output with the dimensions of the crop identification branch; following the image representation layer, a concatenation layer aggregating the crop identifier received via the crop identification branch into the output of the image representation layer by combining image descriptive features from the image representation layer with the information of the plant species present on the respective image; following the concatenation layer, a dense layer to map relationships between image high level features and respective crops with disease predictions using a sigmoid activation function; wherein the visual feature representation at the image representation layer and the subsequent crop-disease mapping are jointly learned.
5. The method of any of the claims 1 to 3, wherein the convolutional neural network topology comprises: a backbone topology implemented by a classification convolutional neural network topology configured to gradually reduce the dimensionality of the image representation in the spatial domain while growing on the feature domain being able to learn image representations as sets of high level features; following the backbone topology, an image representation layer with an average pooling operation integrating the high level features, and with a reshaping operation matching the dimensions of the average pooling output with the dimensions of the crop identification branch; the crop identification branch having a dense layer directly connected to the crop identifier input, with the number of neurons of the dense layer corresponding to the number of features at the image representation layer, and using a sigmoid activation function to map the resulting output into the range of [0,1]; following the image representation layer and the dense layer, a multiplication layer to integrate the output of the sigmoid activation function with the image representation layer by an elementwise multiplication; following the multiplication layer, a further dense layer to map relationships between image high level features and respective crops with disease predictions; wherein the visual feature representation at the image representation layer and the subsequent crop-disease mapping are jointly learned.
6. The method of any of the claims 1 to 3, wherein the convolutional neural network topology comprises: a backbone topology implemented by a classification convolutional neural network topology configured to gradually reduce the dimensionality of the image representation in the spatial domain while growing on the feature domain being able to learn image representations as sets of high level features; following the backbone topology, an image representation layer with an average pooling operation integrating the high level features, and with a reshaping operation matching the dimensions of the average pooling output with the dimensions of the crop identification branch; following the image representation layer, a first dense layer to map image high level features to disease predictions using a first sigmoid activation function; a second dense layer in the crop identification branch directly connected to the crop identifier, with the number of neurons of the fully connected dense layer corresponding to the number of features at the image representation layer, and using a second sigmoid activation function to map the resulting output into the range of [0,1]; following the first and second dense layers, a multiplication layer to suppress activations of diseases predicted by the first dense layer but not present on the plant species represented by the crop identifier by performing an elementwise multiplication of the activations; wherein the visual feature representation at the image representation layer and the subsequent crop-disease mapping are jointly learned.
7. The method of any of the claim 4 to 6, wherein the crop identification path is further configured to add further external data (21) together with the crop identifier (20), the further external data specifying particular environmental conditions associated with respective crop specific input image.
8. The method of any of the claims 4 to 7, with the backbone topology being pre-trained for crop disease identification with a dataset suitable for posterior fine-tuning.
9. A computer program product comprising instructions that, when loaded into a memory of a computing device and executed by at least one processor of the computing device, execute the method steps of the computer implemented method according to any one of the previous claims.
10. A computer system (100) for detecting plant diseases; the system comprising: a data storage component storing a convolutional neural network (120) trained with a multi-crop dataset, the training dataset comprising training input images showing various crops, and each of the training input images shows a part (11) of a particular crop with one or more disease symptoms associated with one or more diseases of interest, or shows a part of a particular crop with abiotic marks, or shows a healthy part of a particular crop, the convolutional neural network (120) with an extended topology comprising an image branch (121) based on a classification convolutional neural network for classifying test input images according to plant disease specific features, a crop identification branch (122) for adding plant species information, and a branch integrator for integrating the plant species information with each test input image, the plant species information (20) specifying the crop on the respective test input image (10); an interface (110) configured to receive a test input comprising an image (10) of a particular crop (1) showing one or more particular plant disease symptoms, and to receive a respective crop identifier (20) associated with the test input; and a classifier module (130) configured to apply the trained convolutional network (120) to the received test input, and to provide a classification result (CR1) according to the output vector of the convolutional neural network (120), the classification result (CR1) indicating the one or more plant diseases associated with the one or more particular plant disease symptoms.
11. The system of claim 10, further comprising an image cropping module configured to crop a new input image including a main leaf of the crop to a region surrounding the main leaf, the main leaf being segmented by a segmentation neural network with a pixel-wise categorical cross-entropy loss function being complemented with a total variation term.
12. The system of claim 10 or 11, wherein the convolutional neural network topology comprises: a backbone topology (121-1) implemented by a classification convolutional neural network topology configured to gradually reduce the dimensionality of the image representation in the spatial domain while growing on the feature domain to learn image representations as sets of high level features; following the backbone topology (121-1), an image representation layer with an average pooling operation (121-2) integrating the high level features, and with a reshaping operation (121-3) matching the dimensions of the average pooling output with the dimensions of the crop identification branch (122-1); following the image representation layer, a concatenation layer (123-1) aggregating the crop identifier (20) received via the crop identification branch (122-1) into the output of the image representation layer by combining image descriptive features from the image representation layer with the information of the plant species present on the respective image; following the concatenation layer, a dense layer (123-2) to map relationships between image high level features and respective crops with disease predictions using a sigmoid activation function (123-3); wherein the visual feature representation at the image representation layer and the subsequent crop-disease mapping are jointly learned.
13. The system of claim 10 or 11, wherein the convolutional neural network topology comprises: a backbone topology (221-1) implemented by a classification convolutional neural network topology configured to gradually reduce the dimensionality of the image representation in the spatial domain while growing on the feature domain to learn image representations as sets of high level features, the backbone topology (221-1); following the backbone topology, an image representation layer with an average pooling operation (221-2) integrating the high level features, and with a reshaping operation (221-3) matching the dimensions of the average pooling output with the dimensions of the crop identification branch; the crop identification branch having a dense layer (222-1) directly connected to the crop identifier (20), with the number of neurons of the dense layer corresponding to the number of features at the image representation layer, and using a sigmoid activation function (222-2) to map the resulting output into the range of [0,1]; following the image representation layer and the dense layer, a multiplication layer (223-1) to integrate the output of the sigmoid activation function (222-2) with the image representation layer by an elementwise multiplication; following the multiplication layer, a further dense layer (223-2) to map relationships between image high level features and respective crops with disease predictions; wherein the visual feature representation at the image representation layer and the subsequent crop-disease mapping are jointly learned.
14. The system of claim 10 or 11, wherein the convolutional neural network topology comprises: a backbone topology (321-1) implemented by a classification convolutional neural network topology configured to gradually reduce the dimensionality of the image representation in the spatial domain while growing on the feature domain to learn image representations as sets of high level features; following the backbone topology, an image representation layer with an average pooling operation (321-1) integrating the high level features, and with a reshaping operation (321-3) matching the dimensions of the average pooling output with the dimensions of the crop identification branch; following the image representation layer, a first dense layer (321-4) to map image high level features to disease predictions using a first sigmoid activation function (321-5); a second dense layer (322-1) in the crop identification branch directly connected to the crop identifier (20), with the number of neurons of the fully connected dense layer corresponding to the number of features at the image representation layer, and using a second sigmoid activation function (322-2) to map the resulting output into the range of [0,1]; following the first and second dense layers (321-4, 322-1) with their sigmoid activation functions, a multiplication layer(323-1) to suppress activations of diseases predicted by the first dense layer (321-4) but not present on the plant species represented by the crop identifier (20) by performing an elementwise multiplication of the activations; wherein the visual feature representation at the image representation layer and the subsequent crop-disease mapping are jointly learned.
15. The system of any of claims 10 to 14, wherein the backbone topology is based on a RESNET topology.
</claims>
</document>

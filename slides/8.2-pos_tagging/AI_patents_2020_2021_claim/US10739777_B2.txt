<document>

<filing_date>
2018-11-20
</filing_date>

<publication_date>
2020-08-11
</publication_date>

<priority_date>
2018-11-20
</priority_date>

<ipc_classes>
G05D1/00,G05D1/02,G06N20/00,G06N5/04
</ipc_classes>

<assignee>
WAYMO
</assignee>

<inventors>
REFAAT, KHALED
ROSS, STEPHANE
</inventors>

<docdb_family_id>
70726577
</docdb_family_id>

<title>
Trajectory representation in behavior prediction systems
</title>

<abstract>
Methods, systems, and apparatus, including computer programs encoded on a computer storage medium, for generating a representation of a trajectory of a target agent in an environment. In one aspect, the representation of the trajectory of the target agent in the environment is a concatenation of a plurality of channels, where each channel is represented as a two-dimensional array of data values. Each position in each channel corresponds to a respective spatial position in the environment, and corresponding positions in different channels correspond to the same spatial position in the environment. The channels include a time channel and a respective motion channel corresponding to each motion parameter in a predetermined set of motion parameters.
</abstract>

<claims>
1. A method performed by one or more data processing apparatus, the method comprising: obtaining historical data characterizing a trajectory of a target agent in an environment, the historical data comprising, for each of a plurality of previous time points, data defining: (i) a spatial position in the environment occupied by the target agent at the previous time point, and (ii) respective values of each motion parameter in a predetermined set of motion parameters, wherein the value of each motion parameter characterizes a respective feature of a motion of the target agent at the previous time point; generating a representation of the trajectory of the target agent in the environment, wherein: the representation of the trajectory of the target agent in the environment is a concatenation of a plurality of channels; each channel is represented as a two-dimensional array of data values; each position in each channel corresponds to a respective spatial position in the environment; corresponding positions in different channels correspond to the same spatial position in the environment; the channels comprise a time channel and a respective motion channel corresponding to each motion parameter in the predetermined set of motion parameters; and for each particular spatial position in the environment occupied by the target agent at a particular previous time point: the position in the time channel which corresponds to the particular spatial position defines the particular previous time point; and for each motion channel, the position in the motion channel which corresponds to the particular spatial position defines the value of the motion parameter corresponding to the motion channel at the particular previous time point; and processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after a current time point.
2. The method of claim 1, wherein obtaining the respective values of each motion parameter in the predetermined set of motion parameters for a previous time point comprises one or more of: obtaining the value of a velocity motion parameter which characterizes a velocity of the target agent at the previous time point; obtaining the value of an acceleration motion parameter which characterizes an acceleration of the target agent at the previous time point; and obtaining the value of a heading motion parameter which characterizes a heading of the target agent at the previous time point.
3. The method of claim 1, further comprising: processing the data characterizing the future trajectory of the target agent in the environment after the current time point using a planning system of a vehicle to generate a control output; and autonomously modifying operations of the vehicle based on the control output.
4. The method of claim 1, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: processing an input which comprises the representation of the trajectory of the target agent in the environment to generate data defining, for each of a plurality of spatial locations in the environment, a respective probability that the target agent will occupy the spatial location at a specified time point after the current time point.
5. The method of claim 1, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: processing an input comprising data defining a candidate future trajectory of the target agent in the environment after the current time point in addition to the representation of the trajectory of the target agent in the environment to generate data defining a probability that the future trajectory of the target agent is the candidate future trajectory of the target agent.
6. The method of claim 1, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: generating data defining respective probabilities that the target agent will make each of a predetermined number of possible driving decisions.
7. The method of claim 1, wherein generating a representation of the trajectory of the target agent in the environment comprises: generating a time channel and a respective motion channel corresponding to each motion parameter in the predetermined set of motion parameters which each represent a top-down perspective of the environment.
8. The method of claim 1, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network comprises: processing an input comprising one or more of: (i) a road-graph channel representing a known geometry of the environment, (ii) a target agent localization channel which represents a spatial position of the target agent in the environment at the current time point by a target agent bounding box, and (iii) an auxiliary localization channel which represents respective spatial positions of one or more other agents in the environment at the current time point by respective other agent bounding boxes.
9. The method of claim 1, further comprising: generating a joint representation of trajectories of a plurality of other agents in the environment; and processing an input which comprises the joint representation of the trajectories of the plurality of other agents in the environment, in addition to the representation of the trajectory of the target agent in the environment, using the convolutional neural network to generate data characterizing the future trajectory of the target agent in the environment after the current time point.
10. The method of claim 9, wherein: the joint representation of the trajectories of the plurality of other agents in the environment comprises an auxiliary time channel and a respective auxiliary motion channel corresponding to each motion parameter in the predetermined set of motion parameters; each channel is represented as a two-dimensional array of data values and each data value in each channel corresponds to a respective spatial position in the environment; and for each particular spatial position in the environment occupied by a particular other agent of the plurality of other agents at a particular previous time point: the data value in the auxiliary time channel which corresponds to the particular spatial position defines the particular previous time point; and for each auxiliary motion channel, the data value in the auxiliary motion channel which corresponds to the particular spatial position defines a value of the motion parameter corresponding to the auxiliary motion channel which characterizes a respective feature of a motion of the particular other agent at the particular previous time point.
11. A system, comprising: a data processing apparatus; a memory in data communication with the data processing apparatus and storing instructions that cause the data processing apparatus to perform operations comprising: obtaining historical data characterizing a trajectory of a target agent in an environment, the historical data comprising, for each of a plurality of previous time points, data defining: (i) a spatial position in the environment occupied by the target agent at the previous time point, and (ii) respective values of each motion parameter in a predetermined set of motion parameters, wherein the value of each motion parameter characterizes a respective feature of a motion of the target agent at the previous time point; generating a representation of the trajectory of the target agent in the environment, wherein: the representation of the trajectory of the target agent in the environment is a concatenation of a plurality of channels; each channel is represented as a two-dimensional array of data values; each position in each channel corresponds to a respective spatial position in the environment; corresponding positions in different channels correspond to the same spatial position in the environment; the channels comprise a time channel and a respective motion channel corresponding to each motion parameter in the predetermined set of motion parameters; and for each particular spatial position in the environment occupied by the target agent at a particular previous time point: the position in the time channel which corresponds to the particular spatial position defines the particular previous time point; and for each motion channel, the position in the motion channel which corresponds to the particular spatial position defines the value of the motion parameter corresponding to the motion channel at the particular previous time point; and processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after a current time point.
12. The system of claim 11, wherein obtaining the respective values of each motion parameter in the predetermined set of motion parameters for a previous time point comprises one or more of: obtaining the value of a velocity motion parameter which characterizes a velocity of the target agent at the previous time point; obtaining the value of an acceleration motion parameter which characterizes an acceleration of the target agent at the previous time point; and obtaining the value of a heading motion parameter which characterizes a heading of the target agent at the previous time point.
13. The system of claim 11, wherein the operations further comprise: processing the data characterizing the future trajectory of the target agent in the environment after the current time point using a planning system of a vehicle to generate a control output; and autonomously modifying operations of the vehicle based on the control output.
14. The system of claim 11, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: processing an input which comprises the representation of the trajectory of the target agent in the environment to generate data defining, for each of a plurality of spatial locations in the environment, a respective probability that the target agent will occupy the spatial location at a specified time point after the current time point.
15. The system of claim 11, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: processing an input comprising data defining a candidate future trajectory of the target agent in the environment after the current time point in addition to the representation of the trajectory of the target agent in the environment to generate data defining a probability that the future trajectory of the target agent is the candidate future trajectory of the target agent.
16. One or more non-transitory computer storage media storing instructions that when executed by one or more computers cause the one or more computers to perform operations comprising: obtaining historical data characterizing a trajectory of a target agent in an environment, the historical data comprising, for each of a plurality of previous time points, data defining: (i) a spatial position in the environment occupied by the target agent at the previous time point, and (ii) respective values of each motion parameter in a predetermined set of motion parameters, wherein the value of each motion parameter characterizes a respective feature of a motion of the target agent at the previous time point; generating a representation of the trajectory of the target agent in the environment, wherein: the representation of the trajectory of the target agent in the environment is a concatenation of a plurality of channels; each channel is represented as a two-dimensional array of data values; each position in each channel corresponds to a respective spatial position in the environment; corresponding positions in different channels correspond to the same spatial position in the environment; the channels comprise a time channel and a respective motion channel corresponding to each motion parameter in the predetermined set of motion parameters; and for each particular spatial position in the environment occupied by the target agent at a particular previous time point: the position in the time channel which corresponds to the particular spatial position defines the particular previous time point; and for each motion channel, the position in the motion channel which corresponds to the particular spatial position defines the value of the motion parameter corresponding to the motion channel at the particular previous time point; and processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after a current time point.
17. The non-transitory computer storage media of claim 16, wherein obtaining the respective values of each motion parameter in the predetermined set of motion parameters for a previous time point comprises one or more of: obtaining the value of a velocity motion parameter which characterizes a velocity of the target agent at the previous time point; obtaining the value of an acceleration motion parameter which characterizes an acceleration of the target agent at the previous time point; and obtaining the value of a heading motion parameter which characterizes a heading of the target agent at the previous time point.
18. The non-transitory computer storage media of claim 16, wherein the operations further comprise: processing the data characterizing the future trajectory of the target agent in the environment after the current time point using a planning system of a vehicle to generate a control output; and autonomously modifying operations of the vehicle based on the control output.
19. The non-transitory computer storage media of claim 16, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: processing an input which comprises the representation of the trajectory of the target agent in the environment to generate data defining, for each of a plurality of spatial locations in the environment, a respective probability that the target agent will occupy the spatial location at a specified time point after the current time point.
20. The non-transitory computer storage media of claim 16, wherein processing an input which comprises the representation of the trajectory of the target agent in the environment using a convolutional neural network to generate data characterizing a future trajectory of the target agent in the environment after the current time point comprises: processing an input comprising data defining a candidate future trajectory of the target agent in the environment after the current time point in addition to the representation of the trajectory of the target agent in the environment to generate data defining a probability that the future trajectory of the target agent is the candidate future trajectory of the target agent.
</claims>
</document>

<document>

<filing_date>
2019-06-27
</filing_date>

<publication_date>
2020-12-31
</publication_date>

<priority_date>
2019-06-27
</priority_date>

<ipc_classes>
G06T5/00,G06T5/20,G06T5/50,G06T7/521
</ipc_classes>

<assignee>
CHINESE UNIVERSITY OF HONG KONG
</assignee>

<inventors>
CHEN, SHIH-CHI
Chen, Jialong
Meng, Yunlong
</inventors>

<docdb_family_id>
74042899
</docdb_family_id>

<title>
METHOD FOR DATA ACQUISITION AND IMAGE PROCESSING FOR RECONSTRUCTING A SUPER-RESOLVED IMAGE
</title>

<abstract>
The present disclosure discloses a method, a data acquisition and image processing system and a non-transitory machine-readable medium for obtaining a super-resolved image of an object. The method comprises: obtaining a plurality of structured images of the object by structured light; determining, from the structured images, modulation information of each structured light that comprises spatial frequency, phase shift and modulation factor; initializing a sample image of the object according the structured images and initializing structured pattern of each structured light by the corresponding modulation information; and restoring the image with improved resolution by adjusting the sample image and the structured pattern iteratively.
</abstract>

<claims>
1. A method for obtaining a super-resolved image of an object, comprising: acquiring a plurality of structured images of the object by structured light; determining, from the structured images, modulation information of each structured light that comprises spatial frequency, phase shift and modulation factor; initializing a sample image of the object according the structured images and initializing structured pattern by the corresponding modulation information; and obtaining the super-resolved image by a plurality of epochs, wherein each epoch comprises: performing the following iteration for each structured pattern: determining a target image by applying the structured pattern to the sample image; updating frequency content of the determined target image according to difference between frequency content of the structured image and frequency content of the target image that is measurable to an imaging system used to capture the structured images; modifying the sample image as the super-resolved image according to difference between the target image and the target image obtained by the structured pattern adjusted in the last iteration; and adjusting the structured pattern by the updated target image and the modified sample image, wherein the plurality of epochs are continued until difference between the updated sample images within two last epochs is smaller than a predetermined value.
2. The method of claim 1, wherein the spatial frequency is obtained by: exploring image coordinates of a peak intensity position for the frequency content of each edge tapered structured image by applying local maxima detection; and determining the spatial frequency vector for each structured image, based on the image coordinates.
3. The method of claim 2, wherein the obtaining of the spatial frequency further comprises: upsampling, around the location of the determined spatial frequency vector, the frequency content of each edge tapered structured image; and adjusting the spatial frequency of each structured light to be maximum position in the upsampled frequency content of the corresponding edge tapered structured image.
4. The method of claim 1, wherein the phase shift is obtained by: constructing the structured pattern for each structured light by an initialized phase shift and the corresponding spatial frequency; and adjusting each initialized phase shift by minimizing correlation difference between the structured pattern for each structured light and the corresponding structured images.
5. The method of claim 1, wherein the modulation factor is obtained by: extracting, according to transfer property of the imaging system for each structured light, first frequency content from second frequency content of each structured image, wherein the second frequency content is determined by removing first frequency component from each structured image, and the first frequency component is out-of-focus frequency component; extracting, according to the transfer property of the imaging system for each structured light, third frequency content of each structured image from fourth frequency content of the corresponding structured image, wherein the fourth frequency content is determined by shifting low-grade estimated emission frequency content of each structured image with vector corresponding to the spatial frequency of the corresponding structured light and then filtering the shifted low-grade estimated emission frequency content according to the transfer property of the imaging system for the corresponding structured light; and determining modulation factor for each structured light based on the first and third frequency contents of each structured image.
6. The method of claim 5, wherein the transfer property of the imaging system for each structured light is determined by the optical transfer function of the imaging system and the shifted optical transfer functions of the imaging system, wherein the shifted optical transfer functions are obtained by shifting the optical transfer function of the sampling system by spatial frequency vectors of the structured light having different modulated frequencies.
7. The method of claim 5, wherein the out-of-focus frequency component is determined based on a widefield image that is obtained by averaging the structured images corresponding to the structured light having identical spatial frequency vector.
8. The method of claim 5, the low-grade estimated emission frequency content is determined by: obtaining a widefield image by averaging the structured images having identical spatial frequency vector; extracting signal power spectrum of the widefield image by removing noise power spectrum from power spectrum of the widefield image, wherein the noise power spectrum is determined by averaging the power spectrum with frequencies that are greater than a frequency threshold; initializing an estimated signal power spectrum by the optical transfer function of the sampling system, a first scale factor and a second scale factor; adjusting the first and second scale factor by minimizing difference between the estimated signal power spectrum and the extracted signal power spectrum; and removing noise outside of the optical transfer function support for frequency content of the widefield image.
9. The method of claim 1, wherein the sample image is initialized according to low-grade estimated emission frequency content of the corresponding structured image.
10. The method of claim 1, wherein the iteration further comprises: blocking frequency components beyond extension optical transfer function support for frequency contents of the updated sample image before the adjustment of the structured pattern.
11. The method of claim 1, wherein the iteration further comprises: updating the optical transfer function of the sampling system for each structured light according to the difference between the optical transfer functions within two last iterations.
12. The method of claim 1, further comprising: reducing periodic artifacts in the super-resolved image after the epochs are terminated.
13. A non-transitory machine-readable medium having instructions stored therein, which when executed by a processor, cause the processor to perform operations for obtaining a super-resolved image of an object, the operations comprising: acquiring a plurality of structured images of the object by structured light; determining, from the structured images, modulation information of each structured light that comprises spatial frequency, phase shift and modulation factor; initializing a sample image of the object according the structured images and initializing structured pattern by the corresponding modulation information; and obtaining the super-resolved image by a plurality of epochs, wherein each epoch comprises: performing the following iteration for each structured pattern: determining a target image by applying the structured pattern to the sample image; updating frequency content of the determined target image according to difference between frequency content of the structured image and frequency content of the target image that is measurable to an imaging system used to capture the structured images; modifying the sample image as the super-resolved image according to difference between the target image and the target image obtained by the structured pattern adjusted in the last iteration; and adjusting the structured pattern by the updated target image and the modified sample image, wherein the plurality of epochs are continued until difference between the updated sample images within two last epochs is smaller than a predetermined value.
14. The non-transitory machine-readable medium of claim 13, wherein the spatial frequency is obtained by: exploring image coordinates of a peak intensity position for the frequency content of each edge tapered structured image by applying local maxima detection; and determining the spatial frequency vector of each structured light, based on the image coordinates.
15. The non-transitory machine-readable medium of claim 14, wherein the obtaining of the spatial frequency further comprises: upsampling, around location of the determined spatial frequency vector, the frequency content of each edge tapered structured image; and adjusting the spatial frequency of each structured light to be maximum position in the upsampled frequency content of the corresponding edge tapered structured image.
16. The non-transitory machine-readable medium of claim 13, wherein the phase shift is obtained by: constructing a structured pattern for each structured light by an initialized phase shift and the corresponding spatial frequency; and adjusting each initialized phase shift by minimizing correlation difference between the structured pattern for each structured light and the corresponding structured images.
17. The non-transitory machine-readable medium of claim 13, wherein the modulation factor is obtained by: extracting, according to transfer property of the imaging system for each structured light, first frequency content from second frequency content of each structured image, wherein the second frequency content is determined by removing first frequency component from each structured image, and the first frequency component is out-of-focus frequency component; extracting, according to the transfer property of the imaging system for each structured light, third frequency content of each structured image from fourth frequency content of the corresponding structured image, wherein the fourth frequency content is determined by shifting low-grade estimated emission frequency content of each structured image with vector corresponding to the spatial frequency of the corresponding structured light and then filtering the shifted low-grade estimated emission frequency content according to the transfer property of the imaging system for the corresponding structured light; and determining modulation factor for each structured light based on the first and third frequency contents of each structured image.
18. The non-transitory machine-readable medium of claim 17, wherein the transfer property of the imaging system for each structured light is determined by the optical transfer function of the imaging system and the shifted optical transfer functions of the imaging system, wherein the shifted optical transfer functions are obtained by shifting the optical transfer function of the sampling system by spatial frequency vectors of the structured light having different modulated frequencies.
19. The non-transitory machine-readable medium of claim 17, wherein the out-of-focus frequency component is determined based on a widefield image that is obtained by averaging the structured images corresponding to the structured light having identical spatial frequency vector.
20. The non-transitory machine-readable medium of claim 17, the low-grade estimated emission frequency content is determined by: obtaining a widefield image by averaging the structured images having identical spatial frequency vector; extracting signal power spectrum of the widefield image by removing noise power spectrum from power spectrum of the widefield image, wherein the noise power spectrum is determined by averaging the power spectrum with frequencies that are greater than a frequency threshold; initializing an estimated signal power spectrum by the optical transfer function of the sampling system, a first scale factor and a second scale factor; adjusting the first and second scale factor by minimizing difference between the estimated signal power spectrum and the extracted signal power spectrum; and removing noise outside of the optical transfer function support for frequency content of the widefield image.
21. The non-transitory machine-readable medium of claim 13, wherein the sample image is initialized according to low-grade estimated emission frequency content of the corresponding structured image.
22. The non-transitory machine-readable medium of claim 13, wherein the iteration further comprises: blocking frequency components beyond extension optical transfer function support for frequency contents of the updated sample image before the adjustment of the structured pattern.
23. The non-transitory machine-readable medium of claim 13, wherein the iteration further comprises: updating the optical transfer function of the sampling system for each structured light according to the difference between the optical transfer functions within two last iterations.
24. The non-transitory machine-readable medium of claim 13, the operations further comprising: reducing periodic artifacts in the super-resolved image after the epochs are terminated.
25. The non-transitory machine-readable medium of claim 13, the acquiring of the plurality of structured images comprising: acquiring a plurality of structured images of the object by structured light; and storing the plurality of structured images in a permanent storage medium.
26. The non-transitory machine-readable medium of claim 25, the operations further comprising: before the determining of the modulation information of each structured light, reading the plurality of structured images from the permanent storage medium.
27. A data acquisition and image processing system, comprising: a processor; and a memory coupled to the processor to store instructions, which when executed by the processor, cause the processor to perform operations for obtaining a super-resolved image of an object, the operations comprising: acquiring a plurality of structured images of the object by structured light; determining, from the structured images, modulation information of each structured light that comprises spatial frequency, phase shift and modulation factor; initializing a sample image of the object according the structured images and initializing structured pattern by the corresponding modulation information; and obtaining the super-resolved image by a plurality of epochs, wherein each epoch comprises: performing the following iteration for each structured pattern: determining a target image by applying the structured pattern to the sample image; updating frequency content of the determined target image according to difference between frequency content of the structured image and frequency content of the target image that is measurable to an imaging system used to capture the structured images; modifying the sample image as the super-resolved image according to difference between the target image and the target image obtained by the structured pattern adjusted in the last iteration; and adjusting the structured pattern by the updated target image and the modified sample image, wherein the plurality of epochs are continued until difference between the updated sample images within two last epochs is smaller than a predetermined value.
28. The data processing system of claim 27, wherein the spatial frequency is obtained by: exploring image coordinates of a peak intensity position for the frequency content of each edge tapered structured image by applying local maxima detection; and determining the spatial frequency vector of each structured light, based on the image coordinates.
29. The data processing system of claim 28, wherein the obtaining of the spatial frequency further comprises: upsampling, around the location of the determined spatial frequency vector, the frequency content of each edge tapered structured image; and adjusting the spatial frequency of each structured light to be maximum position in the upsampled frequency content of the corresponding edge tapered structured image.
30. The data processing system of claim 27, wherein the phase shift is obtained by: constructing a structured pattern for each structured light by an initialized phase shift and the corresponding spatial frequency; and adjusting each initialized phase shift by minimizing correlation difference between the structured pattern for each structured light and the corresponding structured images.
31. The data processing system of claim 27, wherein the modulation factor is obtained by: extracting, according to transfer property of the imaging system for each structured light, first frequency content from second frequency content of each structured image, wherein the second frequency content is determined by removing first frequency component from each structured image, and the first frequency component is out-of-focus frequency component; extracting, according to the transfer property of the imaging system for each structured light, third frequency content of each structured image from fourth frequency content of the corresponding structured image, wherein the fourth frequency content is determined by shifting low-grade estimated emission frequency content of each structured image with vector corresponding to the spatial frequency of the corresponding structured light and then filtering the shifted low-grade estimated emission frequency content according to the transfer property of the imaging system for the corresponding structured light; and determining modulation factor for each structured light based on the first and third frequency contents of each structured image.
32. The data processing system of claim 31, wherein the transfer property of the imaging system for each structured light is determined by the optical transfer function of the imaging system and the shifted optical transfer functions of the imaging system, wherein the shifted optical transfer functions are obtained by shifting the optical transfer function of the sampling system by spatial frequency vectors of the structured light having different modulated frequencies.
33. The data processing system of claim 31, wherein the out-of-focus frequency component is determined based on a widefield image that is obtained by averaging the structured images corresponding to the structured light having identical spatial frequency vector.
34. The data processing system of claim 31, the low-grade estimated emission frequency content is determined by: obtaining a widefield image by averaging the structured images having identical spatial frequency vector; extracting signal power spectrum of the widefield image by removing noise power spectrum from power spectrum of the widefield image, wherein the noise power spectrum is determined by averaging the power spectrum with frequencies that are greater than a frequency threshold; initializing an estimated signal power spectrum by the optical transfer function of the sampling system, a first scale factor and a second scale factor; adjusting the first and second scale factor by minimizing difference between the estimated signal power spectrum and the extracted signal power spectrum; and removing noise outside of the optical transfer function support for frequency content of the widefield image.
35. The data processing system of claim 27, wherein the sample image is initialized according to low-grade estimated emission frequency content of the corresponding structured image.
36. The data processing system of claim 27, wherein the iteration further comprises: blocking frequency components beyond extension optical transfer function support for frequency contents of the updated sample image before the adjustment of the structured pattern.
37. The data processing system of claim 27, wherein the iteration further comprises: updating the optical transfer function of the sampling system for each structured light according to the difference between the optical transfer functions within two last iterations.
38. The data processing system of claim 27, the operations further comprising: reducing periodic artifacts in the super-resolved image after the epochs are terminated.
39. The data processing system of claim 27, the acquiring of the plurality of structured images comprising: acquiring a plurality of structured images of the object by structured light; and storing the plurality of structured images in a permanent storage medium.
40. The data processing system of claim 39, the operations further comprising: before the determining of the modulation information of each structured light, reading the plurality of structured images from the permanent storage medium.
41. A system for data acquisition and image processing, comprising: a data acquisition device for acquiring a plurality of structured images of the object by structured light; a storage device for storing the plurality of structured images; and a data processing device comprising: a processor; and a memory coupled to the processor to store instructions, which when executed by the processor, cause the processor to perform operations for obtaining a super-resolved image of an object, the operations comprising: determining, from the structured images, modulation information of each structured light that comprises spatial frequency, phase shift and modulation factor; initializing a sample image of the object according the structured images and initializing structured pattern by the corresponding modulation information; and obtaining the super-resolved image by a plurality of epochs, wherein each epoch comprises: performing the following iteration for each structured pattern: determining a target image by applying the structured pattern to the sample image; updating frequency content of the determined target image according to difference between frequency content of the structured image and frequency content of the target image that is measurable to an imaging system used to capture the structured images; modifying the sample image as the super-resolved image according to difference between the target image and the target image obtained by the structured pattern adjusted in the last iteration; and adjusting the structured pattern by the updated target image and the modified sample image, wherein the plurality of epochs are continued until difference between the updated sample images within two last epochs is smaller than a predetermined value.
</claims>
</document>

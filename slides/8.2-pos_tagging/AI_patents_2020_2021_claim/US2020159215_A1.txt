<document>

<filing_date>
2018-11-21
</filing_date>

<publication_date>
2020-05-21
</publication_date>

<priority_date>
2018-11-21
</priority_date>

<ipc_classes>
G05D1/00,G05D1/02,G06N5/02
</ipc_classes>

<assignee>
WAYMO
</assignee>

<inventors>
DING, KAI
REFAAT, KHALED
ROSS, STEPHANE
</inventors>

<docdb_family_id>
69160056
</docdb_family_id>

<title>
AGENT PRIORITIZATION FOR AUTONOMOUS VEHICLES
</title>

<abstract>
Methods, systems, and apparatus, including computer programs encoded on a computer storage medium, for identifying high-priority agents in the vicinity of a vehicle and, for only those agents which are high priority agents, generating data characterizing the agents using a first prediction model. In a first aspect, a system identifies multiple agents in an environment in a vicinity of a vehicle. The system generates a respective importance score for each of the agents by processing a feature representation of each agent using an importance scoring model. The importance score for an agent characterizes an estimated impact of the agent on planning decisions generated by a planning system of the vehicle which plans a future trajectory of the vehicle. The system identifies, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores.
</abstract>

<claims>
1. A method performed by one or more data processing apparatus, the method comprising: identifying a plurality of agents in an environment in a vicinity of a vehicle; generating a respective importance score for each of the plurality of agents, comprising, for each agent: processing a feature representation of the agent using an importance scoring model to generate an importance score for the agent, wherein the importance score for the agent characterizes an estimated impact of the agent on planning decisions generated by a planning system of the vehicle which plans a future trajectory of the vehicle; identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores; for only those agents of the plurality of agents that are identified as high-priority agents, generating data characterizing the agents using a first prediction model; and providing the data characterizing the high-priority agents generated using the first prediction model to the planning system of the vehicle to generate the planning decisions which plan the future trajectory of the vehicle.
2. The method of claim 1, wherein identifying a plurality of agents in an environment in a vicinity of a vehicle comprises: identifying the plurality of agents in the environment in the vicinity of the vehicle using sensor data captured by one or more sensors of the vehicle.
3. The method of claim 1, further comprising generating a respective feature representation of each of the plurality of agents using sensor data captured by one or more sensors of the vehicle, wherein the feature representation of an agent comprises one or more of: a velocity of the agent, an acceleration of the agent, a type of the agent, a distance from the agent to the vehicle, and data indicating whether a predicted trajectory of the agent will overlap a trajectory of the vehicle.
4. The method of claim 1, wherein identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores comprises: identifying, as high-priority agents, a predetermined number of the plurality of agents with the highest importance scores.
5. The method of claim 1, wherein identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores comprises: identifying, as high-priority agents, each agent of the plurality of agents with an importance score that satisfies a predetermined threshold.
6. The method of claim 1, further comprising: for one or more of the plurality of agents that are not identified as high-priority agents, generating data characterizing the one or more agents using a second prediction model, wherein the first prediction model has a first number of model parameters, the second prediction model has a second number of model parameters, and the first number of model parameters is greater than the second number of model parameters; and providing the data characterizing the one or more agents generated using the second prediction model to the planning system in addition to the data characterizing the high priority agents generated using the first prediction model.
7. The method of claim 6, wherein the first prediction model and the second prediction model are implemented as respective neural network systems.
8. The method of claim 1, wherein: for only those agents of the plurality of agents that are identified as high-priority agents, generating data characterizing the agents using a first prediction model comprises: for only those agents of the plurality of agents that are identified as high-priority agents, generating data characterizing predicted future behavior of the agents using a first behavior prediction model; and providing the data characterizing the high-priority agents generated using the first prediction model to the planning system of the vehicle to generate the planning decisions which plan the future trajectory of the vehicle comprises: providing the data characterizing the predicted future behavior of the high-priority agents generated using the first behavior prediction model to the planning system of the vehicle to generate the planning decisions which plan the future trajectory of the vehicle.
9. The method of claim 8, wherein generating data characterizing the predicted future behavior of an agent comprises generating, for each of multiple spatial locations in the environment, a respective probability that the agent will occupy the spatial location at a specified time point after a current time point.
10. The method of claim 1, further comprising: providing the planning decisions which plan the future trajectory of the vehicle to a control system of the vehicle for use in controlling operation of the vehicle.
11. The method of claim 1, wherein each operation of the method is performed on-board the vehicle.
12. A system, comprising: a data processing apparatus; a memory in data communication with the data processing apparatus and storing instructions that cause the data processing apparatus to perform operations comprising: identifying a plurality of agents in an environment in a vicinity of a vehicle; generating a respective importance score for each of the plurality of agents, comprising, for each agent: processing a feature representation of the agent using an importance scoring model to generate an importance score for the agent, wherein the importance score for the agent characterizes an estimated impact of the agent on planning decisions generated by a planning system of the vehicle which plans a future trajectory of the vehicle; identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores; for only those agents of the plurality of agents that are identified as high-priority agents, generating data characterizing the agents using a first prediction model; and providing the data characterizing the high-priority agents generated using the first prediction model to the planning system of the vehicle to generate the planning decisions which plan the future trajectory of the vehicle.
13. The system of claim 12, wherein identifying a plurality of agents in an environment in a vicinity of a vehicle comprises: identifying the plurality of agents in the environment in the vicinity of the vehicle using sensor data captured by one or more sensors of the vehicle.
14. The system of claim 12, wherein the operations further comprise generating a respective feature representation of each of the plurality of agents using sensor data captured by one or more sensors of the vehicle, wherein the feature representation of an agent comprises one or more of: a velocity of the agent, an acceleration of the agent, a type of the agent, a distance from the agent to the vehicle, and data indicating whether a predicted trajectory of the agent will overlap a trajectory of the vehicle.
15. The system of claim 12, wherein identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores comprises: identifying, as high-priority agents, a predetermined number of the plurality of agents with the highest importance scores.
16. One or more non-transitory computer storage media storing instructions that when executed by one or more computers cause the one or more computers to perform operations comprising: identifying a plurality of agents in an environment in a vicinity of a vehicle; generating a respective importance score for each of the plurality of agents, comprising, for each agent: processing a feature representation of the agent using an importance scoring model to generate an importance score for the agent, wherein the importance score for the agent characterizes an estimated impact of the agent on planning decisions generated by a planning system of the vehicle which plans a future trajectory of the vehicle; identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores; for only those agents of the plurality of agents that are identified as high-priority agents, generating data characterizing the agents using a first prediction model; and providing the data characterizing the high-priority agents generated using the first prediction model to the planning system of the vehicle to generate the planning decisions which plan the future trajectory of the vehicle.
17. The non-transitory computer storage media of claim 16, wherein identifying a plurality of agents in an environment in a vicinity of a vehicle comprises: identifying the plurality of agents in the environment in the vicinity of the vehicle using sensor data captured by one or more sensors of the vehicle.
18. The non-transitory computer storage media of claim 16, wherein the operations further comprise generating a respective feature representation of each of the plurality of agents using sensor data captured by one or more sensors of the vehicle, wherein the feature representation of an agent comprises one or more of: a velocity of the agent, an acceleration of the agent, a type of the agent, a distance from the agent to the vehicle, and data indicating whether a predicted trajectory of the agent will overlap a trajectory of the vehicle.
19. The non-transitory computer storage media of claim 16, wherein identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores comprises: identifying, as high-priority agents, a predetermined number of the plurality of agents with the highest importance scores.
20. The non-transitory computer storage media of claim 16, wherein identifying, as high-priority agents, a proper subset of the plurality of agents with the highest importance scores comprises: identifying, as high-priority agents, each agent of the plurality of agents with an importance score that satisfies a predetermined threshold.
</claims>
</document>

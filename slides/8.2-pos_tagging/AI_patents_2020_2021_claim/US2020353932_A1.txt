<document>

<filing_date>
2020-07-31
</filing_date>

<publication_date>
2020-11-12
</publication_date>

<priority_date>
2018-06-29
</priority_date>

<ipc_classes>
B60W30/18,G05D1/02,G06K9/00,G06N3/04
</ipc_classes>

<assignee>
BEIJING SENSETIME TECHNOLOGY DEVELOPMENT COMPANY
</assignee>

<inventors>
YAN, JUNJIE
ZENG, XINGYU
HU, TIANXIAO
WANG, HEZHANG
MA, YUCHEN
</inventors>

<docdb_family_id>
68985543
</docdb_family_id>

<title>
TRAFFIC LIGHT DETECTION METHOD AND APPARATUS, INTELLIGENT DRIVING METHOD AND APPARATUS, VEHICLE, AND ELECTRONIC DEVICE
</title>

<abstract>
Embodiments of the present disclosure disclose a traffic light detection method and apparatus, an intelligent driving method and apparatus, a vehicle, and an electronic device. The traffic light detection method includes: obtaining a video stream including a traffic light; determining a candidate region of the traffic light in at least one frame of image of the video stream; and determining at least two attributes of the traffic light in the image based on the candidate region.
</abstract>

<claims>
1. A traffic light detection method, comprising: obtaining a video stream comprising a traffic light; determining a candidate region of the traffic light in at least one frame of image of the video stream; and determining at least two attributes of the traffic light in the at least one frame of image based on the candidate region; wherein the at least two attributes of the traffic light comprise any two or more of: a position region, a color, or a shape.
2. The method according to claim 1, wherein determining the candidate region of the traffic light in at least one frame of image of the video stream comprises: determining the candidate region of the traffic light in at least one frame of image of the video stream by using a region-based fully convolutional network; wherein determining at least two attributes of the traffic light in the at least one frame of image based on the candidate region comprises: determining, by using a multi-task identification network, the at least two attributes of the traffic light in the at least one frame of image based on the candidate region.
3. The method according to claim 2, wherein the multi-task identification network comprises: a feature extraction branch, and at least two task branches respectively connected to the feature extraction branch, wherein different task branches are configured to determine different attributes of the traffic light; determining, by using the multi-task identification network, the at least two attributes of the traffic light in the at least one frame of image based on the candidate region comprises: performing feature extraction on the candidate region based on the feature extraction branch to obtain a candidate feature; and processing the candidate feature respectively based on the at least two task branches to obtain the at least two attributes of the traffic light in the at least one frame of image; wherein the at least two task branches comprise: a detection branch, an identification branch, and a classification branch; processing the candidate feature respectively based on the at least two task branches to obtain the at least two attributes of the traffic light in the at least one frame of image comprises: performing position detection on the candidate feature through the detection branch to determine the position region of the traffic light; performing color classification on the candidate feature through the classification branch to determine a color of the position region at which the traffic light is located, and to determine a color of the traffic light; and performing shape identification on the candidate feature through the identification branch to determine a shape of the position region at which the traffic light is located, and to determine the shape of the traffic light.
4. The method according to claim 1, the method further comprises: before determining the candidate region of the traffic light in the at least one frame of image of the video stream, performing key point identification on the at least one frame of image in the video stream to determine a key point of the traffic light in each of the at least one frame of image; tracking the key points of the traffic light in the video stream to obtain a tracking result; and adjusting the position region of the traffic light based on the tracking result.
5. The method according to claim 4, wherein tracking the key points of the traffic light in the video stream comprises: determining a distance between key points of the traffic light in two consecutive frames of images; and tracking the key points of the traffic light in the video stream based on the distance between the key points of the traffic light.
6. The method according to claim 5, wherein tracking the key points of the traffic light in the video stream based on the distance between the key points of the traffic light comprises: determining position regions of the key points of the traffic light in the two consecutive frames of images based on the distance between the key points of the traffic light; and tracking the key points of the traffic light in the video stream according to the position regions of the key points of the traffic light in the two consecutive frames of images.
7. The method according to claim 4, wherein adjusting the position region of the traffic light based on the tracking result comprises: comparing whether the tracking result overlaps the position region of the traffic light to obtain a comparison result; and adjusting the position region of the traffic light based on the comparison result.
8. The method according to claim 7, wherein adjusting the position region of the traffic light based on the comparison result comprises: in response to a position region corresponding to the key point of the traffic light not overlapping the position region of the traffic light, replacing the position region of the traffic light with the position region corresponding to the key point of the traffic light.
9. The method according to claim 2, wherein the method further comprises: before determining the candidate region of the traffic light in the at least one frame of image of the video stream, training the region-based fully convolutional network based on an acquired training image set, the training image set comprising a plurality of training images with annotation attributes; and adjusting parameters in the region-based fully convolutional network and in the multi-task identification network based on the training image set.
10. The method according to claim 9, wherein the method further comprises: before the adjusting parameters in the region-based fully convolutional network and in the multi-task identification network based on the training image set, obtaining, based on the training image set, a new training image set with a traffic light color proportion conforming to a predetermined proportion; and training a classification network based on the new training image set, the classification network being configured to classify training images based on traffic light colors; wherein a number of traffic lights with different colors in the predetermined proportion is the same or a difference in the number is less than an allowable threshold; and the traffic light colors comprise red, yellow, and green.
11. The method according to claim 10, wherein the method further comprises: before adjusting parameters in the region-based fully convolutional network and in the multi-task identification network based on the training image set, initializing at least some of parameters in the multi-task identification network based on parameters of the trained classification network.
12. The method according to claim 1, further comprising: determining a state of the traffic light based on the at least two attributes of the traffic light in the at least one frame of image; and performing intelligent driving control on a vehicle according to the state of the traffic light; wherein the intelligent driving control comprises: sending prompt information or warning information, and/or controlling a driving state of the vehicle according to the state of the traffic light.
13. The method according to claim 12, further comprising: storing the attributes and state of the traffic light as well as the at least one frame of image corresponding to the traffic light.
14. The method according to claim 12, wherein the state of the traffic light comprises: a passing-permitted state, a passing-forbidden state, or a waiting state; determining the state of the traffic light based on the at least two attributes of the traffic light in the at least one frame of image comprises at least one of: in response to a color of the traffic light being green and/or a shape of the traffic light being a first predetermined shape, determining that the state of the traffic light is the passing-permitted state; in response to the color of the traffic light being red and/or the shape of the traffic light being a second predetermined shape, determining that the state of the traffic light is the passing-forbidden state; or in response to the color of the traffic light being yellow and/or the shape of the traffic light being a third predetermined shape, determining that the state of the traffic light is the waiting state; wherein performing intelligent driving control on the vehicle according to the state of the traffic light comprises: in response to the state of the traffic light being the passing-permitted state, controlling the vehicle to execute one or more operations of starting, keeping the driving state, deceleration, turning, turning on a turn light, or turning on a brake light; and in response to the state of the traffic light being the passing-forbidden state or the waiting state, controlling the vehicle to execute one or more operations of stopping, deceleration, or turning on a brake light.
15. An intelligent driving method, comprising: obtaining a video stream comprising a traffic light based on an image acquisition apparatus provided on a vehicle; determining a candidate region of the traffic light in at least one frame of image of the video stream; and determining at least two attributes of the traffic light in the at least one frame of image based on the candidate region; determining a state of the traffic light based on the at least two attributes of the traffic light in the image; and performing intelligent driving control on the vehicle according to the state of the traffic light; wherein the at least two attributes of the traffic light comprise any two or more of: a position region, a color, or a shape.
16. The method according to claim 15, wherein the intelligent driving control comprises: sending prompt information or warning information, and/or controlling a driving state of the vehicle according to the state of the traffic light; wherein the method further comprising: storing the attributes and state of the traffic light as well as the at least one frame of image corresponding to the traffic light.
17. The method according to claim 15, wherein the state of the traffic light comprises: a passing-permitted state, a passing-forbidden state, or a waiting state; determining the state of the traffic light based on the at least two attributes of the traffic light in the at least one frame of image comprises: in response to a color of the traffic light being green and/or a shape of the traffic light being a first predetermined shape, determining that the state of the traffic light is the passing-permitted state; in response to the color of the traffic light being red and/or the shape of the traffic light being a second predetermined shape, determining that the state of the traffic light is the passing-forbidden state; and in response to the color of the traffic light being yellow and/or the shape of the traffic light being a third predetermined shape, determining that the state of the traffic light is the waiting state; wherein performing intelligent driving control on the vehicle according to the state of the traffic light comprises: in response to the state of the traffic light being the passing-permitted state, controlling the vehicle to execute one or more operations of starting, keeping the driving state, deceleration, turning, turning on a turn light, or turning on a brake light; and in response to the state of the traffic light being the passing-forbidden state or the waiting state, controlling the vehicle to execute one or more operations of stopping, deceleration, or turning on a brake light.
18. An electronic device, comprising: a memory configured to store executable instructions; and a processor, configured to communicate with the memory to execute the executable instructions so as to perform operations comprising: obtaining a video stream comprising a traffic light; determining a candidate region of the traffic light in at least one frame of image of the video stream; and determining at least two attributes of the traffic light in the at least one frame of image based on the candidate region; wherein the at least two attributes of the traffic light comprise any two or more of: a position region, a color, or a shape.
19. An electronic device, comprising: a memory configured to store executable instructions; and a processor, configured to communicate with the memory to execute the executable instructions so as to perform operations of the intelligent driving method according to claim 15.
20. A non-transitory computer readable storage medium for storing computer readable instructions, wherein when the computer readable instructions are executed, operations of the traffic light detection method according to claim 1 are executed.
</claims>
</document>

<document>

<filing_date>
2019-10-30
</filing_date>

<publication_date>
2020-07-29
</publication_date>

<priority_date>
2019-01-25
</priority_date>

<ipc_classes>
G06K9/00,G06K9/46,G06K9/62,G06N3/04,G06N3/08,G06T7/11
</ipc_classes>

<assignee>
STRADVISION
</assignee>

<inventors>
JANG, TAEWOONG
KIM, HAK-KYOUNG
KIM, KYE-HYEON
NAM, WOONHYUN
SUNG, MYUNGCHUL
YEO, DONGHUN
KIM, YONGJOONG
KIM, INSU
JE, HONGMO
CHO, HOJIN
RYU, WOOJU
BOO, SUKHOON
JEONG, KYUNGJOONG
</inventors>

<docdb_family_id>
67770114
</docdb_family_id>

<title>
LEARNING METHOD AND LEARNING DEVICE FOR IMPROVING SEGMENTATION PERFORMANCE IN ROAD OBSTACLE DETECTION REQUIRED TO SATISFY LEVEL 4 AND LEVEL 5 OF AUTONOMOUS VEHICLES USING LAPLACIAN PYRAMID NETWORK AND TESTING METHOD AND TESTING DEVICE USING THE SAME
</title>

<abstract>
A learning method for improving a segmentation performance in detecting edges of road obstacles and traffic signs, etc. required to satisfy level 4 and level 5 of autonomous vehicles using a learning device is provided. The traffic signs, as well as landmarks and road markers may be detected more accurately by reinforcing text parts as edge parts in an image. The method includes steps of: the learning device (a) instructing k convolutional layers to generate k encoded feature maps, including h encoded feature maps corresponding to h mask layers; (b) instructing k deconvolutional layers to generate k decoded feature maps (i) by using h bandpass feature maps and h decoded feature maps corresponding to the h mask layers and (ii) by using feature maps to be inputted respectively to k-h deconvolutional layers; and (c) adjusting parameters of the deconvolutional and convolutional layers.
</abstract>

<claims>
1. A learning method for improving a segmentation performance using a learning device, wherein the learning device includes (i) a first to a k-th convolutional layers, which respectively generate a first to a k-th encoded feature maps by applying one or more convolution operations to at least one feature map corresponding to at least one training image, (ii) a k-th to a first deconvolutional layers, which respectively generate a k-th to a first decoded feature maps by applying one or more deconvolution operations to the k-th encoded feature map, (iii) a first to an h-th mask layers respectively corresponding to h convolutional layers among the k convolutional layers, and (iv) a first to an h-th differential layers respectively corresponding to the first to the h-th mask layers, and wherein the h is an integer from 1 to (k-1), comprising steps of: (a) the learning device, if the training image is acquired, instructing the first to the k-th convolutional layers to generate the first to the k-th encoded feature maps through processes of (1) instructing the first to the h-th mask layers to extract one or more edge parts from h encoded feature maps, to be respectively inputted to the first to the h-th mask layers, among the first to the k-th encoded feature maps by acquiring one or more areas in which frequencies of the h encoded feature maps are larger than their corresponding threshold, to thereby generate a first to an h-th bandpass feature maps, and (2) instructing the first to the h-th differential layers to generate a first to an h-th differential feature maps by calculating each difference between each of the h encoded feature maps, to be respectively inputted to the first to the h-th mask layers, and each of the first to the h-th bandpass feature maps, to thereby forward each of the first to the h-th differential feature maps to their corresponding next convolutional layers; (b) the learning device instructing the k-th to the first deconvolutional layers to sequentially generate the k-th to the first decoded feature maps (i) by using the h-th to the first bandpass feature maps and h decoded feature maps each of which is outputted from each previous deconvolutional layer of each of h deconvolutional layers corresponding to the h-th to the first mask layers and (ii) by using feature maps outputted from each previous layer of each of k-h deconvolutional layers, which do not correspond to the h-th to the first mask layers; and (c) the learning device backpropagating one or more losses generated by referring to the first decoded feature map and its corresponding at least one GT(ground truth) label image, to thereby adjust one or more parameters of at least part of the first to the k-th deconvolutional layers and the k-th to the first convolutional layers.
2. The learning method of Claim 1, wherein, at the process of (1), the learning device instructs at least m-th mask layer among the first to the h-th mask layers to extract areas, in which frequencies are larger than their corresponding threshold, from an n-th encoded feature map transmitted from an n-th convolutional layer corresponding to the m-th mask layer, to thereby generate an m-th bandpass feature map, wherein the m is an integer from 1 to the h, and wherein the n is an integer from 1 to the k,
wherein, at the process of (2), the learning device instructs an m-th differential layer corresponding to the m-th mask layer to generate an m-th differential feature map by calculating a difference between the n-th encoded feature map and the m-th bandpass feature map and to forward the m-th differential feature map to an (n+1)-th convolutional layer following the n-th convolutional layer, and
wherein, at the step of (b), the learning device instructs an n-th deconvolutional layer corresponding to the m-th mask layer to apply the deconvolution operations to an element-wise sum of the m-th bandpass feature map and an (n+1)-th decoded feature map outputted from an (n+1)-th deconvolutional layer, to thereby generate an n-th decoded feature map.
3. The learning method of Claim 1, wherein, at the step of (c), the learning device instructs at least one loss layer corresponding to at least one of the k-th to the first deconvolutional layers to generate the losses by referring to at least one decoded feature map, outputted from said at least one of the k-th to the first deconvolutional layers, and its corresponding at least one GT label image, to thereby backpropagate the losses.
4. The learning method of Claim 1, wherein, at the step of (a), the learning device instructs the first to the k-th convolutional layers to respectively generate the first to the k-th encoded feature maps by sequentially decreasing sizes of the training image and the first to the (k-1)-th encoded feature maps and increasing the number of channels of the training image and the first to the (k-1)-th encoded feature maps, and instructs the first to the h-th mask layers to extract the edge parts from the h encoded feature maps, to be respectively inputted to the first to the h-th mask layers, among the first to the k-th encoded feature maps by extracting the areas where the frequencies of the h encoded feature maps are larger than their corresponding threshold, to thereby generate the first to the h-th bandpass feature maps, and
wherein, at the step of (b), the learning device instructs the k-th to the first deconvolutional layers to respectively generate the k-th to the first decoded feature maps by sequentially increasing sizes of the k-th encoded feature map and the k-th to the second decoded feature maps and decreasing the number of channels of the k-th encoded feature map and the k-th to the second decoded feature maps.
5. The learning method of Claim 1, wherein the learning device further includes (v) a first to an h-th intermediate layers each of which is located between each of the first to the h-th mask layers and its corresponding deconvolutional layer; and
wherein the step of (b) includes steps of: (b1) the learning device instructing the first to the h-th intermediate layers to respectively generate a first to an h-th intermediate feature maps by acquiring each of the first to the h-th bandpass feature maps, outputted from the first to the h-th mask layers; and (b2) the learning device instructing the k deconvolutional layers to sequentially generate the k-th to the first decoded feature maps (i) by using the h-th to the first intermediate feature maps and the h decoded feature maps each of which is outputted from each previous deconvolutional layer of each of the h deconvolutional layers corresponding to the h-th to the first intermediate layers and (ii) by using the k-th encoded feature map and k-h-1 decoded feature maps outputted from each previous layer of each of the k-h deconvolutional layers, which do not correspond to the h-th to the first intermediate layers.
6. The learning method of Claim 5, wherein the learning device further includes an additional (h+1)-th intermediate layer between the k-th convolutional layer and the k-th deconvolutional layer, and wherein the additional (h+1)-th intermediate layer generates an (h+1)-th intermediate feature map by applying intermediate operations to the k-th encoded feature maps and forwards the (h+1)-th intermediate feature map to the k-th deconvolutional layer.
7. The learning method of Claim 5, wherein at least one of the first to the h-th intermediate layers performs one or more dilated convolution operations, and wherein at least one receptive field of the h intermediate layers is determined according to filter weights having a value of 0.
8. The learning method of Claim 7, wherein, at the process of (1), the learning device instructs at least m-th mask layer among the first to the h-th mask layers to extract areas, in which the frequencies are larger than their corresponding threshold, from an n-th encoded feature map transmitted from an n-th convolutional layer corresponding to the m-th mask layer, to thereby generate an m-th bandpass feature map, wherein the m is an integer from 1 to the h, and wherein the n is an integer from 1 to the k,
wherein, at the process of (2), the learning device instructs an m-th differential layer corresponding to the m-th mask layer to generate an m-th differential feature map by calculating a difference between the n-th encoded feature map and the m-th bandpass feature map and to forward the m-th differential feature map to an (n+1)-th convolutional layer following the n-th convolutional layer,
wherein, at the step of (b1), the learning device instructs an m-th intermediate layer corresponding to the m-th mask layer to generate an m-th intermediate feature map by referring to the m-th bandpass feature map, and
wherein, at the step of (b2), the learning device instructs an n-th deconvolutional layer corresponding to the m-th intermediate layer to apply the deconvolution operations to an element-wise sum of the m-th intermediate feature map and an (n+1)-th decoded feature map outputted from an (n+1)-th deconvolutional layer, to thereby generate an n-th decoded feature map.
9. A testing method for a segmentation of at least one test image, comprising steps of: (a) on condition that, assuming that a learning device includes (i) a first to a k-th convolutional layers, which respectively generate a first to a k-th encoded feature maps for training by applying one or more convolution operations to at least one feature map for training corresponding to at least one training image, (ii) a k-th to a first deconvolutional layers, which respectively generate a k-th to a first decoded feature maps for training by applying one or more deconvolution operations to the k-th encoded feature map for training, (iii) a first to an h-th mask layers respectively corresponding to h convolutional layers among the k convolutional layers, and (iv) a first to an h-th differential layers respectively corresponding to the first to the h-th mask layers, wherein the h is an integer from 1 to (k-1), the learning device (1) has instructed the first to the k-th convolutional layers to generate the first to the k-th encoded feature maps for training through processes of (1 -1) instructing the first to the h-th mask layers to extract one or more edge parts for training from h encoded feature maps for training, to be respectively inputted to the first to the h-th mask layers, among the first to the k-th encoded feature maps for training by acquiring one or more areas for training in which frequencies of the h encoded feature maps for training are larger than their corresponding threshold, to thereby generate a first to an h-th bandpass feature maps for training, and (1-2) instructing the first to the h-th differential layers to generate a first to an h-th differential feature maps for training by calculating each difference between each of the h encoded feature maps for training, to be respectively inputted to the first to the h-th mask layers, and each of the first to the h-th bandpass feature maps for training, to thereby forward each of the first to the h-th differential feature maps for training to their corresponding next convolutional layers, (2) has instructed the k-th to the first deconvolutional layers to sequentially generate the k-th to the first decoded feature maps for training (2-1) by using the h-th to the first bandpass feature maps for training and h decoded feature maps for training each of which is outputted from each previous deconvolutional layer of each of h deconvolutional layers corresponding to the h-th to the first mask layers and (2-2) by using feature maps for training outputted from each previous layer of each of k-h deconvolutional layers, which do not correspond to the h-th to the first mask layers, and (3) has backpropagated one or more losses generated by referring to the first decoded feature map for training and its corresponding at least one GT(ground truth) label image, to thereby adjust one or more parameters of at least part of the first to the k-th deconvolutional layers and the k-th to the first convolutional layers; a testing device, if the test image is acquired, instructing the first to the k-th convolutional layers to generate a first to a k-th encoded feature maps for testing through processes of (a1) instructing the first to the h-th mask layers to extract one or more edge parts for testing from h encoded feature maps for testing, to be respectively inputted to the first to the h-th mask layers, among the first to the k-th encoded feature maps for testing by acquiring one or more areas for testing in which frequencies of the h encoded feature maps for testing are larger than their corresponding threshold, to thereby generate a first to an h-th bandpass feature maps for testing, and (a2) instructing the first to the h-th differential layers to generate a first to an h-th differential feature maps for testing by calculating each difference between each of the h encoded feature maps for testing, to be respectively inputted to the first to the h-th mask layers, and each of the first to the h-th bandpass feature maps for testing, to thereby forward each of the first to the h-th differential feature maps for testing to their corresponding next convolutional layers; and (b) the testing device instructing the k-th to the first deconvolutional layers to sequentially generate the k-th to the first decoded feature maps for testing (i) by using the h-th to the first bandpass feature maps for testing and h decoded feature maps for testing each of which is outputted from each previous deconvolutional layer of each of h deconvolutional layers corresponding to the h-th to the first mask layers and (ii) by using feature maps for testing outputted from each previous layer of each of k-h deconvolutional layers, which do not correspond to the h-th to the first mask layers.
10. The testing method of Claim 9, wherein, at the process of (a1), the testing device instructs at least m-th mask layer among the first to the h-th mask layers to extract areas, in which frequencies are larger than their corresponding threshold, from an n-th encoded feature map for testing transmitted from an n-th convolutional layer corresponding to the m-th mask layer, to thereby generate an m-th bandpass feature map for testing, wherein the m is an integer from 1 to the h, and wherein the n is an integer from 1 to the k,
wherein, at the process of (a2), the testing device instructs an m-th differential layer corresponding to the m-th mask layer to generate an m-th differential feature map for testing by calculating a difference between the n-th encoded feature map for testing and the m-th bandpass feature map for testing and to forward the m-th differential feature map for testing to an (n+1)-th convolutional layer following the n-th convolutional layer, and
wherein, at the step of (b), the testing device instructs an n-th deconvolutional layer corresponding to the m-th mask layer to apply the deconvolution operations to an element-wise sum for testing of the m-th bandpass feature map for testing and an (n+1)-th decoded feature map for testing outputted from an (n+1)-th deconvolutional layer, to thereby generate an n-th decoded feature map for testing.
11. The testing method of Claim 9, wherein, at the step of (a), the testing device instructs the first to the k-th convolutional layers to respectively generate the first to the k-th encoded feature maps for testing by sequentially decreasing sizes of the test image and the first to the (k-1)-th encoded feature maps for testing and increasing the number of channels of the test image and the first to the (k-1)-th encoded feature maps for testing, and instructs the first to the h-th mask layers to extract the edge parts for testing from the h encoded feature maps for testing, to be respectively inputted to the first to the h-th mask layers, among the first to the k-th encoded feature maps for testing by extracting the areas where the frequencies of the h encoded feature maps for testing are larger than their corresponding threshold, to thereby generate the first to the h-th bandpass feature maps for testing, and
wherein, at the step of (b), the testing device instructs the k-th to the first deconvolutional layers to respectively generate the k-th to the first decoded feature maps for testing by sequentially increasing sizes of the k-th encoded feature map for testing and the k-th to the second decoded feature maps for testing and decreasing the number of channels of the k-th encoded feature map for testing and the k-th to the second decoded feature maps for testing.
12. The testing method of Claim 9, wherein the testing device further includes (v) a first to an h-th intermediate layers each of which is located between each of the first to the h-th mask layers and its corresponding deconvolutional layer; and
wherein the step of (b) includes steps of: (b1) the testing device instructing the first to the h-th intermediate layers to respectively generate a first to an h-th intermediate feature maps for testing by acquiring each of the first to the h-th bandpass feature maps for testing, outputted from the first to the h-th mask layers; and (b2) the testing device instructing the k deconvolutional layers to sequentially generate the k-th to the first decoded feature maps for testing (i) by using the h-th to the first intermediate feature maps for testing and the h decoded feature maps for testing each of which is outputted from each previous deconvolutional layer of each of the h deconvolutional layers corresponding to the h-th to the first intermediate layers and (ii) by using the k-th encoded feature map for testing and k-h-1 decoded feature maps for testing outputted from each previous layer of each of the k-h deconvolutional layers, which do not correspond to the h-th to the first intermediate layers.
13. The testing method of Claim 12, wherein the testing device further includes an additional (h+1)-th intermediate layer between the k-th convolutional layer and the k-th deconvolutional layer, and wherein the additional (h+1)-th intermediate layer generates an (h+1)-th intermediate feature map for testing by applying intermediate operations to the k-th encoded feature maps for testing and forwards the (h+1)-th intermediate feature map for testing to the k-th deconvolutional layer.
14. The testing method of Claim 12, wherein at least one of the first to the h-th intermediate layers performs one or more dilated convolution operations, and wherein at least one receptive field of the h intermediate layers is determined according to filter weights having a value of 0.
15. The testing method of Claim 14, wherein, at the process of (a1), the testing device instructs at least m-th mask layer among the first to the h-th mask layers to extract areas, in which the frequencies are larger than their corresponding threshold, from an n-th encoded feature map for testing transmitted from an n-th convolutional layer corresponding to the m-th mask layer, to thereby generate an m-th bandpass feature map for testing, wherein the m is an integer from 1 to the h, and wherein the n is an integer from 1 to the k,
wherein, at the process of (a2), the testing device instructs an m-th differential layer corresponding to the m-th mask layer to generate an m-th differential feature map for testing by calculating a difference between the n-th encoded feature map for testing and the m-th bandpass feature map for testing and to forward the m-th differential feature map for testing to an (n+1)-th convolutional layer following the n-th convolutional layer,
wherein, at the step of (b1), the testing device instructs an m-th intermediate layer corresponding to the m-th mask layer to generate an m-th intermediate feature map for testing by referring to the m-th bandpass feature map for testing, and
wherein, at the step of (b2), the testing device instructs an n-th deconvolutional layer corresponding to the m-th intermediate layer to apply the deconvolution operations to an element-wise sum for testing of the m-th intermediate feature map for testing and an (n+1)-th decoded feature map for testing outputted from an (n+1)-th deconvolutional layer, to thereby generate an n-th decoded feature map for testing.
</claims>
</document>

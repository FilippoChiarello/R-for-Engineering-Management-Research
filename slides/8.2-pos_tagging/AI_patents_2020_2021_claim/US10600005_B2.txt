<document>

<filing_date>
2019-05-14
</filing_date>

<publication_date>
2020-03-24
</publication_date>

<priority_date>
2018-06-01
</priority_date>

<ipc_classes>
G06N20/00,G06N3/08
</ipc_classes>

<assignee>
SAS INSTITUTE
</assignee>

<inventors>
HALLER, SUSAN EDWARDS
GUNES, FUNDA
SGLAVO, UDO
CZIKA, WENDY ANN
</inventors>

<docdb_family_id>
68693910
</docdb_family_id>

<title>
System for automatic, simultaneous feature selection and hyperparameter tuning for a machine learning model
</title>

<abstract>
A computing device selects a feature set and hyperparameters for a machine learning model to predict a value for a characteristic in a scoring dataset. A number of training model iterations is determined. A unique evaluation pair is selected for each iteration that indicates a feature set selected from feature sets and a hyperparameter configuration selected from hyperparameter configurations. A machine learning model is trained using each unique evaluation pair. Each trained machine learning model is validated to compute a performance measure value. An estimation model is trained with the feature set, the hyperparameter configuration, and the performance measure value computed for unique evaluation pair. The trained estimation model is executed to compute the performance measure value for each unique evaluation pair. A final feature set and a final hyperparameter configuration are selected based on the computed performance measure value.
</abstract>

<claims>
1. A non-transitory computer-readable medium having stored thereon computer-readable instructions that when executed by a computing device cause the computing device to: define a plurality of feature sets to evaluate for input to a machine learning model, wherein each feature set of the plurality of feature sets uniquely indicates a plurality of variables, wherein each of the plurality of variables are a subset of a second plurality of variables included in an input dataset; define a plurality of hyperparameter configurations to evaluate for input to the machine learning model, wherein each hyperparameter configuration of the plurality of hyperparameter configurations indicates a value for each hyperparameter of a plurality of hyperparameters associated with a model type of the machine learning model, wherein each hyperparameter configuration of the plurality of hyperparameter configurations is unique; determine a number of training model iterations based on a number of the defined plurality of feature sets and a number of the defined plurality of hyperparameter configurations, wherein the determined number of training model iterations is less than the number of the defined plurality of feature sets times the number of the defined plurality of hyperparameter configurations; select a unique evaluation pair for each of the determined number of training model iterations, wherein each evaluation pair indicates a feature set selected from the defined plurality of feature sets and a hyperparameter configuration selected from the defined plurality of hyperparameter configurations; (a) select a current feature set based on the feature set of the unique evaluation pair selected for a current iteration number; (b) select a current hyperparameter configuration based on the hyperparameter configuration of the unique evaluation pair selected for the current iteration number; (c) train a machine learning model of the model type using features selected from a training dataset based on the selected current feature set and the selected current hyperparameter configuration; (d) validate the trained machine learning model using features selected from a validation dataset based on the selected current feature set and the selected current hyperparameter configuration to compute a performance measure value; (e) store the computed performance measure value and an indicator of the selected current feature set and the selected current hyperparameter configuration; (f) increment the current iteration number; repeat (a) to (f) until each of the determined number of training model iterations has been performed; train an estimation model using the feature set, the hyperparameter configuration, and the performance measure value stored for each iteration as inputs; execute the trained estimation model to compute the performance measure value for each feature set of the defined plurality of feature sets in combination with each hyperparameter configuration of the defined plurality of hyperparameter configurations; select a final feature set and a final hyperparameter configuration based on the computed performance measure value; and output the selected final feature set and final hyperparameter configuration to predict a value for a characteristic of a new observation vector.
2. The non-transitory computer-readable medium of claim 1, wherein the number of training model iterations is determined as a predefined percentage of the number of the defined plurality of feature sets and the number of the defined plurality of hyperparameter configurations.
3. The non-transitory computer-readable medium of claim 2, wherein the predefined percentage is less than 50%.
4. The non-transitory computer-readable medium of claim 3, wherein the predefined percentage is less than 10%.
5. The non-transitory computer-readable medium of claim 1, wherein the number of training model iterations is determined as a first predefined percentage of the number of the defined plurality of feature sets and a second predefined percentage the number of the defined plurality of hyperparameter configurations, wherein the first predefined percentage is different than the second predefined percentage.
6. The non-transitory computer-readable medium of claim 1, wherein the computer-readable instructions further cause the computing device to: train a final machine learning model of the model type using features selected from the training dataset based on the final feature set and the final hyperparameter configuration; and output a description of the trained final machine learning model.
7. The non-transitory computer-readable medium of claim 6, wherein the computer-readable instructions further cause the computing device to: instantiate a predictive model from the description of the trained final machine learning model; compute the characteristic of the new observation vector using the instantiated predictive model; and output the computed characteristic of the new observation vector.
8. The non-transitory computer-readable medium of claim 1, wherein a model type of the estimation model is a least absolute shrinkage and selection operator regression model type or a factorization machine model type.
9. The non-transitory computer-readable medium of claim 1, wherein the model type of the machine learning model is selected from the group consisting of a decision tree model type, a factorization machine model type, a forest model type, a gradient boosting tree model type, a neural network model type, and a support vector machine model type.
10. The non-transitory computer-readable medium of claim 1, wherein each hyperparameter configuration may be selected using Latin hypercube sampling method.
11. The non-transitory computer-readable medium of claim 1, wherein (c), (d), and (e) are performed in parallel on different computing devices for different iterations of the determined number of training model iterations.
12. The non-transitory computer-readable medium of claim 1, wherein the performance measure value is an accuracy value.
13. The non-transitory computer-readable medium of claim 1, wherein the performance measure value is an error value.
14. The non-transitory computer-readable medium of claim 1, wherein after executing the trained estimation model and before selecting the final feature set and the final hyperparameter configuration, the computer-readable instructions further cause the computing device to: select a plurality of feature set and hyperparameter configuration pairs based on the computed performance measure value of each respective pair; train a second machine learning model of the model type using the training dataset with each pair of the selected plurality of feature set and hyperparameter configuration pairs; and validate each trained second machine learning model using the validation dataset to compute the performance measure value for each respective pair, wherein the final feature set and the final hyperparameter configuration are selected based on the computed performance measure value for each respective pair.
15. A computing device comprising: a processor; and a non-transitory computer-readable medium operably coupled to the processor, the computer-readable medium having computer-readable instructions stored thereon that, when executed by the processor, cause the computing device to define a plurality of feature sets to evaluate for input to a machine learning model, wherein each feature set of the plurality of feature sets uniquely indicates a plurality of variables, wherein each of the plurality of variables are a subset of a second plurality of variables included in an input dataset; define a plurality of hyperparameter configurations to evaluate for input to the machine learning model, wherein each hyperparameter configuration of the plurality of hyperparameter configurations indicates a value for each hyperparameter of a plurality of hyperparameters associated with a model type of the machine learning model, wherein each hyperparameter configuration of the plurality of hyperparameter configurations is unique; determine a number of training model iterations based on a number of the defined plurality of feature sets and a number of the defined plurality of hyperparameter configurations, wherein the determined number of training model iterations is less than the number of the defined plurality of feature sets times the number of the defined plurality of hyperparameter configurations; select a unique evaluation pair for each of the determined number of training model iterations, wherein each evaluation pair indicates a feature set selected from the defined plurality of feature sets and a hyperparameter configuration selected from the defined plurality of hyperparameter configurations; (a) select a current feature set based on the feature set of the unique evaluation pair selected for a current iteration number; (b) select a current hyperparameter configuration based on the hyperparameter configuration of the unique evaluation pair selected for the current iteration number; (c) train a machine learning model of the model type using features selected from a training dataset based on the selected current feature set and the selected current hyperparameter configuration; (d) validate the trained machine learning model using features selected from a validation dataset based on the selected current feature set and the selected current hyperparameter configuration to compute a performance measure value; (e) store the computed performance measure value and an indicator of the selected current feature set and the selected current hyperparameter configuration; (f)increment the current iteration number; repeat (a) to (f) until each of the determined number of training model iterations has been performed; train an estimation model using the feature set, the hyperparameter configuration, and the performance measure value stored for each iteration as inputs; execute the trained estimation model to compute the performance measure value for each feature set of the defined plurality of feature sets in combination with each hyperparameter configuration of the defined plurality of hyperparameter configurations; select a final feature set and a final hyperparameter configuration based on the computed performance measure value; and output the selected final feature set and final hyperparameter configuration to predict a value for a characteristic of a new observation vector.
16. The computing device of claim 15, wherein a model type of the estimation model is a least absolute shrinkage and selection operator regression model type or a factorization machine model type.
17. A method of selecting a feature set and hyperparameters for a machine learning model to predict a value for a characteristic in a scoring dataset, the method comprising: defining, by a computing device, a plurality of feature sets to evaluate for input to a machine learning model, wherein each feature set of the plurality of feature sets uniquely indicates a plurality of variables, wherein each of the plurality of variables are a subset of a second plurality of variables included in an input dataset; defining, by the computing device, a plurality of hyperparameter configurations to evaluate for input to the machine learning model, wherein each hyperparameter configuration of the plurality of hyperparameter configurations indicates a value for each hyperparameter of a plurality of hyperparameters associated with a model type of the machine learning model, wherein each hyperparameter configuration of the plurality of hyperparameter configurations is unique; determining, by the computing device, a number of training model iterations based on a number of the defined plurality of feature sets and a number of the defined plurality of hyperparameter configurations, wherein the determined number of training model iterations is less than the number of the defined plurality of feature sets times the number of the defined plurality of hyperparameter configurations; selecting, by the computing device, a unique evaluation pair for each of the determined number of training model iterations, wherein each evaluation pair indicates a feature set selected from the defined plurality of feature sets and a hyperparameter configuration selected from the defined plurality of hyperparameter configurations; (a) selecting, by the computing device, a current feature set based on the feature set of the unique evaluation pair selected for a current iteration number; (b) selecting, by the computing device, a current hyperparameter configuration based on the hyperparameter configuration of the unique evaluation pair selected for the current iteration number; (c) training, by the computing device, a machine learning model of the model type using features selected from a training dataset based on the selected current feature set and the selected current hyperparameter configuration; (d) validating, by the computing device, the trained machine learning model using features selected from a validation dataset based on the selected current feature set and the selected current hyperparameter configuration to compute a performance measure value; (e) storing, by the computing device, the computed performance measure value and an indicator of the selected current feature set and the selected current hyperparameter configuration; (f) incrementing, by the computing device, the current iteration number; repeating, by the computing device, (a) to (f) until each of the determined number of training model iterations has been performed; training, by the computing device, an estimation model using the feature set, the hyperparameter configuration, and the performance measure value stored for each iteration as inputs; executing, by the computing device, the trained estimation model to compute the performance measure value for each feature set of the defined plurality of feature sets in combination with each hyperparameter configuration of the defined plurality of hyperparameter configurations; selecting, by the computing device, a final feature set and a final hyperparameter configuration based on the computed performance measure value; and outputting, by the computing device, the selected final feature set and final hyperparameter configuration to predict a value for a characteristic of a new observation vector.
18. The method of claim 17, wherein the number of training model iterations is determined as a predefined percentage of the number of the defined plurality of feature sets and the number of the defined plurality of hyperparameter configurations.
19. The method of claim 18, wherein the predefined percentage is less than 50%.
20. The method of claim 19, wherein the predefined percentage is less than 10%.
21. The method of claim 17, wherein the number of training model iterations is determined as a first predefined percentage of the number of the defined plurality of feature sets and a second predefined percentage the number of the defined plurality of hyperparameter configurations, wherein the first predefined percentage is different than the second predefined percentage.
22. The method of claim 17, further comprising: training, by the computing device, a final machine learning model of the model type using features selected from the training dataset based on the final feature set and the final hyperparameter configuration; and outputting, by the computing device, a description of the trained final machine learning model.
23. The method of claim 22, further comprising: instantiating, by the computing device, a predictive model from the description of the trained final machine learning model; computing, by the computing device, the characteristic of the new observation vector using the instantiated predictive model; and outputting, by the computing device, the computed characteristic of the new observation vector.
24. The method of claim 17, wherein a model type of the estimation model is a least absolute shrinkage and selection operator regression model type or a factorization machine model type.
25. The method of claim 17, wherein the model type of the machine learning model is selected from the group consisting of a decision tree model type, a factorization machine model type, a forest model type, a gradient boosting tree model type, a neural network model type, and a support vector machine model type.
26. The method of claim 17, wherein each hyperparameter configuration may be selected using Latin hypercube sampling method.
27. The method of claim 17, wherein (c), (d), and (e) are performed in parallel on different computing devices for different iterations of the determined number of training model iterations.
28. The method of claim 17, wherein the performance measure value is an accuracy value.
29. The method of claim 17, wherein the performance measure value is an error value.
30. The method of claim 17, further comprising, after executing the trained estimation model and before selecting the final feature set and the final hyperparameter configuration: selecting, by the computing device, a plurality of feature set and hyperparameter configuration pairs based on the computed performance measure value of each respective pair; training, by the computing device, a second machine learning model of the model type using the training dataset with each pair of the selected plurality of feature set and hyperparameter configuration pairs; and validating, by the computing device, each trained second machine learning model using the validation dataset to compute the performance measure value for each respective pair, wherein the final feature set and the final hyperparameter configuration are selected based on the computed performance measure value for each respective pair.
</claims>
</document>

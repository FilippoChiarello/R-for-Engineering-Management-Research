<document>

<filing_date>
2018-10-29
</filing_date>

<publication_date>
2020-11-03
</publication_date>

<priority_date>
2018-10-29
</priority_date>

<ipc_classes>
G06F21/53,G06F21/56,H04L29/06
</ipc_classes>

<assignee>
ACRONIS INTERNATIONAL
</assignee>

<inventors>
PROTASOV, STANISLAV
BELOUSSOV, SERGUEI
GREBENNIKOV, NIKOLAY
KOSTYUSHKO, ALEXEY
STROGOV, VLADIMIR
PEREBERINA, ANASTASIA
</inventors>

<docdb_family_id>
70326119
</docdb_family_id>

<title>
Methods and cloud-based systems for protecting devices from malwares
</title>

<abstract>
Disclosed herein are systems and method for protecting an endpoint device from malware. In one aspect, an exemplary method comprises performing, by a light analysis tool of the endpoint, a light static analysis of a sample, terminating the process and notifying the user when the process is malware, performing light dynamic analysis when the process is not malware based on the light static analysis, when the process is clean based on the light dynamic analysis, enabling the process to execute, when the process is malware, terminating the process and notifying the user, and when the process is suspicious pattern, suspending the process, setting a level of trust, sending the sample to a sandbox, terminating the process and notifying the user when the process is a malware based on received final verdict, enabling the process to resume executing when the process is determined as being clean based on the final verdict.
</abstract>

<claims>
1. A method for protecting an endpoint device from a malware, comprising: performing, by a light analysis tool of the endpoint device, a light static analysis of a received sample of a process being monitored; terminating the process and notifying a user when the process is determined as being the malware based on the light static analysis; performing, by the light analysis tool of the endpoint device, a light dynamic analysis of the received sample when the process is not determined as being the malware based on the performed light static analysis; when the process is determined as being clean based on the light dynamic analysis, enabling the process to execute on the endpoint device in accordance with a policy; when the process is determined as being the malware based on the light dynamic analysis, terminating the process and notifying the user; and when the process is determined as being a suspicious pattern based on the light dynamic analysis, suspending the process, setting or adjusting a level of trust for the sample, sending the sample to a sandbox with a request for a final verdict, receiving the final verdict, terminating the process and notifying the user when the process is determined as being the malware based on the received final verdict, enabling the process to resume executing on the endpoint device in accordance with the policy when the process is determined as being clean based on the received final verdict.
2. The method of claim 1, the policy being based on the level of trust, and the enabling of the process to execute on the endpoint device comprising: determining whether the level of trust is above a predetermined threshold; when the level of trust is above the predetermined threshold, executing the process; and when the level of trust is at or below the predetermined threshold, requesting for an approval to execute the process and executing the process only when the approval is received.
3. The method of claim 1, wherein, the light static analysis is performed by checking the sample against hashes and signatures of known malwares, the light dynamic analysis is performed by collecting events of Type A without invasive techniques and analyzing the collected events of Type A to determine if the process is the malware, the suspicious pattern or clean, and the determination of whether the process is the suspicious pattern is based on a preliminary verdict by a correlation analyzer of the light dynamic analysis tool.
4. The method of claim 1, wherein the light dynamic analysis comprises: performing on-execution monitoring of collected events of Type A; and analyzing to detect the malware or the suspicious pattern.
5. The method of claim 4, wherein the setting or adjusting reduces the level of trust for the sample when the suspicious pattern is detected, and the light dynamic analysis further comprises adjusting one or more of: a frequency of collecting the events of Type A and a depth of the light dynamic analysis based on the adjustment of the set level of trust.
6. The method of claim 1, the final verdict being determined by a deep dynamic analysis tool of a server of the sandbox by: collecting events of Types A and B for the sample; and analyzing the collected events of Type B using one or more detection models of the deep dynamic analysis tool to detect malwares, the final verdict being indicative of whether the process is the malware or clean based on a deep dynamic analysis of the events of Type B.
7. The method of claim 6, further comprising: sending, by the server of the sandbox, the events of Types A and B and the final verdict to a correlator, and the correlator: correlating the collected events of Types A and B; for events of Type A that are correlated with events of Type B used to detect malwares, creating suspicious patterns of events of Type A; and updating malware detection models of one or more endpoint devices and one or more servers of the sandbox based on results of the correlation, wherein the updating includes at least distributing the created suspicious patterns to the one or more endpoint devices and the one or more servers of the sandbox, the endpoint device being protected from the malwares being one of the one or more endpoint devices to which the created suspicious patterns are distributed.
8. A system for protecting an endpoint device from a malware, comprising: at least one processor of an endpoint device configured to: perform, by a light analysis tool of the endpoint device, a light static analysis of a received sample of a process being monitored; terminate the process and notifying a user when the process is determined as being the malware based on the light static analysis; perform, by the light analysis tool of the endpoint device, a light dynamic analysis of the received sample when the process is not determined as being the malware based on the performed light static analysis; when the process is determined as being clean based on the light dynamic analysis, enable the process to execute on the endpoint device in accordance with a policy; when the process is determined as being the malware based on the light dynamic analysis, terminate the process and notifying the user; and when the process is determined as being a suspicious pattern based on the light dynamic analysis, suspend the process, set or adjust a level of trust for the sample, send the sample to a sandbox with a request for a final verdict, receive the final verdict, terminate the process and notify the user when the process is determined as being the malware based on the received final verdict, enable the process to resume executing on the endpoint device in accordance with the policy when the process is determined as being clean based on the received final verdict.
9. The system of claim 8, the policy being based on the level of trust, and the processor being configured to enable the process to execute on the endpoint device comprising, the processor being configured to: determine whether the level of trust is above a predetermined threshold; when the level of trust is above the predetermined threshold, executing the process; and when the level of trust is at or below the predetermined threshold, requesting for an approval to execute the process and executing the process only when the approval is received.
10. The system of claim 8, wherein, the light static analysis is performed by checking the sample against hashes and signatures of known malwares, the light dynamic analysis is performed by collecting events of Type A without invasive techniques and analyzing the collected events of Type A to determine if the process is the malware, the suspicious pattern or clean, and the determination of whether the process is the suspicious pattern is based on a preliminary verdict by a correlation analyzer of the light dynamic analysis tool.
11. The system of claim 8, wherein the light dynamic analysis comprises an analysis for: performing on-execution monitoring of collected events of Type A; and analyzing to detect the malware or the suspicious pattern.
12. The system of claim 11, wherein the setting or adjusting reduces the level of trust for the sample when the suspicious pattern is detected, and the light dynamic analysis further comprises adjusting one or more of: a frequency of collecting the events of Type A and a depth of the light dynamic analysis based on the adjustment of the set level of trust.
13. The system of claim 8, the final verdict being determined by a deep dynamic analysis tool of a processor of a server of the sandbox, the processor of the server being configured to: collect events of Types A and B for the sample; and analyze the collected events of Type B using one or more detection models of the deep dynamic analysis tool to detect malwares, the final verdict being indicative of whether the process is the malware or clean based on a deep dynamic analysis of the events of Type B.
14. The system of claim 13, further comprising: the processor of the server of the sandbox, further being configured to: send the events of Types A and B and the final verdict to a correlator, and a processor of the correlator being configured to: correlate the collected events of Types A and B; for events of Type A that are correlated with events of Type B used to detect malwares, create suspicious patterns of events of Type A; and update malware detection models of one or more endpoint devices and one or more servers of the sandbox based on results of the correlation, wherein the updating includes at least distributing the created suspicious patterns to the one or more endpoint devices and the one or more servers of the sandbox, the endpoint device being protected from the malwares being one of the one or more endpoint devices to which the created suspicious patterns are distributed.
15. A non-transitory computer readable medium storing thereon computer executable instructions for protecting an endpoint device from a malware, including instructions for: performing, by a light analysis tool of the endpoint device, a light static analysis of a received sample of a process being monitored; terminating the process and notifying a user when the process is determined as being the malware based on the light static analysis; performing, by the light analysis tool of the endpoint device, a light dynamic analysis of the received sample when the process is not determined as being the malware based on the performed light static analysis; when the process is determined as being clean based on the light dynamic analysis, enabling the process to execute on the endpoint device in accordance with a policy; when the process is determined as being the malware based on the light dynamic analysis, terminating the process and notifying the user; and when the process is determined as being a suspicious pattern based on the light dynamic analysis, suspending the process, setting or adjusting a level of trust for the sample, sending the sample to a sandbox with a request for a final verdict, receiving the final verdict, terminating the process and notifying the user when the process is determined as being the malware based on the received final verdict, enabling the process to resume executing on the endpoint device in accordance with the policy when the process is determined as being clean based on the received final verdict.
16. The non-transitory computer readable medium of claim 15, the policy being based on the level of trust, the instructions for enabling of the process to execute comprising instructions for: determining whether the level of trust is above a predetermined threshold; when the level of trust is above the predetermined threshold, executing the process; and when the level of trust is at or below the predetermined threshold, requesting for an approval to execute the process and executing the process only when the approval is received.
17. The non-transitory computer readable medium of claim 15, wherein, the light static analysis is performed by checking the sample against hashes and signatures of known malwares, the light dynamic analysis is performed by collecting events of Type A without invasive techniques and analyzing the collected events of Type A to determine if the process is the malware, the suspicious pattern or clean, and the determination of whether the process is the suspicious pattern is based on a preliminary verdict by a correlation analyzer of the light dynamic analysis tool.
18. The non-transitory computer readable medium of claim 15, wherein the light dynamic analysis comprises performing on-execution monitoring of collected events of Type A, and analyzing to detect the malware or the suspicious pattern, the setting or adjusting reduces the level of trust for the sample when the suspicious pattern is detected, and the light dynamic analysis further comprises adjusting one or more of: a frequency of collecting the events of Type A and a depth of the light dynamic analysis based on the adjustment of the set level of trust.
19. The non-transitory computer readable medium of claim 15, wherein the final verdict is determined by a deep dynamic analysis tool of a server of the sandbox by collecting events of Types A and B for the sample; and analyzing the collected events of Type B using one or more detection models of the deep dynamic analysis tool to detect malwares, the final verdict being indicative of whether the process is the malware or clean based on a deep dynamic analysis of the events of Type B.
20. The non-transitory computer readable medium of claim 19, wherein the server of the sandbox, sends the events of Types A and B and the final verdict to a correlator, and the correlator correlating the collected events of Types A and B, for events of Type A that are correlated with events of Type B used to detect malwares, creates suspicious patterns of events of Type A, and updates malware detection models of one or more endpoint devices and one or more servers of the sandbox based on results of the correlation, wherein the updating includes at least distributing the created suspicious patterns to the one or more endpoint devices and the one or more servers of the sandbox, the endpoint device being protected from the malwares being one of the one or more endpoint devices to which the created suspicious patterns are distributed.
</claims>
</document>

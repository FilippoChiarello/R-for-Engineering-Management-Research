<document>

<filing_date>
2019-04-24
</filing_date>

<publication_date>
2020-11-03
</publication_date>

<priority_date>
2018-05-09
</priority_date>

<ipc_classes>
A61B5/00,G06K9/62,G06K9/66,G06N3/04,G06N3/08,G06T7/00,G06T7/11,G06T7/136
</ipc_classes>

<assignee>
SIEMENS HEALTHCARE
</assignee>

<inventors>
PAULY, OLIVIER
GHESU, FLORIN-CRISTIAN
Bercea, Cosmin Ionut
</inventors>

<docdb_family_id>
62165361
</docdb_family_id>

<title>
Medical image segmentation
</title>

<abstract>
Systems and methods are disclosed for medical image processing using neural networks. A first and a second controller network share a memory to which both the first and second controller network can write data and from which both the first and the second controller network can read data. Reading and writing is performed by respective read and write heads which are advantageously neural networks trained how to write and read in an optimal way. The memory thus provides each controller network with context data generated by the respective other controller network.
</abstract>

<claims>
1. A system for medical image segmentation, comprising: an input module, configured to provide a plurality of patches of an N-dimensional medical image to be segmented; a computing device, configured to implement a trained first neural network as a first controller network and a trained second neural network as a second controller network, wherein the first controller network is configured to sequentially receive input data representing each of the plurality of patches in a first patch sequence, and to sequentially generate and output data indicative of a respective first patch segmentation mask candidate for each of the plurality of patches, wherein the second controller network is configured to sequentially receive input data representing each of the plurality of patches which are the same, in a second patch sequence, and to sequentially generate and output data indicative of a respective second patch segmentation mask candidate for each of the plurality of patches, and wherein the second patch sequence is different from the first patch sequence; and a memory, shared by the first controller network and the second controller network, wherein the first controller network is further configured to write data relating to a state of the first controller network to the memory, wherein the second controller network is configured to read at least part of the data written by the first controller network from the memory and to utilize the data read, upon generating data indicative of at least one of the second patch segmentation mask candidates, and wherein the computing device is further configured to generate, based on the data indicative of the first and second patch segmentation mask candidates, a final image segmentation mask for segmenting the N-dimensional medical image.
2. The system of claim 1, wherein the second controller network is further configured to write data relating to a state of the second controller network to the memory, and wherein the first controller network is configured to read at least part of the data written by the second controller network from the memory and to utilize the data read, upon generating data indicative of at least one of the first patch segmentation mask candidates.
3. The system of claim 2, wherein the second patch sequence equals the first patch sequence, reversed.
4. The system of claim 2, wherein the computing device is configured to implement at least one of at least one trained third neural network as a first memory write head usable by the first controller network for writing to the memory and at least one trained fourth neural network as a second memory write head usable by the second controller network for writing to the memory.
5. The system of claim 1, wherein the second patch sequence equals the first patch sequence, reversed.
6. The system of claim 1, wherein the computing device is configured to implement at least one of at least one trained third neural network as a first memory write head usable by the first controller network for writing to the memory and at least one trained fourth neural network as a second memory write head usable by the second controller network for writing to the memory.
7. The system of claim 6, wherein the computing device is configured to implement at least one of at least one trained fifth neural network as at least one first memory read head, usable by the first controller network for reading from the memory and at least one trained sixth neural network as at least one second memory read head, usable by the second controller network for reading from the memory, and wherein at least one of the at least one first memory read head and the at least one second memory read head is implemented as a differentiable transformation of context vectors representing the context data within the memory.
8. The system of claim 7, wherein the at least one first memory read head and the at least one second memory read head include at least one of a plurality of first memory read heads, and a plurality of second memory read heads.
9. The system of claim 1, wherein the computing device is configured to implement at least one of at least one trained fifth neural network as at least one first memory read head, usable by the first controller network for reading from the memory and at least one trained sixth neural network as at least one second memory read head, usable by the second controller network for reading from the memory, and wherein at least one of the at least one first memory read head and the at least one second memory read head is implemented as a differentiable transformation of context vectors representing context data within the memory.
10. The system of claim 9, wherein the at least one first memory read head and the at least one second memory read head include at least one of a plurality of first memory read heads, and a plurality of second memory read heads.
11. The system of claim 1, further comprising: a database, shared by the first controller network and the second controller network, the database comprising key vectors linked to a plurality of datasets, wherein the computing device is configured to implement at least one of at least one trained seventh neural network as at least one first database read head usable by the first controller network and at least one trained eighth neural network as at least one second database read head usable by the second controller network, wherein at least one of the at least one first database read head, and the at least one second database read head is configured and usable to retrieve, based on the key vectors, data based on at least one of the plurality of datasets from the database; and wherein a respective one of at least one of the first controller network and second controller network is configured to utilize the data retrieved from the database upon generating data indicative of at least one of the first patch segmentation mask candidate and the second patch segmentation mask candidates, respectively.
12. The system of claim 1, wherein the computing device is configured to implement a trained ninth neural network as an encoder module, and wherein the encoder module is configured to receive patches from the input module and to generate the input data representing each of the plurality of patches for the first controller network and the second controller network.
13. The system of claim 1, wherein the computing device is further configured to generate, using the data indicative of the first patch segmentation mask candidates, data indicative of a first image segmentation mask candidate, to generate, using the data indicative of the second patch segmentation mask candidates, data indicative of a second image segmentation mask candidate, and to generate data indicative of a final image segmentation mask based on the first image segmentation mask and the second image segmentation mask candidate; and wherein the system further comprises a decoder module configured to generate, from the data indicative of the final image segmentation mask, the final image segmentation mask for segmenting the N-dimensional medical image.
14. The system of claim 13, wherein the computing device is further configured to implement a trained tenth neural network as the decoder module.
15. The system of claim 14, wherein the computing device is further configured to implement a trained eleventh neural network as a fusion module, and wherein the fusion module is configured to generate the data indicative of the final image segmentation mask based on the data indicative of the first image segmentation mask candidate and the second image segmentation mask candidate.
16. The system of claim 13, wherein the computing device is further configured to implement a trained eleventh neural network as a fusion module, and wherein the fusion module is configured to generate the data indicative of the final image segmentation mask based on the data indicative of the first image segmentation mask candidate and the second image segmentation mask candidate.
17. The system of claim 1, wherein all of the neural networks of the system are configured to be differentiable.
18. A method for medical image segmentation, comprising: providing a plurality of patches of an N-dimensional medical image to be segmented; sequentially receiving, by a first trained neural network acting as a first controller network, in a first patch sequence, input data representing each of the plurality of patches; sequentially receiving, by a second trained neural network acting as a second controller network, input data representing each of the plurality of patches in a second patch sequence, sequentially generating and outputting, by the first controller network, data indicative of a respective first patch segmentation mask candidate for each of the plurality of patches; sequentially generating and outputting, by the second controller network, data indicative of a respective second patch segmentation mask candidate for each of the plurality of patches, the second patch sequence being different from the first patch sequence; writing, by the first controller network, data relating to a state of the first controller network, to a memory for at least the second controller network; reading from the memory, by the second controller network, at least part of the data written by the first controller network; utilizing, by the second controller network, the data read, upon generating data indicative of at least one of the second patch segmentation mask candidates; and generating, based on the data indicative of the first patch segmentation mask candidates and the second patch segmentation mask candidates, a final image segmentation mask for segmenting the N-dimensional medical image.
19. The method of claim 18, further comprising: writing to a memory, by the second controller network, data relating to a state of the second controller network; reading from the memory, by the first controller network, at least part of the data written by the second controller network; and utilizing, by the first controller network, the data read, upon generating data indicative of at least one of the first patch segmentation mask candidates.
20. A non-transitory computer-readably data storage medium storing executable program code, configured to, upon the program code being executed on a computer, perform the method of claim 18.
21. A non-transitory computer-readably data storage medium storing executable program code, configured to, upon the program code being executed on a computer, perform the method of claim 19.
</claims>
</document>

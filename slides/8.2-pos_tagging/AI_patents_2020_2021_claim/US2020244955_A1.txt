<document>

<filing_date>
2020-04-10
</filing_date>

<publication_date>
2020-07-30
</publication_date>

<priority_date>
2017-10-13
</priority_date>

<ipc_classes>
H04N19/109,H04N19/176,H04N19/61
</ipc_classes>

<assignee>
FRAUNHOFER
</assignee>

<inventors>
WIEGAND, THOMAS
SCHWARZ, HEIKO
MARPE, DETLEV
WINKEN, MARTIN
SIEKMANN, MISCHA
HELLE, PHILIPP
SAMEK, WOJCIECH
PFAFF, JONATHAN
MANIRY, DOMINIQUE
KALTENSTADLER, STEPHAN
</inventors>

<docdb_family_id>
60083873
</docdb_family_id>

<title>
INTRA-PREDICTION MODE CONCEPT FOR BLOCK-WISE PICTURE CODING
</title>

<abstract>
In accordance with a first aspect, an improved compression efficiency is achieved by letting a block-wise picture codec support a set of intra-prediction modes according to which the intra-prediction signal for a current block of a picture is determined by applying a set of neighboring samples of the current block onto a neural network. A second aspect of the present application is that, additionally or alternatively to the spending of neural network-based intra-prediction modes, the mode selection may be rendered more effective by the usage of a neural network dedicated to determine a rank or a probability value for each of the set of intra-prediction modes by applying a set of neighboring samples thereonto with the rank or probability value being used for the selection of one intra-prediction mode out of the plurality of intra-prediction modes including or coinciding with the set of intra-prediction modes.
</abstract>

<claims>
1. An apparatus for block-wise decoding a picture from a data stream, the apparatus supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, the apparatus configured to select for the current block one intra-prediction mode out of the plurality of intra-prediction modes, and predict the current block using the one intra-prediction mode.
2. The apparatus of claim 1, configured to decode from the data stream an index using a variable length code, and perform the selection using the index.
3. The apparatus of claim 1, configured to determine a ranking of the set of intra prediction modes depending on a first portion of the data stream which relates to a neighborhood of the current block in order to acquire an ordered list of intra-prediction modes, and select the one intra-prediction mode out of the ordered list of intra-prediction modes depending on a second portion of the data stream other than the first portion.
4. The apparatus of claim 1, configured to determine, for each intra prediction mode of the set of intra prediction modes, a rank by applying a second set of neighboring samples onto a further neural network or a further sequence of one or more further linear functions in which each further linear function is followed by a respective further non-linear function in order to acquire an ordered list of intra-prediction modes, decode from the data stream an index into the ordered list, and perform the selection using the index and the ordered list.
5. The apparatus of claim 4, configured to decode from the data stream the index into the ordered list using a variable length code.
6. The apparatus of claim 1, configured to determine, for each intra prediction mode of the set of intra prediction modes, a probability value by applying a second set of neighboring samples onto a further neural network or the further sequence of one or more further linear functions entropy decode from the data stream an index into the set of intra prediction modes using the probability value, and perform the selection using the index.
7. The apparatus of claim 3, wherein the first set of neighboring samples coincides with the second set of neighboring samples.
8. The apparatus of claim 1, wherein each of the set of intra-prediction modes uniquely determines the intra-prediction signal for the current block from the first set of neighboring samples of the current block exclusively.
9. The apparatus of claim 1, wherein the plurality of intra-prediction modes further comprises a further set of intra-prediction modes comprising one or more of a DC mode according to which the current block is filled with a DC value, or an directional mode according to which the intra-prediction signal is determined by projecting a spatial sample value distribution alongside the current block derived from a third set of neighboring samples of the current block into the current block along a predetermined direction.
10. The apparatus of claim 1, wherein the plurality of intra-prediction modes further comprises a further set of intra-prediction modes according to which the intra-prediction signal for current block is determined from a third set of neighboring samples of the current block using a linear function, wherein a cardinality of the first set of neighboring samples is higher than a cardinality of the third set of neighboring samples.
11. The apparatus of claim 10, configured to, in selecting the one intra-prediction mode out of the plurality of intra-prediction modes, respond to one flag in the data stream so as to select the one intra-prediction mode out of the set of intra-prediction modes or the further set of intra-prediction modes.
12. An apparatus for block-wise encoding a picture into a data stream, the apparatus supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, the apparatus configured to select for the current block one intra-prediction mode out of the plurality of intra-prediction modes, and predict the current block using the one intra-prediction mode.
13. The apparatus of claim 12, configured to encode into the data stream an index using a variable length code, the index being indicative of the selection.
14. The apparatus of claim 12, configured to determine a ranking of the set of intra prediction modes depending on a first portion of the data stream which relates to a neighborhood of the current block in order to acquire an ordered list of intra-prediction modes, and select the one intra-prediction mode out of the ordered list of intra-prediction modes, and form a second portion of the data stream other than the first portion so as to be indicative of the selection out of the ordered list of intra-prediction modes.
15. The apparatus of claim 12, configured to determine, for each intra prediction mode of the set of intra prediction modes, a rank by applying a second set of neighboring samples onto a further neural network or a further sequence of one or more further linear functions in which each further linear function is followed by a respective further non-linear function in order to acquire an ordered list of intra-prediction modes, and encode into the data stream an index into the ordered list, wherein the index selects the one intra prediction mode out of the ordered list.
16. The apparatus of claim 15, configured to decode from the data stream the index into the ordered list using a variable length code.
17. The apparatus of claim 12, configured to determine, for each intra prediction mode of the set of intra prediction modes, a probability value by applying a second set of neighboring samples onto a further neural network or a further sequence of one or more further linear functions in which each further linear function is followed by a respective further non-linear function, entropy encode into the data stream an index into the set of intra prediction modes using the probability value, the index pointing to the one intra-prediction mode.
18. The apparatus of claim 14, wherein the first set of neighboring samples coincides with the second set of neighboring samples.
19. The apparatus of claim 12, wherein each of the set of intra-prediction modes uniquely determines the intra-prediction signal for the current block from the first set of neighboring samples of the current block exclusively.
20. The apparatus of claim 12, wherein the plurality of intra-prediction modes further comprises a further set of intra-prediction modes comprising one or more of a DC mode according to which the current block is filled with a DC value, or an directional mode according to which the intra-prediction signal is determined by projecting a spatial sample value distribution alongside the current block derived from a third set of neighboring samples of the current block into the current block along a predetermined direction.
21. The apparatus of claim 12, wherein the plurality of intra-prediction modes further comprises a further set of intra-prediction modes according to which the intra-prediction signal for current block is determined from a third set of neighboring samples of the current block using a linear function, wherein a cardinality of the first set of neighboring samples is higher than a cardinality of the third set of neighboring samples.
22. The apparatus of claim 19, configured to provide the data stream with one flag indicative of whether the one intra-prediction mode is member of the set of intra-prediction modes or the further set of intra-prediction modes.
23. An apparatus for training a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, configured to apply, for each of the set of intra-prediction modes, a first set of neighboring samples neighboring a first picture test block onto the first neural network or first sequence of one or more first linear functions associated with the respective intra-prediction mode so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and a second set of neighboring samples neighboring the first picture test block onto a second neural network or a second sequence of one or more second linear functions in which each second linear function is followed by a respective second non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determine, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; update first parameters of the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and second parameters of the second neural network or second sequence of one or more second linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for an intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; apply neighboring samples neighboring a second picture test block onto the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and onto the second neural network or second sequence of one or more second linear functions with the first and second parameters updated.
24. The apparatus of claim 23, configured to apply the first set of neighboring samples onto the first neural network and the second set of neighboring samples onto the second neural network wherein the first and second neural networks are sequences of linear and non-linear functions, wherein the first and second parameters comprise weights of the linear functions, sequences of linear and non-linear functions forming a sequence of neuron layers, or sequences of layers of neurons, wherein the first and second parameters comprise weights controlling a signal strength forwarding between interconnected neurons.
25. The apparatus of claim 23, configured to determine, for each of the set of intra-prediction modes, the cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal and the probability value acquired for the respective intra-prediction mode.
26. The apparatus of claim 23, configured to determine, for each of the set of intra-prediction modes, the cost estimate for coding costs related to prediction error coding and mode signalization as a sum of a first addend mapping the prediction signal acquired for the respective intra-prediction mode and an original undistorted version of the first picture test block onto a prediction error coding rate estimate and a second addend mapping the probability value acquired for the respective intra-prediction mode onto a mode signalization rate estimate.
27. The apparatus of claim 23, wherein the coding cost function's second addend forms the mode signaling side information rate estimate depending on the prediction signal acquired for the intra-prediction mode of lowest coding cost estimate as a function of the probability values acquired for all intra prediction modes which indicates a cross entropy for the intra-prediction mode of lowest coding cost estimate.
28. The apparatus of claim 23, wherein the coding cost function's first addend forms the residual rate estimate depending on the prediction signal acquired for the intra-prediction mode of lowest coding cost estimate as a function of the prediction signal acquired for the respective intra-prediction mode and an original undistorted version of the first picture test block.
29. The apparatus of claim 23, configured to sequentially repeat the application, determination and updating for a plurality of picture tests blocks with using the first and second parameters as updated for one picture test block for the application of the next picture test block of the plurality of picture test blocks.
30. The apparatus of claim 23, configured to subdivide the plurality of picture test blocks into a first set more efficiently codable unsubdivided, and a second set more efficiently codable subdivided into subblocks, and sequentially repeating the application, determination and updating for picture test blocks of the first set with using the first and second parameters as updated for one picture test block for the application of the next picture test block of the first set.
31. The apparatus of claim 23, configured to perform the update using a gradient descent.
32. The apparatus of claim 23, wherein the first set of neighboring samples coincides with the second set of neighboring samples.
33. An apparatus for block-wise decoding a picture from a data stream, the apparatus supporting a plurality of intra prediction modes, the apparatus configured to determine, for each of at least a set of intra prediction modes of the plurality of intra prediction modes, a rank or a probability value by applying a first set of neighboring samples neighboring a current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, select for the current block one intra-prediction mode out of the plurality of intra-prediction modes using the rank or probability value, and predict the current block using the one intra-prediction mode.
34. The apparatus of claim 33, configured to order the set of intra prediction modes according to the rank to acquire an ordered list of intra-prediction modes, decode from the data stream an index using a variable length code, and perform the selection using the index and the ordered list.
35. The apparatus of claim 33, configured to entropy decode from the data stream an index into the set of intra prediction modes using the probability value, and perform the selection using the index.
36. The apparatus of claim 33, wherein each of the set of intra-prediction modes uniquely determines the intra-prediction signal for the current block from a second set of neighboring samples of the current block exclusively.
37. The apparatus of claim 33, wherein the plurality of intra-prediction modes comprises one or more of a DC mode according to which the current block is filled with a DC value, or a directional mode according to which the intra-prediction signal is determined by projecting a spatial sample value distribution alongside the current block derived from a third set of neighboring samples of the current block into the current block along a predetermined direction.
38. The apparatus of claim 33, wherein a cardinality of a set of neighboring samples on the basis of which the current block is predicted according to the plurality of intra-prediction modes differs among the plurality of intra-prediction modes.
39. An apparatus for block-wise encoding a picture into a data stream, the apparatus supporting a plurality of intra prediction modes, the apparatus configured to determine, for each of at least a set of intra prediction modes of the plurality of intra prediction modes, a rank or a probability value by applying a first set of neighboring samples neighboring a current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, select for the current block one intra-prediction mode out of the plurality of intra-prediction modes using the rank or probability value, predict the current block using the one intra-prediction mode.
40. The apparatus of claim 39, configured to order the set of intra prediction modes according to the rank to acquire an ordered list of intra-prediction modes, encode into the data stream an index using a variable length code, wherein the index indexes the one intra-prediction mode in the ordered list.
41. The apparatus of claim 39, configured to entropy encode into the data stream an index into the set of intra prediction modes using the probability value, wherein the index indexes the one intra-prediction mode in the set of intra prediction modes.
42. The apparatus of claim 39, wherein each of the plurality of intra-prediction modes uniquely determines the intra-prediction signal for the current block from a second set of neighboring samples of the current block exclusively.
43. The apparatus of claim 39, wherein the plurality of intra-prediction modes comprises one or more of a DC mode according to which the current block is filled with a DC value, or a directional mode according to which the intra-prediction signal is determined by projecting a spatial sample value distribution alongside the current block derived from a third set of neighboring samples of the current block into the current block along a predetermined direction.
44. The apparatus of claim 39, wherein a cardinality of a set of neighboring samples on the basis of which the current block is predicted according to the plurality of intra-prediction modes differs among the plurality of intra-prediction modes.
45. An apparatus for designing a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function for assisting in selecting among a set of intra-prediction modes for block-based picture coding, configured to predict, using each of the set of intra-prediction modes, a first picture test block from a first set of neighboring samples neighboring the first picture test block so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and apply the first set of neighboring samples onto the neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determine, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; update parameters of the neural network or sequence of one or more linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for the intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; redo the prediction and application for a second prediction text block and its set of neighboring samples with the parameters updated.
46. The apparatus of claim 45, wherein the neural network is a sequence of linear and non-linear functions, wherein the parameters comprise linear function weights, a sequence of linear and non-linear functions forming a sequence of neuron layers, or a sequence of layers of neurons, wherein the parameters comprise weights controlling a signal strength forwarding between interconnected neurons.
47. The apparatus of claim 45, configured to determine, for each of the set of intra-prediction modes, the cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal and the probability value acquired for the respective intra-prediction mode.
48. The apparatus of claim 45, configured to determine, for each of the set of intra-prediction modes, the cost estimate for coding costs related to prediction error coding and mode signalization as a sum of a first addend mapping the prediction signal acquired for the respective intra-prediction mode and an original undistorted version of the first picture test block onto a prediction error coding rate estimate and a second addend mapping the probability value acquired for the respective intra-prediction mode onto a mode signalization rate estimate.
49. The apparatus of claim 45, wherein the coding cost function's second addend forms the mode signaling side information rate estimate depending on the prediction signal acquired for the intra-prediction mode of lowest coding cost estimate as a function of the probability values acquired for all intra prediction modes which indicates a cross entropy for the intra-prediction mode of lowest coding cost estimate.
50. The apparatus of claim 45, wherein the coding cost function's first addend forms the residual rate estimate depending on the prediction signal acquired for the intra-prediction mode of lowest coding cost estimate as a function of the prediction signal acquired for the respective intra-prediction mode and an original undistorted version of the first picture test block.
51. The apparatus of claim 45, configured to sequentially repeat the prediction, application, determination and updating for a plurality of picture tests blocks with using the parameters as updated for one picture test block for the application of the next picture test block of the plurality of picture test blocks.
52. The apparatus of claim 45, configured to perform the update using a gradient descent.
53. A method for block-wise decoding a picture from a data stream, with supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, the method comprising selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes, and predicting the current block using the one intra-prediction mode.
54. A method for block-wise encoding a picture into a data stream, with supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, the method comprising selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes, and predicting the current block using the one intra-prediction mode.
55. A method for training a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, the method comprising applying, for each of the set of intra-prediction modes, a first set of neighboring samples neighboring a first picture test block onto the first neural network or first sequence of one or more linear first functions associated with the respective intra-prediction mode so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and a second set of neighboring samples neighboring the first picture test block onto a second neural network or a second sequence of one or more second linear functions in which each second linear function is followed by a respective second non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determining, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; updating first parameters of the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and second parameters of the second neural network or second sequence of one or more second linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for an intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; applying neighboring samples neighboring a second picture test block onto the first neural network or first sequence of first linear functions for each of the set of intra-prediction modes and onto the second neural network or second sequence of second linear functions with the first and second parameters updated.
56. A method for block-wise decoding a picture from a data stream, with supporting a plurality of intra prediction modes, the method comprising determining, for each of at least a set of intra prediction modes of the plurality of intra prediction modes, a rank or a probability value by applying a first set of neighboring samples neighboring a current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes using the rank or probability value, and predicting the current block using the one intra-prediction mode.
57. A method for block-wise encoding a picture into a data stream, with supporting a plurality of intra prediction modes, the method comprising determining, for each of at least a set of intra prediction modes of the plurality of intra prediction modes, a rank or a probability value by applying a first set of neighboring samples neighboring a current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes using the rank or probability value, predicting the current block using the one intra-prediction mode.
58. A method for designing a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function for assisting in selecting among a set of intra-prediction modes for block-based picture coding, the method comprising predicting, using each of the set of intra-prediction modes, a first picture test block from a first set of neighboring samples neighboring the first picture test block so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and apply the first set of neighboring samples onto the neural network or sequence of one or more linear functions so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determining, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; updating parameters of the neural network or sequence of one or more linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for the intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; redo the prediction and application for a second prediction text block and its set of neighboring samples with the parameters updated.
59. A data stream generated using a method for block-wise encoding a picture into a data stream, with supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, the method comprising selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes, and predicting the current block using the one intra-prediction mode.
60. A data stream generated using a method for block-wise encoding a picture into a data stream, with supporting a plurality of intra prediction modes, the method comprising determining, for each of at least a set of intra prediction modes of the plurality of intra prediction modes, a rank or a probability value by applying a first set of neighboring samples neighboring a current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes using the rank or probability value, predicting the current block using the one intra-prediction mode.
61. A digital storage medium storing a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, wherein the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes is acquired by the method for training a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, the method comprising applying, for each of the set of intra-prediction modes, a first set of neighboring samples neighboring a first picture test block onto the first neural network or first sequence of one or more linear first functions associated with the respective intra-prediction mode so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and a second set of neighboring samples neighboring the first picture test block onto a second neural network or a second sequence of one or more second linear functions in which each second linear function is followed by a respective second non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determining, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; updating first parameters of the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and second parameters of the second neural network or second sequence of one or more second linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for an intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; applying neighboring samples neighboring a second picture test block onto the first neural network or first sequence of first linear functions for each of the set of intra-prediction modes and onto the second neural network or second sequence of second linear functions with the first and second parameters updated.
62. An apparatus for block-wise decoding a picture from a data stream, the apparatus supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to each which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, which is associated with the respective intra prediction mode, the apparatus configured to select for the current block one intra-prediction mode out of the plurality of intra-prediction modes according to mode signalization in the data stream, and predict the current block using the one intra-prediction mode, wherein the neural network or sequence of one or more linear functions for each of the set of intra-prediction modes is acquired by the method for training a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, the method comprising applying, for each of the set of intra-prediction modes, a first set of neighboring samples neighboring a first picture test block onto the first neural network or first sequence of one or more linear first functions associated with the respective intra-prediction mode so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and a second set of neighboring samples neighboring the first picture test block onto a second neural network or a second sequence of one or more second linear functions in which each second linear function is followed by a respective second non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determining, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; updating first parameters of the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and second parameters of the second neural network or second sequence of one or more second linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for an intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; applying neighboring samples neighboring a second picture test block onto the first neural network or first sequence of first linear functions for each of the set of intra-prediction modes and onto the second neural network or second sequence of second linear functions with the first and second parameters updated.
63. A method for block-wise decoding a picture from a data stream, the method supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to each which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, which is associated with the respective intra prediction mode, the method comprising: selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes according to mode signalization in the data stream, and predicting the current block using the one intra-prediction mode, wherein the neural network or sequence of one or more linear functions for each of the set of intra-prediction modes is acquired by the method for training a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, the method comprising applying, for each of the set of intra-prediction modes, a first set of neighboring samples neighboring a first picture test block onto the first neural network or first sequence of one or more linear first functions associated with the respective intra-prediction mode so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and a second set of neighboring samples neighboring the first picture test block onto a second neural network or a second sequence of one or more second linear functions in which each second linear function is followed by a respective second non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determining, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; updating first parameters of the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and second parameters of the second neural network or second sequence of one or more second linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for an intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; applying neighboring samples neighboring a second picture test block onto the first neural network or first sequence of first linear functions for each of the set of intra-prediction modes and onto the second neural network or second sequence of second linear functions with the first and second parameters updated.
64. A non-transitory digital storage medium having a computer program stored thereon to perform the method for block-wise decoding a picture from a data stream, the method supporting a plurality of intra prediction modes comprising at least a set of intra-prediction modes according to each which the intra-prediction signal for a current block of the picture is determined by applying a first set of neighboring samples of the current block onto a neural network or a sequence of one or more linear functions in which each linear function is followed by a respective non-linear function, which is associated with the respective intra prediction mode, the method comprising: selecting for the current block one intra-prediction mode out of the plurality of intra-prediction modes according to mode signalization in the data stream, and predicting the current block using the one intra-prediction mode, wherein the neural network or sequence of one or more linear functions for each of the set of intra-prediction modes is acquired by the method for training a first neural network or a first sequence of one or more first linear functions in which each first linear function is followed by a respective first non-linear function, for each of a set of intra-prediction modes for block-based picture coding according to which an intra-prediction signal for a current block is determined by applying a first set of neighboring samples of the current block onto the first neural network or the first sequence of one or more first linear functions associated with the intra-prediction mode, the method comprising applying, for each of the set of intra-prediction modes, a first set of neighboring samples neighboring a first picture test block onto the first neural network or first sequence of one or more linear first functions associated with the respective intra-prediction mode so as to acquire, for each of the set of intra-prediction modes, a prediction signal for the first test block, and a second set of neighboring samples neighboring the first picture test block onto a second neural network or a second sequence of one or more second linear functions in which each second linear function is followed by a respective second non-linear function so as to acquire, for each of the set of intra-prediction modes, a probability value indicative of a probability of the respective intra-prediction mode; determining, for each of the set of intra-prediction modes, a cost estimate for coding costs related to prediction error coding and mode signalization using the prediction signal acquired for the respective intra-prediction mode; updating first parameters of the first neural network or first sequence of one or more first linear functions for each of the set of intra-prediction modes and second parameters of the second neural network or second sequence of one or more second linear functions so as to reduce a coding cost function having a first addend forming a residual rate estimate depending on the prediction signal acquired for an intra-prediction mode of lowest coding cost estimate, and a second addend forming a mode signaling side information rate estimate depending on the prediction signal and the probability value acquired for the intra-prediction mode of lowest coding cost estimate; applying neighboring samples neighboring a second picture test block onto the first neural network or first sequence of first linear functions for each of the set of intra-prediction modes and onto the second neural network or second sequence of second linear functions with the first and second parameters updated, when said computer program is run by a computer.
</claims>
</document>

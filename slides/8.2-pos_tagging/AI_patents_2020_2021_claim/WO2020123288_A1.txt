<document>

<filing_date>
2019-12-06
</filing_date>

<publication_date>
2020-06-18
</publication_date>

<priority_date>
2018-12-11
</priority_date>

<ipc_classes>
G06N3/04
</ipc_classes>

<assignee>
AMAZON TECHNOLOGIES
</assignee>

<inventors>
DIAMANT, RON
HEATON, RICHARD JOHN
HUANG, RANDY RENFU
OLGIATI, ANDREA
</inventors>

<docdb_family_id>
69006076
</docdb_family_id>

<title>
IMPROPER NEURAL NETWORK INPUT DETECTION AND HANDLING
</title>

<abstract>
Systems and methods for performing improper input data detection are described. In one example, a system comprises: hardware circuits configured to receive input data and to perform computations of a neural network based on the input data to generate computation outputs; and an improper input detection module configured to: determine a relationship between the computation outputs of the hardware circuits and reference outputs; determine that the input data are improper based on the relationship; and perform an action based on determining that the input data are improper.
</abstract>

<claims>
WHAT IS CLAIMED IS:
1. A system comprising:
hardware circuits configured to receive input data and to perform computations of a neural network based on the input data to generate computation outputs; and
an improper input detection module configured to:
determine a relationship between the computation outputs of the hardware circuits and reference outputs;
determine that the input data are improper based on the relationship; and perform an action based on determining that the input data are improper.
2. The system of claim 1, wherein the input data deviate from a set of training data used to train the neural network by at least a pre-determined margin.
3. The system of claim 2, wherein the reference outputs are generated by the neural network based on processing the set of training data.
4. The system of any one of claims 1-3, wherein the hardware circuits comprise:
arithmetic circuits configured to perform arithmetic operations to generate intermediate outputs; and
activation function circuits configured to apply activation function processing on the intermediate outputs to generate the computation outputs.
5. The system of any one of claims 1-4, wherein the improper input detection module is configured to determine the relationship between the computation outputs and reference outputs based on comparing the computation outputs against one or more thresholds related to a mean and a standard deviation of the reference outputs.
6. The system of claim 5, wherein the improper input detection module is configured to:
for each of the computation outputs:
determine a difference between the each of the computation outputs and the mean; and determine whether the each of the computation outputs is an outlier output based on comparing the difference with a first threshold based on a pre-determined multiples of the standard deviation;
determine a count of the outlier outputs; and
determine that the input data are improper based on comparing the count against a second threshold.
7. The system of claim 6, wherein the improper input detection module is configured to receive detection configuration information from an application that provides the input data; and
wherein the detection configuration information include definitions of the first threshold and the second threshold.
8. The system of claim 7, wherein the neural network comprises multiple neural network layers; and
wherein the improper input detection module is configured, based on the detection configuration information, to determine that the input data are improper based on the count of the outlier outputs in the computation outputs for one neural network layer of the multiple neural network layers.
9. The system of claim 8, wherein the improper input detection module is configured, based on the detection configuration information, to determine that the input data are improper based on a location of the one neural network layer within the neural network.
10. The system of any one of claims 1-9, wherein the improper input detection module is configured to:
determine first statistical parameters of the computation outputs; receive second statistical parameters of the reference outputs; and determine the relationship between the computation outputs and reference outputs based on comparing the first statistical parameters and the second statistical parameters.
11. The system of any one of claims 1-10, wherein the neural network comprises multiple neural network layers; and
wherein the improper input detection module is configured to:
determine a mean and a standard deviation of the computation outputs of each neural network layer of the multiple neural network layers; and generate a record of the means and the standard deviations of the computation outputs of the each neural network layer.
12. The system of any one of claims 1-11, wherein the improper input detection module is configured to perform the action, the action comprising at least one of: transmitting an error notification to an application that uses the computation outputs of the hardware circuits, or suspending computations of the neural network at the hardware circuits.
13. A method, comprising:
receiving, from hardware circuits, computation outputs of a neural network based on input data provided by an application;
determining a relationship between the computation outputs of the hardware circuits and reference outputs of the neural network, the reference outputs being generated from processing of a set of training data by the neural network;
determining that the input data are improper based on the relationship; and performing an action based on determining that input data are improper.
14. The method of claim 13, further comprising:
receiving a mean and a standard deviation of a distribution of the reference outputs;
wherein determining the relationship between the computation outputs of the hardware circuits and the reference outputs comprises:
determining a difference between each of the computation outputs and the mean; and
determining that the input data are improper based on comparing the difference against a threshold derived from the standard deviation.
15. The method of claims 13 or 14, wherein the action comprises at least one of: transmitting an error notification to the application, or suspending computations of the neural network at the hardware circuits.
</claims>
</document>

<document>

<filing_date>
2020-06-29
</filing_date>

<publication_date>
2020-10-15
</publication_date>

<priority_date>
2019-03-18
</priority_date>

<ipc_classes>
G06F17/16,G06K9/00,G06K9/62,G06N3/02
</ipc_classes>

<assignee>
SHENZHEN SENSETIME TECHNOLOGY COMPANY
</assignee>

<inventors>
ZHAO RUI
XU, JING
</inventors>

<docdb_family_id>
66563593
</docdb_family_id>

<title>
IMAGE CLUSTERING METHOD AND APPARATUS, ELECTRONIC DEVICE, AND STORAGE MEDIUM
</title>

<abstract>
An image clustering method and apparatus, an electronic device, and a storage medium are provided. The method includes: obtaining a face feature and an attribute feature of each image in an image set; performing clustering processing on the image set by using a similarity of the face feature of each image in the image set to obtain at least one first class group, images included in each first class group being predicted images including a same object; determining a similarity matrix for each first class group by using the face features and the attribute features of the images in each first class group; and re-clustering the images in each first class group based on the similarity matrix corresponding to each first class group and the face features of the images in each first class group to obtain at least one second class group, images in the second class group being optimized predicted images having a same object.
</abstract>

<claims>
1. An image clustering method, comprising: obtaining a face feature and an attribute feature of each image in an image set; performing clustering processing on the image set by using a similarity of the face feature of each image in the image set to obtain at least one first class group, images comprised in each first class group being predicted images comprising a same object; determining a similarity matrix for each first class group by using the face features and the attribute features of the images in each first class group, each element in the similarity matrix representing a respective one of similarities between images in a first class group corresponding to the similarity matrix; and re-clustering the images in each first class group based on the similarity matrix corresponding to each first class group and the face features of the images in each first class group to obtain at least one second class group, images in the second class group being optimized predicted images having a same object.
2. The method according to claim 1, wherein the performing clustering processing on the image set by using a similarity of the face feature of each image in the image set to obtain at least one first class group comprises: determining similarities between the face features of all images in the image set; determining, based on the similarities between the face features of all images in the image set, K images with top similarities to the face feature of each image in the image set, K being an integer greater than or equal to 1; selecting a first image with a face feature similarity exceeding a first threshold from the K images with top similarities to the face feature of each image in the image set; and forming a first class group according to each image in the image set and a first image corresponding to each image in the image set.
3. The method according to claim 2, wherein a plurality of first thresholds is comprised; and the performing clustering processing on the image set by using a similarity of the face feature of to each image in the image set to obtain at least one first class group further comprises: for different first thresholds, forming a first class group corresponding to each of the first thresholds.
4. The method according to claim 1, wherein the determining a similarity matrix for each first class group by using the face features and the attribute features of the images in each first class group comprises: determining a face feature similarity matrix for each first class group based on similarities between the face features of the images in a corresponding first class group; determining an attribute feature similarity matrix for each first class group based on the attribute features of the images in a corresponding first class group, each element in the face feature similarity matrix representing a respective one of similarities between the face features of the images in the first class group, and each element in the attribute feature similarity matrix representing a respective one of similarities between the attribute features of the images in the first class group; and obtaining the similarity matrix for each first class group according to the face feature similarity matrix for each first class group and the attribute feature similarity matrix for each first class group.
5. The method according to claim 4, wherein the determining an attribute feature similarity matrix for each first class group based on the attribute features of the images in a corresponding first class group comprises: determining an attribute feature of each image in the first class group and attribute feature similarities between the attribute features of all the images in the first class group; and determining the attribute feature similarity matrix for the first class group based on the similarities between the attribute features of all the images in the first class group.
6. The method according to claim 4, wherein elements in an i-th row of the face feature similarity matrix represent similarities between a face feature of an i-th image in the first class group and face features of other images in the first class group; elements in an i-th row of the attribute feature similarity matrix represent similarities between an attribute feature of the i-th image in the first class group and attribute features of other images in the first class group; and i is an integer greater than or equal to 1 and less than or equal to N, and N represents a number of the images in the first class group.
7. The method according to claim 4, wherein the similarity between the face features and/or the similarity between the attribute features is a cosine similarity.
8. The method according to claim 4, wherein the obtaining the similarity matrix for each first class group according to the face feature similarity matrix for each first class group and the attribute feature similarity matrix for each first class group comprises: performing at least one layer of convolution processing on the face feature similarity matrix for each first class group and the attribute feature similarity matrix for each first class group to obtain the similarity matrix corresponding to each first class group.
9. The method according to claim 1, wherein the re-clustering the images in each first class group based on the similarity matrix corresponding to each first class group and the face features of the images in each first class group to obtain at least one second class group comprises: preprocessing the similarity matrix corresponding to each first class group to obtain a preprocessed similarity matrix; performing at least one layer of graph convolution processing on the preprocessed similarity matrix corresponding to each first class group and face features of images in a corresponding first class group to obtain a confidence score matrix for each first class group, each element in the confidence score matrix representing a confidence score that each image in the corresponding first class group is allocated to the first class group; and re-clustering the first class group according to the confidence score corresponding to each image in the first class group to obtain a re-clustered second class group.
10. The method according to claim 9, wherein the re-clustering the first class group according to the confidence score corresponding to each image in the first class group to obtain a re-clustered second class group comprises: deleting an image with a confidence score less than a second threshold from the first class group to obtain a re-clustered second class group.
11. The method according to claim 9, wherein the re-clustering the images in each first class group based on the pre-processed similarity matrix corresponding to each first class group and the face features of the images in each first class group to obtain at least one second class group further comprises: further obtaining a class confidence score for each first class group based on the graph convolution processing, the class confidence score representing a classification confidence score of the corresponding first class group; and before the re-clustering the first class group according to the confidence score corresponding to each image in the first class group to obtain a re-clustered second class group, the method further comprises: deleting the first class group in response to the class confidence score of the first class group being less than a third threshold.
12. The method according to claim 11, wherein the re-clustering the first class group according to the confidence score corresponding to each image in the first class group to obtain a re-clustered second class group comprises: ranking the at least one first class group in a descending order of the class confidence scores; and allocating a j-th label to an image with a confidence score exceeding a second threshold in a j-th first class group, and deleting an image with a confidence score less than the second threshold in the j-th first class group, so as to form a second class group corresponding to the j-th first class group, wherein j is a positive integer greater than or equal to 1 and less than or equal to M, and M represents a number of the at least one first class group.
13. The method according to claim 12, wherein the re-clustering the first class group according to the confidence score corresponding to each image in the first class group to obtain a re-clustered second class group further comprises: after obtaining a second class group corresponding to a M-th first class group, in response to the presence of one or more images in the image set that is not clustered into any second class group, form a second class group respectively based on the one or more images that are not clustered into any second class group.
14. The method according to claim 9, wherein preprocessing the similarity matrix corresponding to each first class group to obtain the pre-processed similarity matrix comprises: adding the similarity matrix corresponding to each first class group with a unit matrix.
15. The method according to claim 1, wherein the obtaining a face feature and an attribute feature of each image in the image set comprises: obtaining the face feature of each image in the image set by using a first neural network; and obtaining the attribute feature of each image in the image set by using a second neural network.
16. An image clustering apparatus, comprising: a processor; and a memory configured to store processor-executable instructions, wherein when the processor-executable instructions are executed by the processor, the processor is configured to: obtain a face feature and an attribute feature of each image in an image set; perform clustering processing on the image set by using a similarity of the face feature of each image in the image set to obtain at least one first class group, images comprised in each first class group being predicted images comprising a same object; determine a similarity matrix for each first class group by using the face features and the attribute features of the images in each first class group, each element in the similarity matrix representing a respective one of similarities between images in a first class group corresponding to the similarity matrix; and re-cluster the images in each first class group based on the similarity matrix corresponding to each first class group and the face features of the images in each first class group to obtain at least one second class group, images in the second class group being optimized predicted images having a same object.
17. The apparatus according to claim 16, wherein the processor is further configured to: determine similarities between the face features of all images in the image set; determine, based on the similarities between the face features of all images in the image set, K images with the top similarities to the face feature of each image in the image set, K being an integer greater than or equal to 1; select a first image with a face feature similarity exceeding a first threshold from the K images with top similarities to the face feature of each image in the image set; and form a first class group according to each image in the image set and a first image corresponding to each image in the image set.
18. The apparatus according to claim 17, wherein a plurality of first thresholds is comprised, and the processor is further configured to, for different first thresholds, form a first class group corresponding to each of the first thresholds.
19. The apparatus according to claim 16, wherein the processor is specifically configured to: determine a face feature similarity matrix for each first class group based on similarities between the face features of the images in a corresponding first class group, each element in the face feature similarity matrix representing a respective one of similarities between the face features of the images in the first class group; determine an attribute feature similarity matrix for each first class group based on the attribute features of the images in a corresponding first class group, each element in the attribute feature similarity matrix representing a respective one of similarities between the attribute features of the images in the first class group; and obtain the similarity matrix for each first class group according to the face feature similarity matrix for each first class group and the attribute feature similarity matrix for each first class group.
20. A non-transitory computer-readable storage medium, having computer program instructions stored thereon, wherein when the computer program instructions are executed by a processor, the following operations are performed: obtaining a face feature and an attribute feature of each image in an image set; performing clustering processing on the image set by using a similarity of the face feature of each image in the image set to obtain at least one first class group, images comprised in each first class group being predicted images comprising a same object; determining a similarity matrix for each first class group by using the face features and the attribute features of the images in each first class group, each element in the similarity matrix representing a respective one of similarities between images in a first class group corresponding to the similarity matrix; and re-clustering the images in each first class group based on the similarity matrix corresponding to each first class group and the face features of the images in each first class group to obtain at least one second class group, images in the second class group being optimized predicted images having a same object.
</claims>
</document>

<document>

<filing_date>
2020-01-22
</filing_date>

<publication_date>
2020-05-21
</publication_date>

<priority_date>
2017-07-25
</priority_date>

<ipc_classes>
G06F11/07,G06F11/30,G06F11/34,G06F12/02
</ipc_classes>

<assignee>
HUAWEI TECHNOLOGIES COMPANY
</assignee>

<inventors>
LI JIAN
ZHANG, LIANG
CHENG, KANG
PAN, JIYU
XIAO, XIN
</inventors>

<docdb_family_id>
65039458
</docdb_family_id>

<title>
Memory Anomaly Detection Method and Device
</title>

<abstract>
A memory anomaly detection method and device are provided. The method includes: obtaining a first memory log, where the first memory log includes log information of a plurality of garbage collections, and log information of each garbage collection includes a garbage collection time, and includes at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection; obtaining, based on log information in a first detection time window, first statistical information corresponding to the first detection time window; and determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree corresponding to the log information in the first detection time window. It can be learned that by implementing the method described in the embodiments of this application, accuracy of a detection result of a memory anomaly degree is improved.
</abstract>

<claims>
1. A memory anomaly detection method, wherein the method comprises: obtaining a first memory log, wherein the first memory log comprises log information of a plurality of garbage collections, and log information of each garbage collection comprises a garbage collection time, and comprises at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection; obtaining, based on log information in a first detection time window, first statistical information corresponding to the first detection time window, wherein the log information in the first detection time window is log information in which a garbage collection time belongs to the first detection time window, and the first statistical information comprises at least one of an average downtime in the first detection time window, a change from memory usage before earliest garbage collection in the first detection time window to memory usage after latest garbage collection in the first detection time window, and the memory usage after the latest garbage collection in the first detection time window; and determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree corresponding to the log information in the first detection time window.
2. The method according to claim 1, wherein the determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree corresponding to the log information in the first detection time window comprises: determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree corresponding to the first detection time window; and determining the anomaly degree corresponding to the first detection time window as an anomaly degree corresponding to first log information in the first detection time window.
3. The method according to claim 2, wherein the first log information is any log information in the first detection time window.
4. The method according to claim 2, wherein the first log information is log information that belongs to the first detection time window and does not belong to a detection time window before the first detection time window.
5. The method according to claim 1, wherein after the determining an anomaly degree corresponding to the log information in the first detection time window, the method further comprises: if there is log information with a high anomaly degree, memory usage after garbage collection in the log information with the high anomaly degree is less than preset usage, and a downtime in the log information with the high anomaly degree is less than a preset downtime, adjusting an anomaly degree corresponding to the log information with the high anomaly degree to a non-high anomaly degree.
6. The method according to claim 1, wherein the first statistical information further comprises a quantity of garbage collections in the first detection time window.
7. The method according to claim 1, wherein the method further comprises: if the log information with the high anomaly degree continually occurs for a preset quantity of times in a preset time period, raising an alarm for memory anomaly.
8. The method according to claim 1, wherein the determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree of the log information in the first detection time window comprises: determining, according to an anomaly degree determining rule and based on the first statistical information corresponding to the first detection time window, the anomaly degree of the log information in the first detection time window, wherein the anomaly degree determining rule is obtained in advance based on a garbage collection time, and at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection that are comprised in a second memory log.
9. The method according to claim 8, wherein before the obtaining a first memory log, the method further comprises: obtaining the second memory log, wherein the second memory log comprises log information of a plurality of garbage collections, and log information of each garbage collection comprises a garbage collection time, and comprises at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection; for any one of a plurality of training time windows, determining, based on log information in the any training time window, second statistical information corresponding to the any training time window, wherein the second statistical information comprises at least one of an average downtime in the any training time window, a change from memory usage before earliest garbage collection in the any training time window to memory usage after last garbage collection in the any training time window, and the memory usage after the latest garbage collection in the any training time window, and the log information in the any training time window is log information in which a garbage collection time belongs to the training time window; determining, based on second statistical information corresponding to the plurality of training time windows, an anomaly degree corresponding to each of the plurality of training time windows; and determining the anomaly degree determining rule based on second statistical information and the anomaly degree that correspond to each training time window.
10. The method according to claim 9, wherein the determining, based on second statistical information corresponding to the plurality of training time windows, an anomaly degree corresponding to each of the plurality of training time windows comprises: performing clustering on the second statistical information corresponding to the plurality of training time windows, to classify the second statistical information corresponding to the plurality of training time windows into at least two clusters; obtaining, based on the second statistical information in the at least two clusters, an anomaly degree corresponding to second statistical information in each cluster in the at least two clusters; and determining, based on the anomaly degree corresponding to the second statistical information in each cluster, the anomaly degree corresponding to each training time window, wherein an anomaly degree corresponding to any training time window is an anomaly degree corresponding to a cluster to which second statistical information corresponding to the any training time window belongs.
11. The method according to claim 10, wherein the obtaining, based on the second statistical information in the at least two clusters, an anomaly degree corresponding to second statistical information in each cluster in the at least two clusters comprises: for second statistical information in any cluster in the at least two clusters, calculating an average value for target data in the second statistical information in the any cluster, wherein the target data is one type of data in the second statistical information in the any cluster, and target data in each piece of second statistical information is a same type of data; and determining, based on all average values obtained through calculation, the anomaly degree corresponding to the second statistical information in each cluster in the at least two clusters.
12. The method according to claim 9, wherein after the determining, based on the anomaly degree corresponding to the second statistical information in each cluster, the anomaly degree corresponding to each training time window, and before the determining the anomaly degree determining rule based on second statistical information and the anomaly degree that correspond to each training time window, the method further comprises: if there is a training time window with the high anomaly degree, and maximum memory usage after garbage collection in the training time window with the high anomaly degree is less than the preset usage, and a maximum downtime in the training time window with the high anomaly degree is less than the preset downtime, adjusting an anomaly degree corresponding to the training time window with the high anomaly degree to the non-high anomaly degree.
13. The method according to claim 9, wherein the second statistical information further comprises a quantity of garbage collections in a corresponding training time window.
14. A memory anomaly detection device, wherein the memory anomaly detection device comprises: a processor; and a non-transitory computer readable medium which contains computer-executable instructions; the processor is configured to execute the computer-executable instructions to enable the memory anomaly detection device to perform operations comprising: obtaining a first memory log, wherein the first memory log comprises log information of a plurality of garbage collections, and log information of each garbage collection comprises a garbage collection time, and comprises at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection; obtaining, based on log information in a first detection time window, first statistical information corresponding to the first detection time window, wherein the log information in the first detection time window is log information in which a garbage collection time belongs to the first detection time window, and the first statistical information comprises at least one of an average downtime in the first detection time window, a change from memory usage before earliest garbage collection in the first detection time window to memory usage after latest garbage collection in the first detection time window, and the memory usage after the latest garbage collection in the first detection time window; and determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree corresponding to the log information in the first detection time window.
15. The memory anomaly detection device according to claim 14, wherein the first statistical information further comprises a quantity of garbage collections in the first detection time window.
16. The memory anomaly detection device according to claim 14, wherein the determining, based on the first statistical information corresponding to the first detection time window, an anomaly degree of the log information in the first detection time window comprises: determining, according to an anomaly degree determining rule and based on the first statistical information corresponding to the first detection time window, the anomaly degree of the log information in the first detection time window, wherein the anomaly degree determining rule is obtained in advance based on a garbage collection time, and at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection that are comprised in a second memory log.
17. The memory anomaly detection device according to claim 16, wherein before the obtaining a first memory log, the processor is further configured to execute the computer-executable instructions to enable the memory anomaly detection device to perform operations comprising: obtaining the second memory log, wherein the second memory log comprises log information of a plurality of garbage collections, and log information of each garbage collection comprises a garbage collection time, and comprises at least one of a downtime, memory usage after garbage collection, and memory usage before garbage collection; for any one of a plurality of training time windows, determining, based on log information in the any training time window, second statistical information corresponding to the any training time window, wherein the second statistical information comprises at least one of an average downtime in the any training time window, a change from memory usage before earliest garbage collection in the any training time window to memory usage after last garbage collection in the any training time window, and the memory usage after the latest garbage collection in the any training time window, and the log information in the any training time window is log information in which a garbage collection time belongs to the training time window; determining, based on second statistical information corresponding to the plurality of training time windows, an anomaly degree corresponding to each of the plurality of training time windows; and determining the anomaly degree determining rule based on second statistical information and the anomaly degree that correspond to each training time window.
18. The memory anomaly detection device according to claim 17, wherein the determining, based on second statistical information corresponding to the plurality of training time windows, an anomaly degree corresponding to each of the plurality of training time windows comprises: performing clustering on the second statistical information corresponding to the plurality of training time windows, to classify the second statistical information corresponding to the plurality of training time windows into at least two clusters; obtaining, based on the second statistical information in the at least two clusters, an anomaly degree corresponding to second statistical information in each cluster in the at least two clusters; and determining, based on the anomaly degree corresponding to the second statistical information in each cluster, the anomaly degree corresponding to each training time window, wherein an anomaly degree corresponding to any training time window is an anomaly degree corresponding to a cluster to which second statistical information corresponding to the any training time window belongs.
19. The memory anomaly detection device according to claim 18, wherein the obtaining, based on the second statistical information in the at least two clusters, an anomaly degree corresponding to second statistical information in each cluster in the at least two clusters comprises: for second statistical information in any cluster in the at least two clusters, calculating an average value for target data in the second statistical information in the any cluster, wherein the target data is one type of data in the second statistical information in the any cluster, and target data in each piece of second statistical information is a same type of data; and determining, based on all average values obtained through calculation, the anomaly degree corresponding to the second statistical information in each cluster in the at least two clusters.
20. The memory anomaly detection device according to claim 17, wherein the second statistical information further comprises a quantity of garbage collections in a corresponding training time window.
</claims>
</document>

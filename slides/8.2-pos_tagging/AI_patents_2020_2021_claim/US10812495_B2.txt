<document>

<filing_date>
2018-10-05
</filing_date>

<publication_date>
2020-10-20
</publication_date>

<priority_date>
2017-10-06
</priority_date>

<ipc_classes>
G06K9/62,G06N20/00,H04L29/06
</ipc_classes>

<assignee>
UVIC INDUSTRY PARTNERSHIPS
</assignee>

<inventors>
TRAORE, ISSA
BROCARDO, MARCELO LUIZ
</inventors>

<docdb_family_id>
65993732
</docdb_family_id>

<title>
Secure personalized trust-based messages classification system and method
</title>

<abstract>
Technologies are described for authenticating a sender identity of an online message. For example, an online message having a purported sender identity can be obtained. Various features can then be extracted from the message, including stylometric features, origin location features, attached file features for any files attached to the message, and embedded URL features. The extracted features can then be compared to a sender profile for a known sender identity matching the purported sender identity, or to one or more sender profiles for recognized suspicious senders if the purported sender identity does not match a known sender identity. The sender profile for a given sender identity can include features extracted from one or more messages previously sent by the sender identity. A global risk score for the message indicating a likelihood that the purported sender identity is inauthentic can be determined based at least in part upon the comparison.
</abstract>

<claims>
We claim:
1. A method, performed by one or more computing devices, for authenticating a sender of an online message, the method comprising: obtaining an online message having a purported sender identity; extracting stylometric features from the message, wherein the stylometric features extracted from the message comprise at least a first stylometric feature and a second stylometric feature; determining a first information gain associated with the first stylometric feature; determining a second information gain associated with the second stylometric feature; determining a third information gain associated with a third stylometric feature, the third stylometric feature obtained by merging the first and second stylometric features; determining that the third information gain is greater than the first information gain and the second information gain; responsive to determining that the third information gain is greater than the first information gain and the second information gain, excluding the first and second stylometric features from a subset of stylometric features including the stylometric features extracted from the message, and adding the third stylometric feature to the subset of stylometric features; identifying, in a data store storing respective profiles for a plurality of known sender identities and recognized suspicious sender identities, a profile associated with a known sender identity matching the purported sender identity, wherein the stored profile for a given sender identity includes stylometric features extracted from one or more messages previously sent by the sender identity; comparing the stylometric features extracted from the message with stylometric features in the identified profile associated with the known sender identity matching the purported sender identity, wherein comparing the stylometric features extracted from the message with the stylometric features in the identified profile comprises comparing only the subset of stylometric features with the stylometric features in the identified profile; determining a risk score for the message based at least in part upon results of the comparison; and outputting the risk score.
2. The method of claim 1, wherein the online message is a first online message having a first purported sender identity, the method further comprising: obtaining a second online message having a second purported sender identity different than the first purported sender identity; extracting stylometric features from the second message; determining that none of the known sender identities having profiles stored in the data store match the second purported sender identity; comparing the stylometric features extracted from the second message with stylometric features in the profiles of the recognized suspicious sender identities stored in the data store; and based at least in part upon the comparison of the stylometric features extracted from the second message with the stylometric features in the profiles of the recognized suspicious sender identities stored in the data store, producing a matching score indicating how closely the second purported sender identity matches at least one of the recognized suspicious sender identities.
3. The method of claim 2, further comprising: determining that the matching score is greater than a predetermined threshold for one of the recognized suspicious sender identities; and based upon determining that the matching score is greater than the predetermined threshold, associating the second message with the matching recognized suspicious sender identity, and flagging the second message as untrustworthy.
4. The method of claim 2, further comprising: determining that the respective matching scores for all of the recognized suspicious sender identities are less than a predetermined threshold; and based upon determining that the respective matching scores are all less than the predetermined threshold, indicating that the second purported sender identity is an unverified identity.
5. The method of claim 1, further comprising: determining that the risk score is lower than a predetermined threshold; and updating the profile of the known sender identity based at least in part upon the stylometric features extracted from the message.
6. The method of claim 1, wherein the stored profile for a given sender identity further includes a location profile for the sender identity, the location profile produced based at least in part upon an origin location of one or more messages previously sent by the sender identity and IP addresses associated with the one or more messages previously sent by the sender identity, the method further comprising: determining an origin location of the message; and comparing the origin location of the message with the location profile associated with the known sender identity, wherein the determination of the risk score is further based at least in part upon results of the comparison of the origin location of the message with the location profile associated with the known sender identity.
7. The method of claim 1, wherein the message includes one or more attached files, the method further comprising: extracting one or more attributes from each of the attached files; and comparing the extracted attributes with attached file attributes in the identified profile, wherein the determination of the risk score is further based at least in part upon results of the comparison of the extracted attributes with the attached file attributes in the identified profile, and wherein the attributes comprise one or more of the following: a file name, a file format, or a file size.
8. The method of claim 1, wherein the message includes one or more embedded URLs, the message further comprising: extracting one or more features of each embedded URL; and comparing the extracted features of each embedded URL with embedded URL features in the identified profile, wherein the determination of the risk score is further based at least in part upon results of the comparison of the extracted features of each embedded URL with the embedded URL features in the identified profile.
9. The method of claim 8, further comprising: analyzing the extracted features of each embedded URL using a classifier, the classifier trained using sample malicious and legitimate URLs, wherein the determination of the risk score is further based at least in part upon results of the analysis.
10. The method of claim 8, wherein the one or more features extracted from each embedded URL are extracted from a second level domain (SLD) of the URL, and comprise one or more of the following: a total number of characters in the SLD, a total number of vowels in the SLD, a total number of consonants in the SLD, a total number of digits in the SLD, or a total number of special characters in the SLD.
11. The method of claim 1, wherein comparing the stylometric features extracted from the message with stylometric features in the identified profile comprises determining a ratio of a number of unique n-grams shared by a block of characters of the message and a training set, the training set comprising a plurality of blocks of characters from the one or more messages previously sent by the known sender identity.
12. The method of claim 11, wherein comparing the stylometric features extracted from the message with stylometric features in the identified profile further comprises comparing the ratio to a threshold for the known sender identity, the threshold derived using supervised learning.
13. The method of claim 1, further comprising: determining a first information entropy of the first stylometric feature; and determining a second information entropy of the second stylometric feature, wherein the determination of the first information gain is based at least in part on the first information entropy, and wherein the determination of the second information gain is based at least in part on the second information entropy.
14. One or more computing devices comprising: processors; and memory; the one or more computing devices configured, via computer-executable instructions, to perform operations for determining a risk score associated with an online message, the operations comprising: obtaining an online message having a purported sender identity; extracting stylometric features from the message, wherein the stylometric features extracted from the message comprise at least a first stylometric feature and a second stylometric feature; determining a first information gain associated with the first stylometric feature; determining a second information gain associated with the second stylometric feature; determining a third information gain associated with a third stylometric feature, the third stylometric feature obtained by merging the first and second stylometric features; determining that the third information gain is greater than the first information gain and the second information gain; responsive to determining that the third information gain is greater than the first information gain and the second information gain, excluding the first and second stylometric features from a subset of stylometric features including the stylometric features extracted from the message, and adding the third stylometric feature to the subset of stylometric features; extracting origin location features from the message; extracting attached file features for any files attached to the message; extracting embedded URL features for any URLs embedded in the message; identifying, in a data store, a sender profile for a known sender identity matching the purported sender identity, the sender profile comprising features, including stylometric features, extracted from one or more messages previously sent by the known sender identity; comparing the extracted features to the sender profile, comprising comparing only the subset of stylometric features with the stylometric features in the sender profile; determining a global risk score for the message based at least in part upon the comparison; and outputting the global risk score.
15. The one or more computing devices of claim 14, wherein the extracted stylometric features, message origin features, embedded URL features, and attached file features are stored in respective feature vectors, wherein comparing the extracted features to the sender profile comprises, for each feature vector, submitting the feature vector to a classification model, using the classification model to match the feature vector to the sender profile, and determining an individual risk score and a classification error rate for the feature vector.
16. The one or more computing devices of claim 15, wherein the operations further comprise assigning respective weights to the individual risk scores based on the respective classification error rates for the feature vectors, and wherein the determination of the global risk score for the message is based at least in part on the individual risk scores and the assigned weights.
17. The one or more computing devices of claim 14, wherein the data store stores a plurality of sender profiles for known sender identities and a plurality of sender profiles for recognized suspicious sender identities, each sender profile comprising features extracted from one or more messages previously sent by the corresponding sender identity, and wherein the operations further comprise: determining that none of the known sender identities having sender profiles stored in the data store match the purported sender identity; responsive to the determining, comparing the features extracted from the message having the purported sender identity to the sender profiles stored in the data store for the recognized suspicious sender identities.
18. One or more computer-readable storage media storing computer-executable instructions for execution on one or more computing devices to perform operations for determining a risk score associated with an online message, the operations comprising: receiving an indication of a request to send an online message from an account associated with a sender identity; obtaining the message; extracting stylometric features from the message, wherein the stylometric features extracted from the message comprise at least a first stylometric feature and a second stylometric feature; determining a first information gain associated with the first stylometric feature; determining a second information gain associated with the second stylometric feature; determining a third information gain associated with a third stylometric feature, the third stylometric feature obtained by merging the first and second stylometric features; determining that the third information gain is greater than the first information gain and the second information gain; responsive to determining that the third information gain is greater than the first information gain and the second information gain, excluding the first and second stylometric features from a subset of stylometric features including the stylometric features extracted from the message, and adding the third stylometric feature to the subset of stylometric features; comparing the stylometric features extracted from the message to a sender profile associated with the sender identity, wherein the sender profile associated with the sender identity is stored in a data store and comprises stylometric features extracted from one or more messages previously authenticated and sent by the account associated with the sender identity, and wherein comparing the stylometric features extracted from the message with the stylometric features in the sender profile comprises comparing only the subset of stylometric features with the stylometric features in the sender profile; determining a risk score for the message based at least in part upon the comparison; and determining that the risk score is greater than a predetermined threshold; and responsive to determining that the risk score is greater than the predetermined threshold, preventing the message from being sent.
19. The one or more computer-readable storage media of claim 18, wherein the operations further comprise: extracting message origin features, embedded URL features, and attached file features from the message; and comparing the extracted message origin features, embedded URL features, and attached file features to the sender profile, wherein the determination of the risk score for the message is further based at least in part on the comparison of the extracted message origin features, embedded URL features, and attached file features to the sender profile.
</claims>
</document>

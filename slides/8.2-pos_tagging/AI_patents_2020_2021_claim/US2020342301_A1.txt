<document>

<filing_date>
2019-07-12
</filing_date>

<publication_date>
2020-10-29
</publication_date>

<priority_date>
2018-09-11
</priority_date>

<ipc_classes>
G06F17/15,G06N3/04,G06N3/063,G06N3/08
</ipc_classes>

<assignee>
HUAZHONG UNIVERSITY OF SCIENCE AND TECHNOLOGY
</assignee>

<inventors>
LI YI
PAN, Wenqian
MIAO, Xiangshui
</inventors>

<docdb_family_id>
65606589
</docdb_family_id>

<title>
CONVOLUTIONAL NEURAL NETWORK ON-CHIP LEARNING SYSTEM BASED ON NON-VOLATILE MEMORY
</title>

<abstract>
Disclosed by the disclosure is a convolutional neural network on-chip learning system based on non-volatile memory, comprising: an input module, a convolutional neural network module, an output module and a weight update module. The on-chip learning of the convolutional neural network module implements a synaptic function by using a characteristic which the conductance of a memristor changes according to an applied pulse, and the convolutional kernel value or synaptic weight value is stored in a memristor unit; the input module converts an input signal into a voltage signal required by the convolutional neural network module; the convolutional neural network module converts the input voltage signal level by level, and transmits the result to the output module to obtain an output of the network; and the weight update module adjusts the conductance value of the memristor in the convolutional neural network module according to the result of the output module to update a network convolutional kernel value or synaptic weight value.
</abstract>

<claims>
1. A convolutional neural network on-chip learning system based on a non-volatile memory, characterized in comprising: an input module, a convolutional neural network module, an output module and a weight update module; wherein the input module converts an input signal into an input voltage pulse signal required by the convolutional neural network module, and then transmits the input voltage pulse signal to the convolutional neural network module; the convolutional neural network module performs a layer-by-layer calculation and conversion on the input voltage pulse signal corresponding to the input signal to complete an on-chip learning to obtain an output signal, the on-chip learning implements a synaptic function by using a conductance modulation characteristic that a conductance of a memristor changes according to an applied pulse, network convolution kernel values or synaptic weight values adopted in the on-chip learning process is stored in the memristor; the output module converts and sends an output signal generated by the convolutional neural network module to the weight update module; the weight update module calculates an error signal and adjusts the conductance value of the memristor according to a result of the output module, so as to update the network convolution kernel values or the synaptic weight values.
2. The convolutional neural network on-chip learning system based on the non-volatile memory according to claim 1, characterized in that the input module converts an external input signal into the input voltage pulse signal required by the convolutional neural network, pulse width or pulse amplitude of the input signal and the input voltage pulse signal follow a proportional relationship, and the input voltage pulse signal is less than an erase voltage of the memristor.
3. The convolutional neural network on-chip learning system based on the non-volatile memory according to claim 1, characterized in that the convolutional neural network module adopts the memristor to simulate the network convolution kernel values and the synaptic weight values, and a resistance of the memristor changes according to an applied electrical signal; the convolutional neural network module comprises a convolution layer circuit unit, a pooling layer circuit unit, and a fully connected layer circuit unit, the convolution layer circuit unit and the pooling layer circuit unit are composed by using the memristor array as convolution kernels, and the fully connected layer circuit unit is composed by using the memristor array as synapses; the convolutional layer circuit unit receives the input voltage pulse signal output by the input module, and the input voltage pulse signal is processed through the layer-by-layer calculation and conversion performed by the convolutional layer circuit unit, the pooling layer circuit unit, and the fully connected layer circuit unit, and a calculation result is transmitted to the output module as an output signal.
4. The convolutional neural network on-chip learning system based on the non-volatile memory according to claim 3, characterized in that the convolutional layer circuit unit is composed of a convolution operation circuit and an activation function part, the convolution operation circuit is composed of the memristor array; the convolution operation circuit adopts two rows of memristor arrays as a convolution kernel to realize positive and negative convolution kernel values, when an initial convolution kernel value corresponds to a memristor conductance value, the convolution kernel value is mapped to a matrix capable of performing a matrix multiplication operation with the entire input signal, the convolution kernel is expanded into two large sparse matrices K+ and K−, which are respectively the positive and negative convolution kernel values corresponding to a neuron node, and correspondingly a characteristic that the memristor is capable of being applied with positive and negative read voltage pulses is utilized to convert the input signal into two one-dimensional matrices with positive input X and negative input −X; the convolution operation circuit performs a convolution operation on the input voltage pulse signal and the convolution kernel value stored in a memristor unit, and collects currents of the same column to obtain a convolution operation result, the convolution operation process is y=f((X⊗K+)+(−X⊗K−)+b), wherein y is a result of the convolution operation, ⊗ is a convolution operator, X is an input voltage signal of a front synapse of the neuron node, K+ and K− are respectively the positive and negative convolution kernel values corresponding to the neuron node, b is a bias term corresponding to a convolutional layer network, and f(.) is the activation function; the convolutional layer circuit unit transmits the convolution operation result to the pooling layer circuit unit; the activation function activates the convolution operation result and obtains two opposite output values, y and −y, and simultaneously converts the two opposite output values y and −y into a voltage pulse signal to serve as an input of the pooling layer circuit unit.
5. The convolutional neural network on-chip learning system based on the non-volatile memory according to claim 3, characterized in that the pooling layer circuit unit is divided into an average pooling operation and a maximum pooling operation, which are composed of a pooling operation circuit composed of the memristor array and a voltage conversion sub-unit; the network convolution kernel values stored in the memristor array corresponding to the pooling operation circuit remains unchanged during a training process, circuit structure of the pooling operation circuit and mapping distribution of the convolution kernel are the same as the convolutional layer circuit unit, only the stored convolution kernel value is changed; the voltage conversion sub-unit converts a result of the pooling operation circuit into two opposite voltage pulse signals, h and −h, so as to serve as an input of the fully connected layer circuit unit.
6. The convolutional neural network on-chip learning system based on the non-volatile memory according to claim 4, characterized in that the fully connected layer circuit unit realizes a classification function, and is composed of the fully connected layer circuit composed of the memristor array and a softmax function part, weight mapping methods of the fully connected layer circuit unit and the convolutional layer circuit unit are different; the fully connected layer circuit is configured to store and calculate a weight matrix, only completes a series of multiplication accumulation operations without shifting the weight matrix, two memristors are utilized as a synapse to realize positive and negative weight values, one end of the memristor is connected to the pooling layer circuit unit, and another end of the memristor is connected to the softmax function, the current of the same column is collected to obtain an output result of the layer, the output result is ml=Σl((Wkl+−Wkl−)*hk+bk), in the equation, hk is an input voltage pulse signal of a front synapse of the kth neuron node, Wkl+ and Wkl− are respectively the positive and negative synaptic weight values of the kth input of the lth neuron node stored in the memristor, and an effective weight value of the synapse is Wkl+−Wkl−, thereby realizing positive and negative synaptic weight values, bk is a bias term corresponding to the kth neuron node; ml represents an lth element output through the operation of the fully connected layer circuit; Σj emj is an exponential sum of all output signal elements; zl is a probability output value corresponding to the signal ml after being processed through the so max function; the softmax function realizes that is, the function of normalizing the values output by the fully connected layer to a probability value, and then the result is transmitted to the output module to obtain an output of the entire convolutional neural network, and the result is sent to the weight update module.
7. The convolutional neural network on-chip learning system based on the non-volatile memory according to claim 1, characterized in that the weight update module comprises a result comparison unit, a calculation unit, and a driving unit; the result comparison unit is connected to the output module and the calculation unit respectively, the result comparison unit compares an output result of the current convolutional neural network module with a preset ideal result, and sends a comparison result to the calculation unit; the calculation unit is connected to the result comparison unit and the driving unit respectively, the calculation unit receives the error signal δ sent from the result comparison unit, and calculates an adjustment amount of the network convolution kernel values or the weight value according to a determined neural network backpropagation algorithm, and then sends a result to the driving unit, the driving unit comprises a pulse generator and a read-write circuit, the driving unit receives the adjustment amount of the convolution kernel value or the weight value sent from the calculation unit, and adjusts a conductance of the memristors of the convolutional layer circuit unit and the fully connected layer circuit unit; the pulse generator is configured to generate a modulation signal for adjusting the conductance of the memristor; the read-write circuit completes read and write operations on the convolution kernel value or the synaptic weight values of the convolutional neural network module based on the memristor.
</claims>
</document>

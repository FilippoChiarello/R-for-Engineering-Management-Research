<document>

<filing_date>
2018-07-24
</filing_date>

<publication_date>
2020-02-25
</publication_date>

<priority_date>
2012-11-08
</priority_date>

<ipc_classes>
G06N20/00,G06N5/04
</ipc_classes>

<assignee>
23ANDME
</assignee>

<inventors>
DO, CHUONG
DURAND, ERIC
MACPHERSON, JOHN MICHAEL
</inventors>

<docdb_family_id>
54783197
</docdb_family_id>

<title>
Ancestry painting with local ancestry inference
</title>

<abstract>
Presenting ancestral origin information, comprising: receiving a request to display ancestry data of an individual; obtaining ancestry composition information of the individual, the ancestry composition information including information pertaining to a proportion of the individual's genotype data that is deemed to correspond to a specific ancestry; and presenting the ancestry composition information to be displayed.
</abstract>

<claims>
1. A system of presenting ancestral origin information, comprising: one or more processors configured to: receive a request to display ancestry composition information of an individual for whom genotype data is available; obtain ancestry composition information of the individual, the ancestry composition information including information pertaining to a proportion of the individual's genotype data that is deemed to correspond to a geographical ancestry and exceed a predetermined confidence level; cause the ancestry composition information of the individual to be displayed in an interactive user interface adapted to allow the individual to interact with the ancestry composition information of the individual, wherein the interactive user interface includes a graphical representation of the ancestry composition information of the individual to be displayed, the graphical representation comprising: i) a portion of a world map showing a geographical region that corresponds to the geographical ancestry; and ii) a tabular or list view of the proportion of the individual's genotype data that is deemed to correspond to the geographical ancestry represented as a percentage, wherein the proportion of the individual's genotype data comprises autosomal chromosome data; and receive a user request when a pointing mechanism moves over or clicks on the geographical region on the world map or the geographical ancestry in the tabular or list view and respond to the user request by expanding the geographical region or the tabular or list view; and one or more memories coupled to the one or more processors, configured to provide the one or more processors with instructions.
2. The system of claim 1, wherein the graphical representation includes a plurality of geographical ancestries and a plurality of colors, with a unique color of the plurality of colors selected for each of the geographical ancestries.
3. The system of claim 1, wherein the interactive user interface is configured for display on a mobile device, smartphone, or tablet.
4. The system of claim 3, wherein the interactive user interface is configured to receive a user interaction from the mobile device, smartphone, or tablet.
5. The system of claim 1, wherein the interactive user interface is configured to receive a user request when the user moves the pointing mechanism over or clicks on a region on a world map and respond to the user request by expanding the region to display sub-regions.
6. The system of claim 1, wherein the interactive user interface is configured for display on a webpage to be presented on a computer display and the interactive user interface is configured to receive a user interaction from a pointing device.
7. The system of claim 1, wherein the geographical region is selected from African, Native American, Southern Asian, Eastern European, North-Western European, Middle Eastern, and Balkan regions.
8. The system of claim 1, wherein the geographical region is one of: Greece, Italy, Ireland, France, Germany, Finland, and United Kingdom.
9. The system of claim 1, wherein the ancestry composition information is determined by a pipeline process using the individual's genotype data as an input, the pipelined process comprising: receiving a phased haplotype data; and classifying a plurality of portions of the phased haplotype data as likely corresponding to one or more geographical ancestries by comparing the plurality of portions of the phased haplotype data to a plurality of reference populations.
10. The system of claim 9, further comprising: summing up the one or more geographical ancestries of the plurality of portions of the phased haplotype data to generate the geographical ancestry of the ancestry composition information represented as a percentage.
11. The system of claim 9, wherein classifying the plurality of portions of the phased haplotype data as likely corresponding to one or more geographical ancestries by comparing the plurality of portions of the phased haplotype data to a plurality of reference populations is done with a trained model.
12. The system of claim 1, wherein the genotype data includes single nucleotide polymorphism (SNP) based genotype data.
13. The system of claim 1, wherein the ancestry composition information includes information pertaining to a plurality of proportions of the individual's genotype data each of which is deemed to correspond to a respective one of a plurality of geographical ancestries and wherein the portion of the world map shows a plurality of geographical regions each of which corresponds to a respective one of the plurality of geographical ancestries.
14. The system of claim 1, wherein the one or more memories are further configured to provide the one or more processors with instructions which when executed cause the one or more processors to: receive a request via the interactive user interface to display one or more subregions of the geographical region that correspond to the proportion of the individual's genotype data that is deemed to correspond to the geographical ancestry; and cause the one or more subregions to be displayed on the interactive user interface.
15. The system of claim 14, wherein the one or more processors are further configured to cause one or more proportions of the individual's genotype data that are deemed to correspond to respective ones of the one or more subregions to be displayed on the interactive user interface as percentages.
16. The system of claim 15, wherein the geographical region is a continental region.
17. The system of claim 15, wherein the one or more subregions are sub-continental regions.
18. The system of claim 1, further comprising: providing an estimated confidence level for the geographical ancestry on the graphical representation.
19. The system of claim 1, further comprising: one or more databases comprising a plurality of reference populations for geographical ancestries, the plurality of reference populations comprising a first set of reference populations from one or more publicly available databases and a second set of reference populations based on genotype data associated with one or more individuals who self-identified or were identified by the system as having a particular geographical ancestry.
20. The system of claim 19, wherein the individuals who self-identified or were identified by the system as having a particular geographical ancestry includes individuals having four grandparents of the same geographical ancestry.
21. The system of claim 19, wherein the one or more memories are configured to provide the one or more processors with instructions to: receive a phased haplotype data; and compare the phased haplotype data to a plurality of reference populations to generate estimates for the most probable geographical ancestries for the ancestry composition information of the individual.
22. A method of presenting ancestry composition information, comprising: receiving a request to display ancestry composition information of an individual for whom genotype data is available; obtaining ancestry composition information of the individual, the ancestry composition information including information pertaining to a proportion of the individual's genotype data that is deemed to correspond to a geographical ancestry and exceed a predetermined confidence level; and causing the ancestry composition information of the individual to be displayed in an interactive user interface adapted to allow the individual to interact with the ancestry composition information of the individual, wherein the interactive user interface includes a graphical representation of the ancestry composition information of the individual to be displayed, the graphical representation comprising: i) a portion of a world map showing a geographical region that corresponds to the geographical ancestry; and ii) a tabular or list view of the proportion of the individual's genotype data that is deemed to correspond to the geographical ancestry represented as a percentage, wherein the proportion of the individual's genotype data comprises autosomal chromosome data; and receiving a user request when a pointing mechanism moves over or clicks on the geographical region on the world map or the geographical ancestry in the tabular or list view and responding to the user request by expanding the geographical region or the tabular or list view.
23. A computer program product for presenting ancestral origin information, the computer program product being embodied in a tangible computer readable storage medium and comprising computer instructions for: receiving a request to display ancestry composition information of an individual for whom genotype data is available; obtaining ancestry composition information of the individual, the ancestry composition information including information pertaining to a proportion of the individual's genotype data that is deemed to correspond to a geographical ancestry and exceed a predetermined confidence level; and causing the ancestry composition information of the individual to be displayed in an interactive user interface adapted to allow the individual to interact with the ancestry composition information of the individual, wherein the interactive user interface includes a graphical representation of the ancestry composition information of the individual to be displayed, the graphical representation comprising: i) a portion of a world map showing a geographical region that corresponds to the geographical ancestry; and ii) a tabular or list view of the proportion of the individual's genotype data that is deemed to correspond to the geographical ancestry represented as a percentage, wherein the proportion of the individual's genotype data comprises autosomal chromosome data; and receiving a user request when a pointing mechanism moves over or clicks on the geographical region on the world map or the geographical ancestry in the tabular or list view and responding to the user request by expanding the geographical region or the tabular or list view.
24. The system of claim 1, wherein the ancestry composition information is determined by: using a Hidden Markov Model (HMM) to determine a likelihood that a pair of haplotypes come from one or two geographical ancestries.
25. The system of claim 24, wherein the HMM has a plurality of windows, each window representing a maternal haplotype and a paternal haplotype.
26. The system of claim 25, wherein each window comprises a plurality of possible pairs of geographical ancestry that correspond to the maternal haplotype and paternal haplotypes.
27. The system of claim 26, wherein the HMM determines a transition probability for possible pairs of geographical ancestry in adjacent windows based on the possible pairs of geographical ancestry in adjacent windows sharing at least one geographical ancestry.
28. The system of claim 1, wherein a proportion of the individual's genotype data that is deemed to correspond to a particular geographical ancestry is based on a proportion of a Viterbi sequence that is the particular geographical ancestry.
29. The system of claim 1, wherein the ancestry composition information is determined by dividing the genotype data into a plurality of windows each representing a maternal haplotype and a paternal haplotype, wherein each haplotype is likely to come from a single geographical ancestry.
30. The system of claim 1, wherein the ancestry composition information includes a confidence level that a haplotype comes from a particular geographical ancestry.
31. The system of claim 30, wherein the confidence level is based at least in part on a Viterbi estimate of the proportion of the individual's genotype data that is deemed to correspond to a particular geographical ancestry.
32. The system of claim 31, wherein the confidence level is additionally based at least in part on determining an additional plurality of Viterbi estimates.
33. The system of claim 1, wherein: the interactive user interface is configured to receive a user request when a user moves a pointing mechanism over or clicks on a region on the world map and respond to the user request by highlighting subregions of the region that correspond to the geographical ancestry.
34. The system of claim 1, wherein the ancestry composition information is determined based at least in part on a Viterbi sequence of pairs of geographical ancestries for a pair of haplotypes.
35. The system of claim 1, wherein determining the geographical ancestry comprises clustering probabilities associated with a plurality of putative geographical ancestries until the clustered probability exceeds the predetermined confidence level.
36. The system of claim 1, wherein the ancestry composition information is determined by: obtaining unphased genotype data of the individual; phasing the unphased genotype data to generate phased haplotype data; and using a trained model to classify portions of the phased haplotype data as corresponding to geographical ancestries respectively to generate initial classification results; and correcting errors in the initial classification results to generate modified classification results.
37. A system of presenting ancestral origin information, comprising: one or more processors configured to: receive a request to display ancestry composition information of an individual for whom genotype data is available; cause the ancestry composition information of the individual to be displayed in an interactive user interface adapted to allow the individual to interact with the ancestry composition information of the individual, wherein the ancestry composition information includes information pertaining to a proportion of the individual's genotype data that is deemed to correspond with a geographical ancestry and the interactive user interface includes a graphical representation of the ancestry composition information of the individual to be displayed, the graphical representation comprising: a portion of a world map showing a geographical region that corresponds to the geographical ancestry; and the proportion of the individual's genotype data that is deemed to correspond to the geographical ancestry represented as a percentage, wherein the proportion of the individual's genotype data comprises autosomal chromosome data; and receive a request when a pointing device moves over or clicks on a region on the world map and respond to the user request by highlighting subregions of the region that correspond to the geographical ancestry; and one or more memories coupled to the one or more processors, configured to provide the one or more processors with instructions.
38. A system of presenting ancestral origin information, comprising: one or more processors configured to: receive a request to display ancestry composition information of an individual for whom genotype data is available; and cause the ancestry composition information of the individual to be displayed in an interactive user interface adapted to allow the individual to interact with the ancestry composition information of the individual, wherein the ancestry composition information includes information pertaining to a proportion of the individual's genotype data that is deemed to correspond with a geographical ancestry and the interactive user interface is configured for display on a mobile device, smartphone, or tablet, and includes a graphical representation of the ancestry composition information of the individual to be displayed, the graphical representation comprising: a portion of a world map showing a geographical region that corresponds to the geographical ancestry; and the proportion of the individual's genotype data that is deemed to correspond to the geographical ancestry represented as a percentage, wherein the proportion of the individual's genotype data comprises autosomal chromosome data; and one or more memories coupled to the one or more processors, configured to provide the one or more processors with instructions.
</claims>
</document>

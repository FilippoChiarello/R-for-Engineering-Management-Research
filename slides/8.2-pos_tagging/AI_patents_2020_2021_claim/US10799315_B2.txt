<document>

<filing_date>
2017-07-07
</filing_date>

<publication_date>
2020-10-13
</publication_date>

<priority_date>
2016-07-26
</priority_date>

<ipc_classes>
A61B34/00,A61B34/20,A61B90/00,G06K9/46,G06T7/00,G06T7/11,G06T7/30
</ipc_classes>

<assignee>
7D SURGICAL
</assignee>

<inventors>
STANDISH, BEAU ANTHONY
MARIAMPILLAI, ADRIAN
SIEGLER, PETER
YANG, VICTOR X. D.
LEUNG, MICHAEL K. K.
</inventors>

<docdb_family_id>
61015241
</docdb_family_id>

<title>
Systems and methods for verification of fiducial correspondence during image-guided surgical procedures
</title>

<abstract>
Systems and methods are provided for use in image-guided surgical procedures, in which intraoperatively acquired surface data is employed to verify the correspondence between intraoperatively selected fiducial points and volumetric fiducial points, where the volumetric fiducial points are selected based on volumetric image data. Segmented surface data obtained from the volumetric image data is registered to the intraoperative surface data using the intraoperative and volumetric fiducial points for initial surface alignment, and this process is repeated for other permutations of the correspondence between the intraoperatively fiducial points and the volumetric fiducial points. Quality measures may be determined that relate to the registration quality for each fiducial correspondence permutation, where the quality measures may be employed to assess of the likelihood that the initially prescribed fiducial correspondence is correct. A graphical representation may be generated for visually displaying the alignment of the registered surfaces for the different fiducial correspondence permutations.
</abstract>

<claims>
Therefore what is claimed is:
1. A method of performing intraoperative verification of fiducial correspondence, the method comprising: obtaining volumetric image data pertaining to an anatomical region; processing the volumetric image data to generate preliminary surface data characterizing an anatomical surface within the anatomical region; obtaining input identifying at least three volumetric fiducial points associated with the preliminary surface data; employing at least one of the volumetric fiducial points to perform segmentation on the preliminary surface data, thereby obtaining segmented surface data characterizing a surface region of interest within the anatomical surface; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing an exposed surface region including at least a portion of the surface region of interest; obtaining input identifying at least three intraoperative fiducial points associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point, according to a prescribed fiducial correspondence; (i) employing the volumetric fiducial points and the corresponding intraoperative fiducial points to register the segmented surface data to the intraoperative surface data, without performing surface-to-surface registration, thereby obtaining a first preliminary registration based on prescribed fiducial correspondence between the volumetric fiducial points and the intraoperative fiducial points; (ii) employing the first preliminary registration to initiate and perform a first surface-based registration between the segmented surface data and the intraoperative surface data; (iii) determining a first registration quality measure associated with a quality of the surface-based registration; repeating steps (i) to (iii) for one or more permutations of the correspondence between the intraoperative fiducial points and the volumetric fiducial points, thereby performing one or more additional surface-based registrations and obtaining one or more additional registration quality measures respectively associated with the one or more additional surface-based registrations, wherein each additional registration quality measure is associated with a different permutation of the correspondence between the volumetric fiducial points and the intraoperative fiducial points; and providing feedback associated with the registration quality measures.
2. The method according to claim 1 wherein the preliminary surface data characterizes one or more bone surfaces.
3. The method according to claim 2 wherein the preliminary surface data characterizes bone surfaces corresponding to one or more spinal levels.
4. The method according to claim 3 wherein the surface region of interest comprises one or more spinal levels.
5. The method according to claim 1 wherein the preliminary surface data characterizes a soft tissue surface.
6. The method according to claim 1 wherein the feedback is indicative of the fiducial correspondence having a highest associated registration quality measure.
7. The method according to claim 1 wherein the feedback is indicative of whether or not the first registration quality measure is the registration quality measure associated with a highest registration quality.
8. The method according to claim 1 wherein when the first registration quality measure fails to exceed a threshold, the additional surface-based registrations and the additional registration quality measures are generated until a given additional registration quality measure exceeds the threshold, or until all permutations of fiducial correspondences between the volumetric fiducial points and the intraoperative fiducial points have been assessed.
9. The method according to claim 1 wherein the one or more additional surface-based registrations and the determination of the one or more additional registration quality measures are only performed when the first registration quality measure is less than a threshold.
10. The method according to claim 1 further comprising generating a graphical representation of the first surface-based registration and the one or more additional surface-based registrations.
11. A method of performing intraoperative verification of fiducial correspondence, the method comprising: obtaining volumetric image data pertaining to an anatomical region; processing the volumetric image data to generate preliminary surface data characterizing an anatomical surface within the anatomical region; obtaining input identifying at least three volumetric fiducial points associated with the preliminary surface data; employing at least one of the volumetric fiducial points to perform segmentation on the preliminary surface data, thereby obtaining segmented surface data characterizing a surface region of interest within the anatomical surface; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing an exposed surface region including at least a portion of the surface region of interest; obtaining input identifying at least three intraoperative fiducial points associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point, according to a prescribed fiducial correspondence; (i) employing the volumetric fiducial points and the corresponding intraoperative fiducial points to register the segmented surface data to the intraoperative surface data, without performing surface-to-surface registration, thereby obtaining a first preliminary registration based on prescribed fiducial correspondence between the volumetric fiducial points and the intraoperative fiducial points; (ii) determining a first registration quality measure associated with a quality of the preliminary registration; repeating steps (i) and (ii) for one or more permutations of the correspondence between the intraoperative fiducial points and the volumetric fiducial points, thereby performing one or more additional preliminary registrations and obtaining one or more additional registration quality measures respectively associated with the one or more additional preliminary registrations, wherein each additional registration quality measure is associated with a different permutation of the correspondence between the volumetric fiducial points and the intraoperative fiducial points.
12. The method according to claim 11 wherein the preliminary surface data characterizes one or more bone surfaces.
13. The method according to claim 12 wherein the preliminary surface data characterizes bone surfaces corresponding to one or more spinal levels.
14. The method according to claim 13 wherein the surface region of interest comprises one or more spinal levels.
15. The method according to claim 11 wherein the preliminary surface data characterizes a soft tissue surface.
16. The method according to claim 11 further comprising providing feedback associated with the registration quality measures.
17. The method according to claim 11 wherein the registration quality measures are initial registration quality measures, the method further comprising, for each fiducial correspondence permutation having an associated registration measure that satisfies a pre-selected criterion: employing an associated preliminary registration to initiate and perform a surface-based registration between the segmented surface data and the intraoperative surface data; and determining a secondary registration quality measure associated with a quality of the surface-based registration; and providing feedback associated with the secondary registration quality measures.
18. The method according to claim 17 wherein an order of performing the surface-based registrations for the fiducial correspondence permutations having associated registration quality measures that satisfy the pre-selected criterion is determined based on the magnitude of the associated initial registration quality measures.
19. A method of performing intraoperative verification of fiducial correspondence, the method comprising: obtaining volumetric image data pertaining to an anatomical region; processing the volumetric image data to generate preliminary surface data characterizing an anatomical surface within the anatomical region; obtaining input identifying at least three volumetric fiducial points associated with the preliminary surface data; employing at least one of the volumetric fiducial points to perform segmentation on the preliminary surface data, thereby obtaining segmented surface data characterizing a surface region of interest within the anatomical surface; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing an exposed surface region including at least a portion of the surface region of interest; obtaining input identifying at least three intraoperative fiducial points associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point, according to a prescribed fiducial correspondence; (i) employing the volumetric fiducial points and the corresponding intraoperative fiducial points to register the segmented surface data to the intraoperative surface data, without performing surface-to-surface registration, thereby obtaining a first preliminary registration based on prescribed fiducial correspondence between the volumetric fiducial points and the intraoperative fiducial points; (ii) employing the first preliminary registration to initiate and perform a first surface-based registration between the segmented surface data and the intraoperative surface data; repeating steps (i) and (ii) for one or more permutations of the correspondence between the intraoperative fiducial points and the volumetric fiducial points, thereby performing one or more additional surface-based registrations, wherein each additional surface-based registrations is associated with a different permutation of the correspondence between the volumetric fiducial points and the intraoperative fiducial points; and generating a graphical representation of the first surface-based registration and the one or more additional surface-based registrations.
20. The method according to claim 19 wherein the preliminary surface data characterizes one or more bone surfaces.
21. The method according to claim 20 wherein the preliminary surface data characterizes bone surfaces corresponding to one or more spinal levels.
22. The method according to claim 21 wherein the surface region of interest comprises one or more spinal levels.
23. The method according to claim 19 wherein the preliminary surface data characterizes a soft tissue surface.
24. A system for performing intraoperative verification of fiducial correspondence, the system comprising: a surface detection subsystem; and computer hardware operatively coupled to said surface detection subsystem, wherein said computer hardware comprises memory coupled with one or more processors to store instructions, which when executed by the one or more processors, causes the one or more processors to perform operations comprising: processing volumetric image data pertaining to an anatomical region to generate preliminary surface data characterizing an anatomical surface within the anatomical region; receiving input identifying at least three volumetric fiducial points associated with the preliminary surface data; employing at least one of the volumetric fiducial points to perform segmentation on the preliminary surface data, thereby obtaining segmented surface data characterizing a surface region of interest within the anatomical surface; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing an exposed surface region including at least a portion of the surface region of interest; receiving input identifying at least three intraoperative fiducial points associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point, according to a prescribed fiducial correspondence; (i) employing the volumetric fiducial points and the corresponding intraoperative fiducial points to register the segmented surface data to the intraoperative surface data, without performing surface-to-surface registration, thereby obtaining a first preliminary registration based on prescribed fiducial correspondence between the volumetric fiducial points and the intraoperative fiducial points; (ii) employing the first preliminary registration to initiate and perform a first surface-based registration between the segmented surface data and the intraoperative surface data; (iii) determining a first registration quality measure associated with a quality of the surface-based registration; repeating steps (i) to (iii) for one or more permutations of the correspondence between the intraoperative fiducial points and the volumetric fiducial points, thereby performing one or more additional surface-based registrations and obtaining one or more additional registration quality measures respectively associated with the one or more additional surface-based registrations, wherein each additional registration quality measure is associated with a different permutation of the correspondence between the volumetric fiducial points and the intraoperative fiducial points; and providing feedback associated with the registration quality measures.
25. A system for performing intraoperative verification of fiducial correspondence, the system comprising: a surface detection subsystem; and computer hardware operatively coupled to said surface detection subsystem, wherein said computer hardware comprises memory coupled with one or more processors to store instructions, which when executed by the one or more processors, causes the one or more processors to perform operations comprising: processing volumetric image data pertaining to an anatomical region to generate preliminary surface data characterizing an anatomical surface within the anatomical region; receiving input identifying at least three volumetric fiducial points associated with the preliminary surface data; employing at least one of the volumetric fiducial points to perform segmentation on the preliminary surface data, thereby obtaining segmented surface data characterizing a surface region of interest within the anatomical surface; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing an exposed surface region including at least a portion of the surface region of interest; receiving input identifying at least three intraoperative fiducial points associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point, according to a prescribed fiducial correspondence; (i) employing the volumetric fiducial points and the corresponding intraoperative fiducial points to register the segmented surface data to the intraoperative surface data, without performing surface-to-surface registration, thereby obtaining a first preliminary registration based on prescribed fiducial correspondence between the volumetric fiducial points and the intraoperative fiducial points; (ii) determining a first registration quality measure associated with a quality of the preliminary registration; repeating steps (i) and (ii) for one or more permutations of the correspondence between the intraoperative fiducial points and the volumetric fiducial points, thereby performing one or more additional preliminary registrations and obtaining one or more additional registration quality measures respectively associated with the one or more additional preliminary registrations, wherein each additional registration quality measure is associated with a different permutation of the correspondence between the volumetric fiducial points and the intraoperative fiducial points.
26. A system for performing intraoperative verification of fiducial correspondence, the system comprising: a surface detection subsystem; and computer hardware operatively coupled to said surface detection subsystem, wherein said computer hardware comprises memory coupled with one or more processors to store instructions, which when executed by the one or more processors, causes the one or more processors to perform operations comprising: processing volumetric image data pertaining to an anatomical region to generate preliminary surface data characterizing an anatomical surface within the anatomical region; receiving input identifying at least three volumetric fiducial points associated with the preliminary surface data; employing at least one of the volumetric fiducial points to perform segmentation on the preliminary surface data, thereby obtaining segmented surface data characterizing a surface region of interest within the anatomical surface; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing an exposed surface region including at least a portion of the surface region of interest; receiving input identifying at least three intraoperative fiducial points associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point, according to a prescribed fiducial correspondence; (i) employing the volumetric fiducial points and the corresponding intraoperative fiducial points to register the segmented surface data to the intraoperative surface data, without performing surface-to-surface registration, thereby obtaining a first preliminary registration based on prescribed fiducial correspondence between the volumetric fiducial points and the intraoperative fiducial points; (ii) employing the first preliminary registration to initiate and perform a first surface-based registration between the segmented surface data and the intraoperative surface data; repeating steps (i) and (ii) for one or more permutations of the correspondence between the intraoperative fiducial points and the volumetric fiducial points, thereby performing one or more additional surface-based registrations, wherein each additional surface-based registrations is associated with a different permutation of the correspondence between the volumetric fiducial points and the intraoperative fiducial points; and generating a graphical representation of the first surface-based registration and the one or more additional surface-based registrations.
</claims>
</document>

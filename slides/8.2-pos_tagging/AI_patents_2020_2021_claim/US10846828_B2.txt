<document>

<filing_date>
2019-04-22
</filing_date>

<publication_date>
2020-11-24
</publication_date>

<priority_date>
2017-04-06
</priority_date>

<ipc_classes>
G06T5/00
</ipc_classes>

<assignee>
PIXAR
</assignee>

<inventors>
BAKO, STEVE
DEROSE, ANTHONY
MEYER, MARK
</inventors>

<docdb_family_id>
63711195
</docdb_family_id>

<title>
De-noising images using machine learning
</title>

<abstract>
The present disclosure relates to using a neural network to efficiently denoise images that were generated by a ray tracer. The neural network can be trained using noisy images generated with noisy samples and corresponding denoised or high-sampled images (e.g., many random samples). An input feature to the neural network can include color from pixels of an image. Other input features to the neural network, which would not be known in normal image processing, can include shading normal, depth, albedo, and other characteristics available from a computer-generated scene. After the neural network is trained, a noisy image that the neural network has not seen before can have noise removed without needing manual intervention.
</abstract>

<claims>
1. A method for reducing noise in a two-dimensional image obtained from a computer-generated scene, the method comprising: receiving a plurality of noisy subimages, wherein a subimage is at least a portion of an image, and wherein each noisy subimage of the plurality of noisy subimages is rendered using a respective set of rays in a corresponding computer-generated scene; receiving a plurality of refined subimages, each respective refined subimage of the plurality of refined subimages corresponding to a respective noisy subimage of the plurality of noisy subimages and generated using a corresponding computer-generated scene, wherein a respective refined subimage has reduced noise relative to a corresponding noisy subimage; extracting values of a first set of features from pixels in each of the plurality of noisy subimages; determining values of a second set of features from information obtained from the corresponding computer-generated scenes from which the plurality of noisy subimages were generated; training a neural network based on the values of the first set of features, the values of the second set of features, and the plurality of refined subimages, wherein the neural network receives inputs of gradients of pixels of each noisy subimage of the plurality of noisy subimages and outputs gradients of pixels of an output subimage, and wherein the training includes: generating, using the neural network, the gradients of the pixels of the output subimage for a noisy subimage of the plurality of noisy subimages; comparing the gradients of the pixels of the output subimage to gradients of the pixels of a refined subimage of the plurality of refined subimages that corresponds to the noisy subimage; and modifying one or more parameters of the neural network based on the comparison; receiving a new two-dimensional image rendered from a computer-generated scene; and generating, using the neural network after training, a new output image corresponding to the new two-dimensional image.
2. The method of claim 1, wherein a first noisy subimage of the plurality of noisy subimages is rendered using a respective set of rays corresponding to a first computer-generated scene, and wherein a second noisy subimage of the plurality of noisy subimages is rendered using a respective different set of rays for a different set of pixels corresponding to the first computer-generated scene.
3. The method of claim 1, wherein the refined subimage is generated using more rays than the corresponding noisy subimage.
4. The method of claim 1, wherein the refined subimage is a processed version of the corresponding noisy subimage, and wherein the processing includes removing at least a portion of noise from the corresponding noisy subimage using a filter.
5. The method of claim 1, wherein one of the first set of features is associated with a color or an illumination of each pixel of the noisy subimage.
6. The method of claim 1, wherein the one or more parameters that are modified include one or more weights that were determined by the neural network, wherein comparing the output subimage to the refined subimage that corresponds to the noisy subimage includes calculating an error between the gradients of the pixels of the output subimage and the gradients of the pixels of the refined subimage.
7. A non-transitory computer-readable medium storing a computer program that when executed by a processor of a computer cause the processor to implement a computer-implemented method comprising: receiving a plurality of noisy subimages, wherein a subimage is at least a portion of an image, and wherein each noisy subimage of the plurality of noisy subimages is rendered using a respective set of rays in a corresponding computer-generated scene; receiving a plurality of refined subimages, each respective refined subimage of the plurality of refined subimages corresponding to a respective noisy subimage of the plurality of noisy subimages and generated using a corresponding computer-generated scene, wherein a respective refined subimage has reduced noise relative to a corresponding noisy subimage; extracting values of a first set of features from pixels in each of the plurality of noisy subimages; determining values of a second set of features from information obtained from the corresponding computer-generated scenes from which the plurality of noisy subimages were generated; training a neural network based on the values of the first set of features, the values of the second set of features, and the plurality of refined subimages, wherein the neural network receives inputs of gradients of pixels of each noisy subimage of the plurality of noisy subimages and outputs gradients of pixels of an output subimage, and wherein the training includes: generating, using the neural network, the gradients of the pixels of the output subimage for a noisy subimage of the plurality of noisy subimages; comparing the gradients of the pixels of the output subimage to gradients of the pixels of a refined subimage of the plurality of refined subimages that corresponds to the noisy subimage; and modifying one or more parameters of the neural network based on the comparison; receiving a new two-dimensional image rendered from a computer-generated scene; and generating, using the neural network after training, a new output image corresponding to the new two-dimensional image.
8. The non-transitory computer-readable medium of claim 7, wherein a first noisy subimage of the plurality of noisy subimages is rendered using a respective set of rays corresponding to a first computer-generated scene, and wherein a second noisy subimage of the plurality of noisy subimages is rendered using a respective different set of rays for a different set of pixels corresponding to the first computer-generated scene.
9. The non-transitory computer-readable medium of claim 7, wherein the refined subimage is generated using more rays than the corresponding noisy subimage.
10. The non-transitory computer-readable medium of claim 7, wherein the refined subimage is a processed version of the corresponding noisy subimage, and wherein the processing includes removing at least a portion of noise from the corresponding noisy subimage using a filter.
11. The non-transitory computer-readable medium of claim 7, wherein one of the first set of features is associated with a color or an illumination of each pixel of the noisy subimage.
12. The non-transitory computer-readable medium of claim 7, wherein the one or more parameters that are modified include one or more weights that were determined by the neural network, wherein comparing the output subimage to the refined subimage that corresponds to the noisy subimage includes calculating an error between the gradients of the pixels of the output subimage and the gradients of the pixels of the refined subimage.
13. A computing system comprising: one or more processors configured to: receive a plurality of noisy subimages, wherein a subimage is at least a portion of an image, and wherein each noisy subimage of the plurality of noisy subimages is rendered using a respective set of rays in a corresponding computer-generated scene; receive a plurality of refined subimages, each refined subimage of the plurality of refined subimages corresponding to a respective noisy subimage of the plurality of noisy subimages and generated using a corresponding computer-generated scene, wherein a respective refined subimage has reduced noise relative to a corresponding noisy subimage; extract values of a first set of features from pixels in each of the plurality of noisy subimages; determine values of a second set of features from information obtained from the corresponding computer-generated scenes from which the plurality of noisy subimages were generated; train a neural network based on the values of the first set of features, values of the second set of features, and the plurality of refined subimages, wherein the neural network receives inputs of gradients of pixels of each noisy subimage of the plurality of noisy subimages and outputs gradients of pixels of an output subimage, and wherein the training includes: generating, using the neural network, the gradients of pixels of the output subimage for a noisy subimage of the plurality of noisy subimages; comparing the gradients of pixels of the output subimage to gradients of the pixels of a refined subimage of the plurality of refined subimages that corresponds to the noisy subimage; and modifying one or more parameters of the neural network based on the comparison; receive a new two-dimensional image rendered from a computer-generated scene; and generate, using the neural network after training, a new output image corresponding to the new two-dimensional image.
14. The computing system of claim 13, wherein one of the first set of features is associated with a color or an illumination of each pixel of the noisy subimage, and wherein one of the second set of features is associated with a shading normal, a depth, or an albedo used to generate the noisy subimage.
15. The computing system of claim 13, wherein the neural network is a first neural network, wherein the first set of features includes an illumination of the pixels of the noisy subimage, wherein the first neural network is trained based on a first light path, wherein a second neural network is trained based on a second light path, and wherein output of the first neural network and the second neural network are combined to generate the new output image.
</claims>
</document>

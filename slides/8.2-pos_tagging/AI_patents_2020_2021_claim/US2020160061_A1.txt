<document>

<filing_date>
2018-12-11
</filing_date>

<publication_date>
2020-05-21
</publication_date>

<priority_date>
2017-12-11
</priority_date>

<ipc_classes>
G06K9/00,G06K9/62,G06N3/08,G06T7/11,G06T7/277
</ipc_classes>

<assignee>
ZHUHAI DAHENGQIN TECHNOLOGY DEVELOPMENT COMPANY
</assignee>

<inventors>
DENG, LIANBING
</inventors>

<docdb_family_id>
61605528
</docdb_family_id>

<title>
Automatic ship tracking method and system based on deep learning network and mean shift
</title>

<abstract>
An automatic ship tracking method and system based on deep learning network and mean shift, wherein the method includes: collecting surveillance video data which includes collecting coastal region surveillance video data under visible light and extracting each frame of image; performing preprocessing to extract a positive sample and a negative sample of a ship target; inputting the samples of the ship target in the video into a neural network to train a model by a region-based convolutional neural network method; extracting initial frame data of the video and performing ship detection and probability density calculation on initial moment data according to the trained model; and determining a ship tracking result at the current moment by a calculation result of a previous moment.
</abstract>

<claims>
1. An automatic ship tracking method based on a deep learning network and a mean shift, comprising the following steps: step 1: collecting surveillance video data, wherein the surveillance video data comprises coastal region surveillance video data under visible light; and extracting a video image from the surveillance video data; step 2: performing a preprocessing based on the video image obtained in the step 1 to extract a positive sample and a negative sample of a first ship target; step 3: inputting the positive sample and the negative sample of the first ship target in the video image into a neural network to train a model by a region-based convolutional neural network method; step 4: extracting initial frame data of the video image, and performing a ship detection and a probability density calculation on the initial frame data according to the model obtained in the step 3, wherein the probability density calculation is realized by dividing a gray color space of a target region to obtain a gray histogram formed by multiple equal histogram intervals, and calculating the probability density according to one histogram interval of the multiple equal histogram intervals, a gray value of a pixel in the target region belongs to the one histogram interval; and step 5: determining a ship tracking result at a current moment by a calculation result of a previous moment, wherein the step 5 further comprises the following processing: step A: taking ξ ship positions tracked at a moment t−1 as initial positions, respectively taking a center coordinate f0 of each of the ξ ship positions as an initial target position of a ship tracked at a moment t, taking the f0 as a center of a search window to obtain a center position coordinate f of a corresponding candidate ship, calculating a region histogram of a candidate position, and further realizing the probability density calculation; step B: describing a degree of similarity between a ship model and the corresponding candidate ship by a Bhattacharyya coefficient, calculating a mean shift iteration equation in a center of the target region, so that the ship model moves continuously towards a direction with a maximum color change until last two moving distances are less than a corresponding preset threshold, finding a ship position obtained by a mean shift result at the moment t, setting that multiple ship positions Boxmt are obtained, and expressing an idth ship position as Boxmidt; step C: by the region-based convolutional neural network method, performing the ship detection on the video image at the moment t, and obtaining the numth detection coordinate Boxdnumt of multiple ships in the video image at the moment t, calculating a degree of overlap between the Boxdnumt and the Boxmidt, recording a value of degree of overlap Omax between each Boxmidt and the corresponding Boxdnumt with a maximum degree of overlap, and if the Omax is less than a corresponding threshold θ1, considering the ship position as false-alarm and deleting the Boxmidt; and step D: updating a second ship target appeared at the moment t by a neural network detection result of the step C, wherein the step D further comprises calculating a maximum value of the degrees of overlap obtained respectively between each Boxdnumt and all the Boxmidt, if the Omax′ is less than a corresponding threshold θ2, considering the second ship target as the ship appeared at the moment t, and adding the second ship target into a tracking result of the moment t to obtain a complete tracking result set.
2. The automatic ship tracking method based on the deep learning network and the mean shift according to claim 1, wherein a calculation formula of the degree of overlap is as follows: wherein, S represents an area size.
3. An automatic ship tracking system based on a deep learning network and a mean shift, comprising: a first module, wherein the first module is configured to collect surveillance video data and extract a video image from the surveillance video data, and the surveillance video data comprises coastal region surveillance video data under visible light; a second module configured to perform a preprocessing based on the video image obtained by the first module to extract a positive sample and a negative sample of a first ship target; a third module configured to input the positive sample and the negative sample of the first ship target in the video image into a neural network to train a model by a region-based convolutional neural network method; a fourth module configured to extract initial frame data of the video image and perform a ship detection and a probability density calculation on the initial frame data according to the model obtained by the third module, wherein the probability density calculation is realized by dividing a gray color space of a target region to obtain a gray histogram formed by multiple equal histogram intervals, and calculating the probability density according to one histogram interval of the multiple equal histogram intervals, a gray value of a pixel in the target region belongs to the one histogram interval; and a fifth module configured to determine a ship tracking result at a current moment by a calculation result of a previous moment, comprising the following steps: taking ξ ship positions tracked at a moment t−1 as initial positions, respectively taking a center coordinate f0 of each of the ξ ship positions as an initial target position of a ship tracked at a moment t, taking the f0 as a center of a search window to obtain a center position coordinate f of a corresponding candidate ship, calculating a region histogram of a candidate position, and further realizing the probability density calculation; describing a degree of similarity between a ship model and the corresponding candidate ship by a Bhattacharyya coefficient, calculating a mean shift iteration equation in a center of the target region, so that the ship model moves continuously towards a direction with a maximum color change until last two moving distances are less than a corresponding preset threshold, finding a ship position obtained by a mean shift result at the moment t, setting that multiple ship positions Boxmt are obtained, and expressing an idth ship position as Boxmidt; performing the ship detection on the video image at the moment t by the region-based convolutional neural network method, setting that a numth detection coordinate of multiple ships in the video image at the moment t is Boxdnumt, by the region-based convolutional neural network method, performing the ship detection on the video image at the moment t, and obtaining the numth detection coordinate Boxdnumt of multiple ships in the video image at the moment t, calculating a degree of overlap between the Boxdnumt and the Boxmidt, recording a value of degree of overlap Omax between each Boxmidt and the corresponding Boxdnumt with a maximum degree of overlap, and if the Omax is less than a corresponding threshold θ1, considering the ship position as false-alarm and deleting the Boxmidt; and updating a second ship target appeared at the moment t by a neural network detection result, wherein the updating further comprises calculating a maximum value of the degrees of overlap obtained respectively between each Boxdnumt and all the Boxmidt, if the Omax′ is less than a corresponding threshold θ2, considering the second ship target as the ship appeared at the moment t, and adding the second ship target into a tracking result of the moment t to obtain a complete tracking result set.
4. The automatic ship tracking system based on deep learning network and mean shift according to claim 3, wherein a a calculation formula of the degree of overlap is as follows: wherein, S represents an area size.
</claims>
</document>

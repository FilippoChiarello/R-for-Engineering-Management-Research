<document>

<filing_date>
2020-01-09
</filing_date>

<publication_date>
2020-12-03
</publication_date>

<priority_date>
2019-05-31
</priority_date>

<ipc_classes>
G01T1/202,G01T1/29
</ipc_classes>

<assignee>
CANON MEDICAL SYSTEMS CORPORATION
</assignee>

<inventors>
LI, XIAOLI
BURR, KENT C.
</inventors>

<docdb_family_id>
73551222
</docdb_family_id>

<title>
METHOD AND APPARATUS TO USE A BROAD-SPECTRUM ENERGY SOURCE TO CORRECT A NONLINEAR ENERGY RESPONSE OF A GAMMA-RAY DETECTOR
</title>

<abstract>
A method and apparatus are provided for positron emission imaging to calibrate energy measurements of a pixilated gamma-ray detector using energy calibration based on a calibration with a distribution energy signature (i.e., having more spectral features than just a single full-energy peak). The energy calibration can be performed using a deep learning (DL) network or a physics-based model. Using the DL network, a calibration spectrum is applied to either generate the measured-signal values of known energy values (e.g., spectral peaks for spectra of various radioactive isotopes) or the parameters of an energy-calibration function/model.
</abstract>

<claims>
1. An ionizing radiation detection apparatus, comprising: processing circuitry configured to obtain calibration data including a calibration spectrum of ionizing radiation incident at a detector when the detector is irradiated from a calibration source, the calibration spectrum representing counts or intensity of the ionizing radiation as a function of measured signals that, over a predefined energy range, are monotonically related to energies of the ionizing radiation, and determine an energy calibration by applying the calibration spectrum to at least one of an input to a neural network and an input to a physics-based model of a spectrum of the calibration source.
2. The apparatus according to claim 1, wherein the ionizing radiation comprises gamma rays and wherein the processing circuitry is further configured to acquire emission data of the gamma rays incident at the detector, the emission data comprising acquired signals that, over the predefined energy range, are monotonically related to energies of the gamma rays, and apply the energy calibration to the acquired signals to generate energies of detection events of the emission data.
3. The apparatus according to claim 1, wherein, when the calibration spectrum is applied as the input to the neural network, the neural network has been trained using a training dataset including input data and target data, the input data comprising radiation spectra acquired using the calibration source, and the target data comprising values of a mapping between measured signals and energies, the values of the mapping being derived using a second calibration method, which is different from the first calibration method.
4. The apparatus according to claim 1, wherein, when the calibration spectrum is applied as the input to the physics-based model of the calibration source, the processing circuitry is further configured to adjust free parameters of the physics-based model to optimize a fit between the calibration spectrum and a calculated spectrum generated by the physics-based model, wherein the free parameters of the physics-based model include parameters of the energy calibration.
5. The apparatus according to claim 1, wherein the calibration source includes no more than one radioactive isotope, which produces a spectrum having a plurality of structures as a function of absorbed radiation energy.
6. The apparatus according to claim 5, wherein the calibration source is intrinsic to the detector material and/or is lutetium isotope 176 (Lu-176).
7. The apparatus according to claim 5, wherein the calibration data includes at most one other spectrum acquired from another calibration source, the one other calibration source predominantly emitting gamma rays at one energy peak.
8. The apparatus according to claim 7, wherein the no more than one radioactive isotope of the calibration source is lutetium isotope 176 (Lu-176) that is intrinsic to a lutetium based scintillator crystal and the one other calibration source comprises a radioactive isotope selected from the group of cesium isotope 137 and germanium isotope 68.
9. The apparatus according to claim 3, wherein the processing circuitry is further configured to obtain the training dataset, wherein the respective radiation spectra of the input data are paired with the respective values of the mappings of the target data, the values of the mappings being parameters that relate measured signals to energies, use the neural network to output values of the mappings from the respective calibration spectra by applying a given calibration spectrum to the neural network, and train the neural network by iteratively adjusting weighting coefficients the neural network to optimize a value of a loss function, the loss function measuring a disagreement between the output values of the mappings from the neural network and the corresponding values of the mappings from the target data.
10. The apparatus according to claim 1, wherein the measured signal is a time-over-threshold signal or a signal from a detector having a nonlinear response of the measured signal output from the detector relative to an intensity of radiation incident on the detector.
11. The apparatus according to claim 1, wherein the processing circuitry is further configured to sum energies generated for multi-channel detections in the emission data to calculate total energies for each of the multi-channel detections, and generate corrected energies in the emission data, and reconstruct a positron emission tomography (PET) image from the emission data.
12. The apparatus according to claim 1, wherein the processing circuitry is further configured to acquire emission data using a medical imaging scanner, and the medical imaging scanner is selected from (i) a positron emission tomography scanner, (ii) a single photon emission computed tomography scanner, and (iii) an X-ray computed tomography scanner.
13. The apparatus according to claim 9, wherein, when the values of the mappings are the values of measured signals at the known energies, the known energies are peaks in respective energy spectra corresponding to a plurality of isotopes, and the loss function represents a difference between values of the mappings output from the neural network and the values of the mappings from the target data, which are values of peaks in measured energy spectra corresponding to the plurality of isotopes.
14. The apparatus according to claim 9, wherein the processing circuitry is further configured to augment the training dataset to generate an augmented training dataset, and, to augment the training dataset, the processing circuitry is further configured to determine additional parameters that relate measured signals to energies, the additional parameters lying within an extended distribution that is larger than a distribution of the parameters corresponding to the target data, map energies to additional measured signals based on the additional parameters, generate an augmented training dataset including the additional measured signals and the measured signals of the training dataset, wherein the processing circuitry is further configured to train the neural network using the augmented training dataset, which includes the training dataset.
15. A method, comprising: obtaining calibration data including a calibration spectrum of ionizing radiation incident at a detector when the detector is irradiated from a calibration source, the calibration spectrum representing counts or intensity of the ionizing radiation as a function of measured signals that, over a predefined energy range, are monotonically related to energies of the ionizing radiation; and determining an energy calibration by applying the calibration spectrum to at least one of an input to a neural network and an input to a physics-based model of the calibration source.
16. The method according to claim 17, wherein the ionizing radiation comprises gamma rays and the method further comprises acquiring emission data of gamma rays incident at the detector, the emission data comprising acquired signals that, over the predefined energy range, are monotonically related to energies of the gamma rays, and applying the energy calibration to the acquired signals to generate energies of detection events of the emission data.
17. The method according to claim 17, wherein, when the calibration spectrum is applied as the input to the neural network, the step of obtaining the neural network further includes that the neural network has been trained using a training dataset including input data and target data, the input data comprising radiation spectra acquired using the calibration source, and the target data comprising values of a mapping between measured signals and energies, the values of the mapping being derived using a second calibration method, which is different from the first calibration method.
18. The method according to claim 17, wherein, when the calibration spectrum is applied as the input to the physics-based model of the calibration source, the method further comprises adjusting free parameters of the physics-based model to optimize a fit between the calibration spectrum and a calculated spectrum generated by the physics-based model, wherein the free parameters of the physics-based model include parameters of the energy calibration.
19. The method according to claim 17, wherein the step of obtaining the calibration data further includes that the calibration source includes no more than one radioactive isotope, which produces a spectrum having a plurality of structures as a function of absorbed radiation energy.
20. A non-transitory computer-readable storage medium including executable instructions, which when executed by circuitry, cause the circuitry to perform the method according to claim 17.
</claims>
</document>

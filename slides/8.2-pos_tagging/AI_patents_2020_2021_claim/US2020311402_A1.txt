<document>

<filing_date>
2020-06-17
</filing_date>

<publication_date>
2020-10-01
</publication_date>

<priority_date>
2018-04-11
</priority_date>

<ipc_classes>
G06K9/00,G06K9/46,G06K9/62,G06N3/02
</ipc_classes>

<assignee>
TENCENT TECHNOLOGY (SHENZHEN) COMPANY
</assignee>

<inventors>
ZHANG HONG
SHEN, Xiaoyong
JIA, Jiaya
</inventors>

<docdb_family_id>
63514522
</docdb_family_id>

<title>
HUMAN POSE PREDICTION METHOD AND APPARATUS, DEVICE, AND STORAGE MEDIUM
</title>

<abstract>
A human pose prediction method is provided for an electronic device. The method includes using a basic neural network based on image-feature-based prediction to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point; inputting the initial prediction map of the human key-point and a human structure diagram into a pose graph neural network based on spatial information mining, each node in the human structure diagram corresponding to a human joint respectively, and each edge connecting adjacent human joints; using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human key-point, to obtain an initialized human structure diagram; and using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map, the final prediction map indicating a predicted human pose.
</abstract>

<claims>
1. A human pose prediction method for an electronic device, comprising: using a basic neural network based on image-feature-based prediction to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point; inputting the initial prediction map of the human key-point and a human structure diagram into a pose graph neural network based on spatial information mining, each node in the human structure diagram corresponding to a human joint respectively, and each edge connecting adjacent human joints; using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human keypoint, to obtain an initialized human structure diagram; and using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map, the final prediction map indicating a predicted human pose.
2. The method according to claim 1, wherein the using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human key-point, to obtain an initialized human structure diagram comprises: initializing each node in the human structure diagram by using an initial prediction map of a human key-point corresponding to each node as an input of each node, to obtain the initialized human structure diagram, wherein the human key-point comprises at least one of a head, a neck, an elbow, a wrist, a waist, a hip, a crotch, a knee, and an ankle.
3. The method according to claim 1, wherein the pose graph neural network comprises a convolution kernel and a gated recurrent unit; and the using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map comprises: collecting information about an adjacent node of each node in the human structure diagram by using the convolution kernel before each iterative update, to obtain adjacent node information; updating a state of the node according to the adjacent node information by using the gated recurrent unit, the gated recurrent unit being used for digging spatial information between adjacent nodes in the human structure diagram; and obtaining the final prediction map after multiple times of update.
4. The method according to claim 1, wherein the basic neural network comprises a cascade prediction fuse network, and the cascade prediction fuse network comprises n prediction stages, n being a positive integer; the using a basic neural network to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point comprises: obtaining an ith prediction result of the target image in an ith prediction stage of the cascade prediction fuse network, i being a positive integer with an initial value of 1; performing convolution processing by using a 1×1 convolution kernel and non-linear processing on the ith prediction result, to obtain a processed ith prediction result; inputting the ith prediction result into an (i+1)th prediction stage of the cascade prediction fuse network, to obtain an (i+1)th initial prediction result; adding elements of the processed ith prediction result and the (i+1)th initial prediction result together to obtain an (i+1)th prediction result; and repeating the foregoing process, and determining an nth prediction result as the initial prediction map of the human key-point until i+1 is equal to n.
5. The method according to claim 4, wherein the performing convolution processing by using a 1×1 convolution kernel and non-linear processing on the ith prediction result, to obtain a processed ith prediction result comprises: performing convolution processing on the ith prediction result by using a 1×1 convolution kernel, to obtain a convolution result; performing batch normalization on the convolution result to obtain a normalized result; and performing nonlinear processing on the normalized result, to obtain the processed ith prediction result.
6. The method according to claim 1, wherein the basic neural network and the pose graph neural network are obtained by: obtaining a training set, each sample image in the training set corresponding to a calibration result; inputting the sample image into the basic neural network and the pose graph neural network to obtain a prediction result; and calculating a Euclidean distance between the prediction result and the calibration result, and training parameters in the basic neural network and the pose graph neural network according to the Euclidean distance.
7. An electronic device, comprising: a memory storing computer program instructions; and a processor coupled to the memory and, when executing the computer program instructions, configured to perform: using a basic neural network based on image-feature-based prediction to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point; inputting the initial prediction map of the human key-point and a human structure diagram into a pose graph neural network based on spatial information mining, each node in the human structure diagram corresponding to a human joint respectively, and each edge connecting adjacent human joints; using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human key-point, to obtain an initialized human structure diagram; and using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map, the final prediction map indicating a predicted human pose.
8. The electronic device according to claim 7, wherein the using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human key-point, to obtain an initialized human structure diagram comprises: initializing each node in the human structure diagram by using an initial prediction map of a human key-point corresponding to each node as an input of each node, to obtain the initialized human structure diagram, wherein the human key-point comprises at least one of a head, a neck, an elbow, a wrist, a waist, a hip, a crotch, a knee, and an ankle.
9. The electronic device according to claim 7, wherein the pose graph neural network comprises a convolution kernel and a gated recurrent unit; and the using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map comprises: collecting information about an adjacent node of each node in the human structure diagram by using the convolution kernel before each iterative update, to obtain adjacent node information; updating a state of the node according to the adjacent node information by using the gated recurrent unit, the gated recurrent unit being used for digging spatial information between adjacent nodes in the human structure diagram; and obtaining the final prediction map after multiple times of update.
10. The electronic device according to claim 7, wherein the basic neural network comprises a cascade prediction fuse network, and the cascade prediction fuse network comprises n prediction stages, n being a positive integer; the using a basic neural network to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point comprises: obtaining an ith prediction result of the target image in an ith prediction stage of the cascade prediction fuse network, i being a positive integer with an initial value of 1; performing convolution processing by using a 1×1 convolution kernel and non-linear processing on the ith prediction result, to obtain a processed ith prediction result; inputting the ith prediction result into an (i+1)th prediction stage of the cascade prediction fuse network, to obtain an (i+1)th initial prediction result; adding elements of the processed ith prediction result and the (i+1)th initial prediction result together to obtain an (i+1)th prediction result; and repeating the foregoing process, and determining an nth prediction result as the initial prediction map of the human key-point until i+1 is equal to n.
11. The electronic device according to claim 10, wherein the performing convolution processing by using a 1×1 convolution kernel and non-linear processing on the ith prediction result, to obtain a processed ith prediction result comprises: performing convolution processing on the ith prediction result by using a 1×1 convolution kernel, to obtain a convolution result; performing batch normalization on the convolution result to obtain a normalized result; and performing nonlinear processing on the normalized result, to obtain the processed ith prediction result.
12. The electronic device according to claim 7, wherein the basic neural network and the pose graph neural network are obtained by: obtaining a training set, each sample image in the training set corresponding to a calibration result; inputting the sample image into the basic neural network and the pose graph neural network to obtain a prediction result; and calculating a Euclidean distance between the prediction result and the calibration result, and training parameters in the basic neural network and the pose graph neural network according to the Euclidean distance.
13. A non-transitory computer-readable storage medium storing computer program instructions executable by at least one processor to perform: using a basic neural network based on image-feature-based prediction to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point; inputting the initial prediction map of the human key-point and a human structure diagram into a pose graph neural network based on spatial information mining, each node in the human structure diagram corresponding to a human joint respectively, and each edge connecting adjacent human joints; using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human key-point, to obtain an initialized human structure diagram; and using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map, the final prediction map indicating a predicted human pose.
14. The non-transitory computer-readable storage medium according to claim 13, wherein the using the pose graph neural network to initialize the human structure diagram by using the initial prediction map of the human key-point, to obtain an initialized human structure diagram comprises: initializing each node in the human structure diagram by using an initial prediction map of a human key-point corresponding to each node as an input of each node, to obtain the initialized human structure diagram, wherein the human key-point comprises at least one of a head, a neck, an elbow, a wrist, a waist, a hip, a crotch, a knee, and an ankle.
15. The non-transitory computer-readable storage medium e according to claim 13, wherein the pose graph neural network comprises a convolution kernel and a gated recurrent unit; and the using the pose graph neural network to perform iterative prediction on the initialized human structure diagram, to obtain a final prediction map comprises: collecting information about an adjacent node of each node in the human structure diagram by using the convolution kernel before each iterative update, to obtain adjacent node information; updating a state of the node according to the adjacent node information by using the gated recurrent unit, the gated recurrent unit being used for digging spatial information between adjacent nodes in the human structure diagram; and obtaining the final prediction map after multiple times of update.
16. The non-transitory computer-readable storage medium according to claim 13, wherein the basic neural network comprises a cascade prediction fuse network, and the cascade prediction fuse network comprises n prediction stages, n being a positive integer; the using a basic neural network to perform prediction on an inputted target image, to obtain an initial prediction map of a human key-point comprises: obtaining an ith prediction result of the target image in an ith prediction stage of the cascade prediction fuse network, i being a positive integer with an initial value of 1; performing convolution processing by using a 1×1 convolution kernel and non-linear processing on the ith prediction result, to obtain a processed ith prediction result; inputting the ith prediction result into an (i+1)th prediction stage of the cascade prediction fuse network, to obtain an (i+1)th initial prediction result; adding elements of the processed ith prediction result and the (i+1)th initial prediction result together to obtain an (i+1)th prediction result; and repeating the foregoing process, and determining an nth prediction result as the initial prediction map of the human key-point until i+1 is equal to n.
17. The non-transitory computer-readable storage medium according to claim 16, wherein the performing convolution processing by using a 1×1 convolution kernel and non-linear processing on the ith prediction result, to obtain a processed ith prediction result comprises: performing convolution processing on the ith prediction result by using a 1×1 convolution kernel, to obtain a convolution result; performing batch normalization on the convolution result to obtain a normalized result; and performing nonlinear processing on the normalized result, to obtain the processed ith prediction result.
18. The non-transitory computer-readable storage medium according to claim 13, wherein the basic neural network and the pose graph neural network are obtained by: obtaining a training set, each sample image in the training set corresponding to a calibration result; inputting the sample image into the basic neural network and the pose graph neural network to obtain a prediction result; and calculating a Euclidean distance between the prediction result and the calibration result, and training parameters in the basic neural network and the pose graph neural network according to the Euclidean distance.
</claims>
</document>

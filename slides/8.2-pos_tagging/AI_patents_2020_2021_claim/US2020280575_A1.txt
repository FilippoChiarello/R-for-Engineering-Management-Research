<document>

<filing_date>
2020-05-19
</filing_date>

<publication_date>
2020-09-03
</publication_date>

<priority_date>
2016-02-09
</priority_date>

<ipc_classes>
G06F21/55,H04L29/06
</ipc_classes>

<assignee>
DARKTRACE
</assignee>

<inventors>
DEAN, TOM
STOCKDALE, JACK
</inventors>

<docdb_family_id>
55642033
</docdb_family_id>

<title>
ANOMALY ALERT SYSTEM FOR CYBER THREAT DETECTION
</title>

<abstract>
Disclosed herein is a method for use in detection of anomalous behavior of a device of a computer system. The method is arranged to be performed by a processing system. The method includes deriving values, m1, . . . , mN, of a metric, M, representative of data associated with the device; modeling a distribution of the values; and determining, in accordance with the distribution of the values, the probability of observing a more extreme value of the metric than a given value, m, of the metric, wherein the probability is used to determine whether the device is behaving anomalously. Also disclosed is an equivalent computer readable medium and anomalous behavior detection system
</abstract>

<claims>
1. 1-27. (canceled)
28. A method for an anomalous behavior detection system in a network computing system, the method arranged to be performed by a processing system, the method comprising: using data sampled from network traffic by a network traffic monitoring system in the network computing system; modelling a distribution of values of two or more network metrics i) for each device in the network computing system as well as ii) for one or more users in the network computing system in order to create a model of behavior per device in the network computing system as well as for the one or more users in the network computing system; where the two or more network metrics come from the data sampled by the network traffic monitoring system, where the two or more network metrics under analysis are selected from the group consisting of 1) total volume of data flowing from a first device in the network in a given time interval; 2) total volume of data flowing to the first device in the given time interval; 3) number of connections from the first device to other devices on the network in the given time interval; 4) number of connections to the first device from other devices on the network in the given time interval; 5) number of connections from the first device to other devices outside the network in the given time interval; 6) number of connections to the first device from other devices outside the network in the given time interval; 7) number of domain name system (DNS) requests made by the first device in the given time interval; 8) number of multicasts made by the first device in the given time interval; 9) number of broadcasts made by the first device in the given time interval; 10) number of attempts made by the first device to connect to closed ports on other devices in the given time interval; 11) number of server message block (SMB) read requests made by the first device in the given time interval; 12) number of SMB write requests made by the first device in the given time interval; 13) number of failed SMB requests made by the first device in the given time interval; 14) number of attempts at authentication made from the first device in the given time interval; and 15) number of failed attempts at authentication made from the first device in the given time interval; applying one or more anomaly detection algorithms to a subset of data from the two or more network metrics under analysis based upon the model of behavior for the first device in the network; analyzing the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device in the network or for the model of behavior for the first user in the network with one or more machine learning algorithms to determine what is considered to be normal behavior for the first device in the network or for a first user in the network, where historical values of the metrics for that specific device are utilized by the anomalous behavior detection system for training; and utilizing an anomaly alert system that generates a notification when, at least one of the first device and the first user, is determined by the anomalous behavior detection system to have behaved anomalously.
29. The method of claim 28, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least three or more 1) connections from the first device as the source device to other devices as destination devices on the network computing system in the given time interval; 2) connections to the first device as destination from other devices as source devices on the network computing system in the given time interval; 3) connections from the first device as source to other devices outside the network computing system as destination devices in the given time interval; 4) connections to the first device as destination from other devices as source devices outside the network computing system in the given time interval; 5) number of DNS requests made by the first device in the given time interval.
30. The method of claim 28, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least three or more of 1) from IP addresses of connections from the first device to other devices on the network in the given time interval; 2) from IP addresses of connections to the first device from other devices on the network in the given time interval; 3) from IP addresses of connections from the first device to other devices outside the network in the given time interval; 4) from IP addresses of connections to the first device from other devices outside the network in the given time interval; 5) total volume of data flowing from the first device in the given time interval; and 6) total volume of data flowing to the first device in the given time interval.
31. The method of claim 28, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least three or more of 1) from connections from the first device to other devices on the network in the given time interval; 2) from connections to the first device from other devices on the network in the given time interval; 3) from connections from the first device to other devices outside the network in the given time interval; 4) from connections to the first device from other devices outside the network in the given time interval; and where the connections are analyzed in light of a volume of data flowing, from at least one of i) from the first device and ii) to the first device, in the given time interval.
32. The method of claim 28, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least two or more of i) a number of server message block (SMB) read requests made by the first device in the given time interval; ii) a number of SMB write requests made by the first device in the given time interval; and iii) a number of failed SMB requests made by the first device in the given time interval, and making a correlation between 1) the above network metrics and at least one of 2) a low-probability event and a high probability event.
33. The method of claim 28, where the anomalous behavior detection system computes how anomalous the value of each network metric under analysis is, and where individual computed values of how anomalousness of the behavioral metrics under analysis associated with the first device are factored in a combination of these values to produce a measure of an overall anomalousness of the behavior of the first device, and where the anomaly alert system generates the alert about the first device whose behavior is determined to be sufficiently anomalous above a set point.
34. The method of claim 28, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device are the number of connections from the first device to other devices in the given time interval in light of a number of attempts made by the first device to connect to closed ports on other devices in the given time interval.
35. The method of claim 28, wherein a probability and the distribution of the values of the network metrics are used by the model of what is considered to be normal behavior for that device to determine whether the first device is behaving anomalously, wherein the probability is used to determine whether the first device is behaving anomalously.
36. The method of claim 28, further comprising: maintaining one or more mathematical models to build and maintain dynamic, ever-changing models of a normal behavior of each device monitored by the anomalous behavior detection system, based on a comparison of metrics associated with a corresponding device, where two or more devices, including the first device, are monitored by the anomalous behavior detection system, where the anomalous behavior detection system is configured to use the one or more mathematical models to determine whether each corresponding device is behaving anomalously, where each model of a normal behavior of each device monitored is used as a moving benchmark, allowing the anomalous behavior detection system to spot behavior of one or more devices that fall outside of this normal pattern, and flag this behavior as anomalous.
37. The method of claim 28, further comprising: using a framework of ranking different levels of anomalousness to provide a way for a user to specify and control a rate of generating false alerts that should not be brought to an attention of the user.
38. The method of claim 28, further comprising: where a measure of anomalousness of the first device is determined relative to a reference measure of anomalousness based on extreme value theory, where a distribution of values of one or more of the network metrics are modelled using extreme value theory, where a probability of observing a more extreme value than a given value, m, wherein the probability is used to determine whether the device is behaving anomalously.
39. An anomalous behavior detection system for a network computing system, comprising: a network traffic monitoring module configured to use data sampled from network traffic in the network computing system; one or more models to model a distribution of values of two or more network metrics i) for each device in the network computing system as well as ii) for one or more users in the network computing system in order to create a model of behavior per device in the network computing system as well as for the one or more users in the network computing system; where the two or more network metrics come from the data sampled by the network traffic monitoring module, where the two or more network metrics under analysis are selected from the group consisting of 1) total volume of data flowing from a first device in the network in a given time interval; 2) total volume of data flowing to the first device in the given time interval; 3) number of connections from the first device to other devices on the network in the given time interval; 4) number of connections to the first device from other devices on the network in the given time interval; 5) number of connections from the first device to other devices outside the network in the given time interval; 6) number of connections to the first device from other devices outside the network in the given time interval; 7) number of domain name system (DNS) requests made by the first device in the given time interval; 8) number of multicasts made by the first device in the given time interval; 9) number of broadcasts made by the first device in the given time interval; 10) number of attempts made by the first device to connect to closed ports on other devices in the given time interval; 11) number of server message block (SMB) read requests made by the first device in the given time interval; 12) number of SMB write requests made by the first device in the given time interval; 13) number of failed SMB requests made by the first device in the given time interval; 14) number of attempts at authentication made from the first device in the given time interval; and 15) number of failed attempts at authentication made from the first device in the given time interval; one or more anomaly detection algorithms configured to be applied to a subset of data from the two or more network metrics under analysis based upon the model of behavior for the first device in the network; an anomalous behavior detection system configured to analyze the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device in the network or for the model of behavior for the first user in the network with one or more machine learning algorithms to determine what is considered to be normal behavior for the first device in the network or for a first user in the network, where historical values of the metrics for that specific device are utilized by the anomalous behavior detection system for training; and an anomaly alert system configured to generate a notification when, at least one of the first device and the first user, is determined by the anomalous behavior detection system to have behaved anomalously.
40. The anomalous behavior detection system of claim 39, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least three or more 1) connections from the first device as the source device to other devices as destination devices on the network computing system in the given time interval; 2) connections to the first device as destination from other devices as source devices on the network computing system in the given time interval; 3) connections from the first device as source to other devices outside the network computing system as destination devices in the given time interval; 4) connections to the first device as destination from other devices as source devices outside the network computing system in the given time interval; 5) number of DNS requests made by the first device in the given time interval.
41. The anomalous behavior detection system of claim 39, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least three or more of 1) from IP addresses of connections from the first device to other devices on the network in the given time interval; 2) from IP addresses of connections to the first device from other devices on the network in the given time interval; 3) from IP addresses of connections from the first device to other devices outside the network in the given time interval; 4) from IP addresses of connections to the first device from other devices outside the network in the given time interval; 5) total volume of data flowing from the first device in the given time interval; and 6) total volume of data flowing to the first device in the given time interval.
42. The anomalous behavior detection system of claim 39, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least three or more of 1) from connections from the first device to other devices on the network in the given time interval; 2) from connections to the first device from other devices on the network in the given time interval; 3) from connections from the first device to other devices outside the network in the given time interval; 4) from connections to the first device from other devices outside the network in the given time interval; and where the connections are analyzed in light of a volume of data flowing, from at least one of i) from the first device and ii) to the first device, in the given time interval.
43. The anomalous behavior detection system of claim 39, where the subset of data from the two or more network metrics under analysis in light of the model of behavior for the first device includes at least two or more of i) a number of server message block (SMB) read requests made by the first device in the given time interval; ii) a number of SMB write requests made by the first device in the given time interval; and iii) a number of failed SMB requests made by the first device in the given time interval, and making a correlation between 1) the above network metrics and at least one of 2) a low-probability event and a high probability event.
44. The anomalous behavior detection system of claim 39, where the anomalous behavior detection system has one or more processors to compute how anomalous the value of each network metric under analysis is, and where individual computed values of how anomalousness of the behavioral metrics under analysis associated with the first device are factored in a combination of these values to produce a measure of an overall anomalousness of the behavior of the first device, and where the anomaly alert system generates the alert about the first device whose behavior is determined to be sufficiently anomalous above a set point.
45. The anomalous behavior detection system of claim 39, wherein the model of behavior for the first device is configured to determine a measure of anomalousness of the first device relative to a reference measure of anomalousness based on extreme value theory, where a distribution of values of one or more of the network metrics are modelled using extreme value theory, where a probability of observing a more extreme value than a given value, m, wherein the probability is used to determine whether the device is behaving anomalously.
46. The anomalous behavior detection system of claim 39, wherein the model of behavior for the first device is configured to use a probability and the distribution of the values of the network metrics to determine what is considered to be normal behavior for the first device and whether the first device is behaving anomalously, wherein the probability is used to determine whether the first device is behaving anomalously.
47. The anomalous behavior detection system of claim 39, further comprising: one or more mathematical models configured to be maintained to build and maintain dynamic, ever-changing models of a normal behavior of each device monitored by the anomalous behavior detection system, based on a comparison of metrics associated with a corresponding device, where two or more devices, including the first device, are monitored by the anomalous behavior detection system, where the anomalous behavior detection system is configured to use the one or more mathematical models to determine whether each corresponding device is behaving anomalously, where each model of a normal behavior of each device monitored is used as a moving benchmark, allowing the anomalous behavior detection system to spot behavior of one or more devices that fall outside of this normal pattern, and flag this behavior as anomalous.
</claims>
</document>

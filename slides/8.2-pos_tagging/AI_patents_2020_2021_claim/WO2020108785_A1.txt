<document>

<filing_date>
2019-11-25
</filing_date>

<publication_date>
2020-06-04
</publication_date>

<priority_date>
2018-11-29
</priority_date>

<ipc_classes>
G06K9/20,G06K9/46,G06K9/62,G06N3/08
</ipc_classes>

<assignee>
CELLMATIQ
</assignee>

<inventors>
BA√ÅHA, JAROSLAV
WALDRAFF, TASSILO
</inventors>

<docdb_family_id>
69005675
</docdb_family_id>

<title>
METHOD AND DEVICE FOR TRAINING A NEURAL NETWORK TO SPECIFY LANDMARKS ON 2D AND 3D IMAGES
</title>

<abstract>
The present invention relates generally to a method, device and computer program product for training neural networks configured to generate specifications of landmarks related to two-dimensional or three-dimensional image data. The specification of landmarks is defined by three vectors with position, precision and presence values forming landmark specification vectors. The neural network extracts feature vector from input image data using convolutional neural network layers, decodes the feature vector, and outputs landmark specification vectors. The present invention further relates to a system of devices for specifying landmarks on images generated by neural networks running on the devices.
</abstract>

<claims>
1. A computer-implemented method of training a neural network (220; 920; 1220) for generating landmark specification vectors (230, 240, 250; 530, 540, 550; 620, 640; 710, 720; 930, 940, 950; 1140; 1230, 1240, 1250) for processed two-dimensional or three-dimensional images (210; 310; 410; 910; 1010; 1210; 1312), comprising the steps of:
extracting features (420) from the image data (210; 310; 410; 910; 1010; 1210;
1312) with a sub neural network (320; 420; 1020) into a feature vector (430; 510; 610; 1110) comprising encoding (330; 1030) information about position, precision and presence of at least one landmark related to the image data (210; 310; 410; 910; 1010; 1210; 1312);
decoding (340; 520; 1040) the feature vector (430; 510; 610; 1110) into a position value vector (240; 540; 640 ; 710; 940; 1140; 1240), a precision value vector (250; 550; 720; 950; 1250), and a presence value vector (230; 530; 620; 930; 1230); and
minimizing (730; 1420) loss values in regard to ground truth landmarks (740; 810;
1314; 1410), wherein minimizing comprises the steps of:
determining (522) for each landmark the presence value vector (230; 530;
620; 930; 1230) of the landmark on the image (210; 310; 410; 910; 1010; 1210; 1312);
factoring in (633, 636; 1133, 1136) the presence value vector (230; 530;
620; 930; 1230) of the landmark, while positioning (524; 640) the landmark in relation to the image (210; 310; 410; 910; 1010; 1210;
1312); and
evaluating (580; 731) the precision value vector (250; 550; 720; 950; 1250) of the position of the landmark after positioning (524; 640) the landmark in relation to the image (210; 310; 410; 910: 1010; 1210; 1312).
2. Method according to claim 1, wherein in the step of factoring in (633, 636; 1133, 1136) pre-positioned landmarks (960, 1060, 1120, 1260) are factored in in addition to the presence value vector (230; 530; 620; 930; 1230) of the landmark 3. Method according claims 2, further comprising repeating the method at least once, wherein the pre-positioned landmarks (960, 106, 1120, 1260) are based at least partially on the position value vector (240; 540; 640; 710; 940; 1140; 1240) of the previous iteration. 4. Method according to any one of claims 1 to 3, wherein individual landmarks from a set of ground truth landmarks (740; 810; 1314; 1410) of training dataset images (210; 310; 410; 910; 1010; 1210; 1312) can be outside of the image boundaries.
5. Method according to any one of claims 1 to 4, wherein individual landmarks from a set of ground truth landmarks (740; 810; 1314; 1410) of training dataset images
(210; 310; 410; 910; 1010; 1210; 1312) may be undefined, and wherein the method further comprises ignoring (3421) undefined ground truth landmarks.
6. Method according to any one of the preceding claims, wherein the neural network comprises:
convolution based neural network layers for deep machine-learning; and wherein determining (522) the presence value vector (230; 530; 620; 930; 1230) of the landmark is based on deep machine-learnt classification or on determining the position value vector (240; 540; 640; 710; 940; 1140; 1240) or the precision value vector (250; 550; 720; 950; 1250) of the landmark based on deep machine-learnt regression.
7. Method according to any one of the preceding claims, wherein the ground truth landmarks (740; 810; 1314; 1410) comprise at least one of ground truth points (1510, 1511, 1512), ground truth lines (1520), and ground truth regions (1530, 1531).
8. Method according to any one of the preceding claims, wherein the landmarks are anatomical, fiducial, statistical, mathematical, geometrical, facial, key-point or pseudo landmarks.
9. A neural network model that is trained with a method according to any one of the preceding claims.
10. A computer program product including a program for a processing device,
comprising software code portions for performing the steps of any one of claims 1 to 8 when the program is run on the processing device.
11. A computer program product according to claim 10, wherein the computer
program product comprises a computer-readable medium on which the software code portions are stored, wherein the program is directly loadable into an internal memory of the processing device.
12. An apparatus, configured to execute a method according to any one of the claims 1 to 8.
13. An image acquisition device having stored on an internal memory a computer program product according to claim 10 or 11.
</claims>
</document>

<document>

<filing_date>
2018-09-19
</filing_date>

<publication_date>
2020-03-19
</publication_date>

<priority_date>
2018-09-19
</priority_date>

<ipc_classes>
G06N3/08,G06T3/40,G06T7/00,G06T7/11,G06T7/187
</ipc_classes>

<assignee>
INDUS.AI
</assignee>

<inventors>
MAN, LAI HIM MATTHEW
ALY, WALID
SOLTANI, MOHAMMAD
ALY, AHMED
</inventors>

<docdb_family_id>
69774191
</docdb_family_id>

<title>
Patch-based scene segmentation using neural networks
</title>

<abstract>
A method and a system for patch-based scene segmentation using neural networks are presented. In an embodiment, a method comprises: using one or more computing devices, receiving a digital image comprising test image; using the one or more computing devices, creating, based on the test image, a plurality of grid patches; using the one or more computing devices, receiving a plurality of classifiers that have been trained to identify one or more materials of a plurality of materials; using the one or more computing devices, for each patch of the plurality of grid patches, labelling each pixel of a patch with a label obtained by applying, to the patch, one or more classifiers from the plurality of classifiers; using the one or more computing devices, generating, based on labels assigned to pixels of the plurality of grid patches, a grid of labels for the test image.
</abstract>

<claims>
1. A computer-implemented method comprising: using one or more computing devices, receiving a digital image comprising test image; using the one or more computing devices, creating, based on the test image, a plurality of grid patches; using the one or more computing devices, receiving a plurality of classifiers that have been trained to identify one or more materials of a plurality of materials; using the one or more computing devices, for each patch of the plurality of grid patches, labelling each pixel of a patch with a label obtained by applying, to the patch, one or more classifiers from the plurality of classifiers; using the one or more computing devices, generating, based on labels assigned to pixels of the plurality of grid patches, a grid of labels for the test image.
2. The method of claim 1, further comprising: based on, at least in part, the grid of labels, generating a segmentation mask for the test image; based on, at least in part, the segmentation mask, determining a set of materials, of the plurality of materials, that is depicted in the test image; based on, at least in part, the set of materials that has been determined, determining a work status of activities taking place on a site for which the test image was received, the site comprising one or more of a construction site, an industrial site, a warehouse site, a storage site, a commercial site or a residential site.
3. The method of claim 2, further comprising: before each pixel of a patch, of the plurality of grid patches, is labeled with a label, determining whether a pixel-based-size of the patch matches a pixel-based-size of a classifier of the plurality of classifiers; in response to determining that the pixel-based-size of the patch does not match the pixel-based-size of the classifier in the plurality of classifiers, generating a resized patch by either downsizing or upsizing the patch; applying the classifier or a different classifier, from the plurality of classifiers, to the resized patch to determine whether labels can be assigned to pixels of the resized patch; in response to determining that one or more pixels of the resized patch do not have assigned labels, repeating resizing of the patch until all pixels if the resized patch have assigned labels.
4. The method of claim 3, further comprising determining whether labels can be assigned to pixels of the resized patch comprises by applying a majority voting algorithm to labels assigned to pixels of the resized patch to determine the labels for all pixels of the resized patch.
5. The method of claim 4, further comprising: receiving a plurality of training images of the site; determining, based on the plurality of training images, the plurality of materials that is depicted in the plurality of training images; creating, based on the plurality of training images, a plurality of sample images, each sample image depicting at least one material of the plurality of materials; creating, based on the plurality of sample images, a plurality of multi-scale patches for the plurality of materials, each multi-scale patch for a material is created from a sample image of the material from the plurality of materials; designing, using the one or more computing devices, the plurality of classifiers configured to analyze digital images having different sizes; training the plurality of classifiers using the plurality of multi-scale patches as input and using the plurality of materials as output.
6. The method of claim 5, wherein a training image, of the plurality of training images, is a rectangular image; wherein the plurality of training images includes indoor and outdoor images; wherein the test image, of a plurality of test images, is captured by a camera that is installed at a fixed location; wherein the plurality of test images is used to determine work progress over time, to determine quality of materials that are being installed, and to determine correctness of installations; wherein a multi-scale patch, of the plurality of multi-scale patches, is a square image; the materials comprising two or more of: concrete, steel, rebar, plastic, wood, asphalt, porcelain, brick, composite, plaster, gypsum, cement, ceramic, carpet, paint, stucco, mortar, stone, urbanite, wire ropes, wire cables, bamboo, sheath panels, plex panels, plywood, wallpaper, laminate, or veneer; wherein the materials are used to build or install one or more of: buildings, framings, mezzanine floors, purlins, insulations, coating, house wraps, doors, electrical systems, plumbing systems, surface finishing, flooring, wall coverings, heating systems, ventilation systems, air conditioning systems, utility systems, storage systems, roofs, windows, stairs, hangars, storage facilities, warehouse facilities, or garages.
7. The method of claim 6, wherein the plurality of classifiers includes a plurality of convoluted neural network classifiers; wherein the plurality of classifiers comprises classifiers that accept inputs having different pixel-based-sizes.
8. An image segmentation system comprising one or more processors, one or more non-transitory digital storage media coupled to the processors and storing one or more sequences of program instructions which, when executed using the one or more processors, cause the one or more processors to perform: using one or more computing devices, receiving a digital image comprising test image; using the one or more computing devices, creating, based on the test image, a plurality of grid patches; using the one or more computing devices, receiving a plurality of classifiers that have been trained to identify one or more materials of a plurality of materials; using the one or more computing devices, for each patch of the plurality of grid patches, labelling each pixel of a patch with a label obtained by applying, to the patch, one or more classifiers from the plurality of classifiers; using the one or more computing devices, generating, based on labels assigned to pixels of the plurality of grid patches, a grid of labels for the test image.
9. The image segmentation system of claim 8, storing additional instructions for: based on, at least in part, the grid of labels, generating a segmentation mask for the test image; based on, at least in part, the segmentation mask, determining a set of materials, of the plurality of materials, that is depicted in the test image; based on, at least in part, the set of materials that has been determined, determining a work status of activities taking place on a site for which the test image was received, the site comprising one or more of a construction site, an industrial site, a warehouse site, a storage site, a commercial site or a residential site.
10. The image segmentation system of claim 9, storing additional program instructions for: before each pixel of a patch, of the plurality of grid patches, is labeled with a label, determining whether a pixel-based-size of the patch matches a pixel-based-size of a classifier of the plurality of classifiers; in response to determining that the pixel-based-size of the patch does not match the pixel-based-size of the classifier in the plurality of classifiers, generating a resized patch by either downsizing or upsizing the patch; applying the classifier or a different classifier, from the plurality of classifiers, to the resized patch to determine whether labels can be assigned to pixels of the resized patch; in response to determining that one or more pixels of the resized patch do not have assigned labels, repeating resizing of the patch until all pixels if the resized patch have assigned labels.
11. The image segmentation system of claim 10, storing additional program instructions for: determining whether labels can be assigned to pixels of the resized patch comprises by applying a majority voting algorithm to labels assigned to pixels of the resized patch to determine the labels for all pixels of the resized patch.
12. The image segmentation system of claim 11, storing additional program instructions for: receiving a plurality of training images of the site; determining, based on the plurality of training images, the plurality of materials that is depicted in the plurality of training images; creating, based on the plurality of training images, a plurality of sample images, each sample image depicting at least one material of the plurality of materials; creating, based on the plurality of sample images, a plurality of multi-scale patches for the plurality of materials, each multi-scale patch for a material is created from a sample image of the material from the plurality of materials; designing, using the one or more computing devices, the plurality of classifiers configured to analyze digital images having different sizes; training the plurality of classifiers using the plurality of multi-scale patches as input and using the plurality of materials as output.
13. The image segmentation system of claim 12, wherein a training image, of the plurality of training images, is a rectangular image; wherein the plurality of training images includes indoor and outdoor images; wherein the test image, of a plurality of test images, is captured by a camera that is installed at a fixed location; wherein the plurality of test images is used to determine work progress over time, to determine quality of materials that are being installed, and to determine correctness of installations; wherein a multi-scale patch, of the plurality of multi-scale patches, is a square image; the materials comprising two or more of: concrete, steel, rebar, plastic, wood, asphalt, porcelain, brick, composite, plaster, gypsum, cement, ceramic, carpet, paint, stucco, mortar, stone, urbanite, wire ropes, wire cables, bamboo, sheath panels, plex panels, plywood, wallpaper, laminate, or veneer; wherein the materials are used to build or install one or more of: buildings, framings, mezzanine floors, purlins, insulations, coating, house wraps, doors, electrical systems, plumbing systems, surface finishing, flooring, wall coverings, heating systems, ventilation systems, air conditioning systems, utility systems, storage systems, roofs, windows, stairs, hangars, storage facilities, warehouse facilities, or garages.
14. The image segmentation system of claim 13, wherein the plurality of classifiers includes a plurality of convoluted neural network classifiers; wherein the plurality of classifiers comprises classifiers that accept inputs having different pixel-based-sizes.
15. One or more non-transitory digital storage media storing one or more sequences of program instructions which, when executed using one or more processors, cause the one or more processors to perform: using one or more computing devices, receiving a digital image comprising test image; using the one or more computing devices, creating, based on the test image, a plurality of grid patches; using the one or more computing devices, receiving a plurality of classifiers that have been trained to identify one or more materials of a plurality of materials; using the one or more computing devices, for each patch of the plurality of grid patches, labelling each pixel of a patch with a label obtained by applying, to the patch, one or more classifiers from the plurality of classifiers; using the one or more computing devices, generating, based on labels assigned to pixels of the plurality of grid patches, a grid of labels for the test image.
16. The one or more non-transitory digital storage media of claim 15, storing additional instructions for: based on, at least in part, the grid of labels, generating a segmentation mask for the test image; based on, at least in part, the segmentation mask, determining a set of materials, of the plurality of materials, that is depicted in the test image; based on, at least in part, the set of materials that has been determined, determining a work status of activities taking place on a site for which the test image was received, the site comprising one or more of a construction site, an industrial site, a warehouse site, a storage site, a commercial site or a residential site.
17. The one or more non-transitory digital storage media of claim 16, storing additional program instructions for: before each pixel of a patch, of the plurality of grid patches, is labeled with a label, determining whether a pixel-based-size of the patch matches a pixel-based-size of a classifier of the plurality of classifiers; in response to determining that the pixel-based-size of the patch does not match the pixel-based-size of the classifier in the plurality of classifiers, generating a resized patch by either downsizing or upsizing the patch; applying the classifier or a different classifier, from the plurality of classifiers, to the resized patch to determine whether labels can be assigned to pixels of the resized patch; in response to determining that one or more pixels of the resized patch do not have assigned labels, repeating resizing of the patch until all pixels if the resized patch have assigned labels.
18. The one or more non-transitory digital storage media of claim 17, storing additional program instructions for: determining whether labels can be assigned to pixels of the resized patch comprises by applying a majority voting algorithm to labels assigned to pixels of the resized patch to determine the labels for all pixels of the resized patch.
19. The one or more non-transitory digital storage media of claim 18, storing additional program instructions for: receiving a plurality of training images of the site; determining, based on the plurality of training images, the plurality of materials that is depicted in the plurality of training images; creating, based on the plurality of training images, a plurality of sample images, each sample image depicting at least one material of the plurality of materials; creating, based on the plurality of sample images, a plurality of multi-scale patches for the plurality of materials, each multi-scale patch for a material is created from a sample image of the material from the plurality of materials; designing, using the one or more computing devices, the plurality of classifiers configured to analyze digital images having different sizes; training the plurality of classifiers using the plurality of multi-scale patches as input and using the plurality of materials as output.
20. The one or more non-transitory digital storage media of claim 19, wherein a training image, of the plurality of training images, is a rectangular image; wherein the plurality of training images includes indoor and outdoor images; wherein the test image, of a plurality of test images, is captured by a camera that is installed at a fixed location; wherein the plurality of test images is used to determine work progress over time, to determine quality of materials that are being installed, and to determine correctness of installations; wherein a multi-scale patch, of the plurality of multi-scale patches, is a square image; the materials comprising two or more of: concrete, steel, rebar, plastic, wood, asphalt, porcelain, brick, composite, plaster, gypsum, cement, ceramic, carpet, paint, stucco, mortar, stone, urbanite, wire ropes, wire cables, bamboo, sheath panels, plex panels, plywood, wallpaper, laminate, or veneer; wherein the materials are used to build or install one or more of: buildings, framings, mezzanine floors, purlins, insulations, coating, house wraps, doors, electrical systems, plumbing systems, surface finishing, flooring, wall coverings, heating systems, ventilation systems, air conditioning systems, utility systems, storage systems, roofs, windows, stairs, hangars, storage facilities, warehouse facilities, or garages.
</claims>
</document>

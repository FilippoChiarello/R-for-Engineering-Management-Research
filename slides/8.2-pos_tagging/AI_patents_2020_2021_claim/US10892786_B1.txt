<document>

<filing_date>
2019-10-17
</filing_date>

<publication_date>
2021-01-12
</publication_date>

<priority_date>
2019-10-17
</priority_date>

<ipc_classes>
H04B1/04
</ipc_classes>

<assignee>
ANALOG DEVICES INTERNATIONAL UNLIMITED COMPANY
</assignee>

<inventors>
JENNINGS, DAVID
PRATT, PATRICK
</inventors>

<docdb_family_id>
74066942
</docdb_family_id>

<title>
Digital predistortion with out-of-band and peak expansion regularization
</title>

<abstract>
An apparatus that implements DPD in a manner that can address OOB instability issues, PE instability issues, or both, is disclosed. The apparatus includes an actuator circuit configured to use a model of a power amplifier (PA) to apply a predistortion to at least a portion of an input signal, and an error correction circuit configured to generate an error signal indicative of a deviation of the output of the actuator circuit from the target output, e.g., in terms of OOB or PE. The apparatus also includes an adaptation circuit configured to update the model based on the error signal. By using such an error in adapting the model used for the DPD, undesirable effects of performing DPD, such as creation or amplification of OOB frequency components, or increasing amplitude of some samples, may be reduced or eliminated.
</abstract>

<claims>
1. An apparatus for applying digital predistortion to an input signal, the apparatus comprising: an actuator circuit, configured to use a model of a nonlinear electronic component to apply a predistortion to at least a portion of an input signal to generate an output of the actuator circuit, the input signal comprising a range of in-band frequency components; an adaptation circuit, configured to update the model based on a feedback signal indicative of an output of the nonlinear electronic component; and an out-of-band (OOB) regularization circuit, configured to: receive the output of the actuator circuit, and generate an OOB error signal indicative of OOB frequency components in the output of the actuator circuit, wherein: the model includes a loss function that is indicative of a sum of a first term and a second term, the first term is indicative of a difference between the feedback signal and the output of the actuator circuit, the second term is indicative of the OOB error signal, and the adaptation circuit is configured to update the model further based on the OOB error signal in a way that decreases the loss function.
2. The apparatus according to claim 1, wherein the OOB regularization circuit includes an OOB filter configured to filter the output of the actuator circuit to be provided to the nonlinear electronic component to generate the OOB error signal as a filtered output of the actuator circuit in which the in-band frequency components are attenuated and the OOB frequency components are passed, amplified, or attenuated by a smaller factor than that applied to attenuate the in-band frequency components.
3. The apparatus according to claim 2, wherein the OOB filter is a high-pass filter.
4. The apparatus according to claim 2, wherein: a sequence of the actuator circuit, the nonlinear electronic component, and the adaptation circuit forms a first loop in that: a signal indicative of the output of the actuator circuit is an input for the nonlinear electronic component, the output of the nonlinear electronic component is based on the input for the nonlinear electronic component and a signal indicative of the output of the nonlinear electronic component is a first input for the adaptation circuit, and an output of the adaptation circuit is based on the first input for the adaptation circuit and a signal indicative of the output of the adaptation circuit is an input for the actuator circuit, and a sequence of the actuator circuit, the OOB filter, and the adaptation circuit forms a second loop in that: the signal indicative of the output of the actuator circuit is an input for the OOB filter, an output of the OOB filter is the OOB error signal that is based on the input for the OOB filter and a signal indicative of the output of the OOB filter is a second input for the adaptation circuit, and the output of the adaptation circuit is further based on the second input for the adaptation circuit.
5. The apparatus according to claim 1, wherein at least one of the first term and the second term is a mean squared value.
6. The apparatus according to claim 1, wherein the adaptation circuit updating the model includes the adaptation circuit computing updated coefficients of the model and providing the updated coefficients to the actuator circuit for a next iteration of the actuator circuit using the model to apply the predistortion.
7. The apparatus according to claim 1, wherein the adaptation circuit updating the model in the way that decreases the loss function includes the adaptation circuit implementing a Gauss-Newton algorithm to decrease the loss function.
8. The apparatus according to claim 1, further comprising a peak expansion (PE) regularization circuit configured to: receive the output of the actuator circuit, and generate a PE error signal indicative of samples in the output of the actuator circuit which have an amplitude greater than a threshold, wherein the adaptation circuit is configured to update the model further based on the PE error signal.
9. The apparatus according to claim 8, wherein: the PE regularization circuit includes a clipping circuit configured to generate an output by clipping the amplitude of the samples in the output of the actuator circuit which have the amplitude greater than the threshold, and the PE regularization circuit is configured to generate the PE error signal based on a difference between the output of the actuator circuit and the output of the clipping circuit.
10. The apparatus according to claim 9, wherein the loss function is further indicative of a sum of the first term, the second term, and a third term, where the third term is indicative of the PE error signal.
11. The apparatus according to claim 1, wherein the adaptation circuit is further configured to update the model in a way that decreases the OOB frequency components in the output of the actuator circuit.
12. The apparatus according to claim 1, wherein at least one of the first term and the second term is weighted in the loss function according to a weighting parameter.
13. The apparatus according to claim 1, wherein: the first term is indicative of the difference between the feedback signal and the output of the actuator circuit by being based on the mean squared value of the difference between the feedback signal and the output of the actuator circuit, and the second term is indicative of the OOB error signal by being based on the mean squared value of the OOB error signal.
14. The apparatus according to claim 13, wherein the second term is indicative of the OOB error signal by being based on the mean squared value of the OOB error signal multiplied by a weight that defines how heavily the OOB error signal is to be weighed in the loss function.
15. An apparatus for applying digital predistortion to an input signal, the apparatus comprising: an actuator circuit, configured to use a model of a nonlinear electronic component to apply digital predistortion to at least a portion of the input signal to generate an output of the actuator circuit, where the input signal includes signal components in an in-band range of frequencies, and where the output of the actuator circuit includes signal components in the in-band range of frequencies and signal components in an out-of-band (OOB) range of frequencies, the OOB range of frequencies being different from the in-band range of frequencies; an OOB filter, configured to filter the output of the actuator circuit to be provided to the nonlinear electronic component to generate a filtered output of the actuator circuit in which the signal components of the output of the actuator circuit in the in-band range of frequencies are attenuated by a first factor and the signal components of the output of the actuator circuit in the OOB range of frequencies are passed or amplified or attenuated by a second factor such that a signal attenuated by the second factor is attenuated less than the signal attenuated by the first factor; and an adaptation circuit, configured to: receive a first error signal, indicative of a difference between an output of the nonlinear electronic component and the output of the actuator circuit, receive a second error signal, indicative of the filtered output of the actuator circuit, use the first error signal and the second error signal to generate updated coefficients for the model, and provide the updated coefficients to the actuator circuit for a next iteration of the actuator circuit using the model to generate the output of the actuator circuit.
16. The apparatus according to claim 15, wherein using the first error signal and the second error signal to generate the updated coefficients includes: computing a value of a loss function that is indicative of a sum of a first term and a second term, where the first term is based on the first error signal and the second term is based on the second error signal, and generating the updated coefficients as coefficients that result in a decreased value of the loss function for the next iteration of the actuator circuit using the model to generate the output of the actuator circuit.
17. The apparatus according to claim 16, wherein the loss function is such that the second term is multiplied by a weight that defines how heavily the OOB error signal is to be weighed in the loss function.
18. An apparatus for applying digital predistortion to an input signal, the apparatus comprising: an actuator circuit, configured to use a model of a nonlinear electronic component to apply digital predistortion to at least a portion of the input signal to generate an output of the actuator circuit, where the input signal includes signal components in an in-band range of frequencies, and where the output of the actuator circuit includes signal components in the in-band range of frequencies and signal components in an out-of-band (OOB) range of frequencies, the OOB range of frequencies being different from the in-band range of frequencies; an OOB filter, configured to filter the output of the actuator circuit to be provided to the nonlinear electronic component to generate a filtered output of the actuator circuit in which the signal components of the output of the actuator circuit in the in-band range of frequencies are attenuated by a first factor and the signal components of the output of the actuator circuit in the OOB range of frequencies are passed or amplified or attenuated by a second factor such that a signal attenuated by the second factor is attenuated less than the signal attenuated by the first factor; and an adaptation circuit, configured to generate, based on a first input and a second input, update of one or more parameters of the model to be used by the actuator circuit for a next iteration of the actuator circuit using the model to generate the output of the actuator circuit, wherein a sequence of the actuator circuit, the nonlinear electronic component, and the adaptation circuit forms a first loop in that: a signal indicative of the output of the actuator circuit is an input for the nonlinear electronic component, the output of the nonlinear electronic component is based on the input for the nonlinear electronic component and a signal indicative of the output of the nonlinear electronic component is the first input for the adaptation circuit, and an output of the adaptation circuit is based on the first input for the adaptation circuit, is indicative of the update of the one or more parameters of the model, and a signal indicative of the output of the adaptation circuit is an input for the actuator circuit, and wherein a sequence of the actuator circuit, the OOB filter, and the adaptation circuit forms a second loop in that: the signal indicative of the output of the actuator circuit is an input for the OOB filter, an output of the OOB filter is the filtered output of the actuator circuit that is based on the input for the OOB filter and a signal indicative of the output of the OOB filter is the second input for the adaptation circuit, and the output of the adaptation circuit is further based on the second input for the adaptation circuit.
19. The apparatus according to claim 18, further comprising a peak expansion (PE) regularization circuit, configured to: receive the output of the actuator circuit, and generate a PE error signal indicative of samples in the output of the actuator circuit which have an amplitude greater than a threshold, wherein the adaptation circuit is configured to generate the update of the one or more parameters further based on a third input, the third input indicative of the PE error signal.
20. The apparatus according to claim 18, wherein: the apparatus further includes a clipping circuit configured to generate an output by clipping an amplitude of samples in the output of the actuator circuit if the amplitude is greater than a threshold, the adaptation circuit is configured to generate the update of the one or more parameters of the model based on a third input, the third input being indicative of a difference between the output of the actuator circuit and the output of the clipping circuit.
</claims>
</document>

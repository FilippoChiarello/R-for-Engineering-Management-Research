<document>

<filing_date>
2019-10-25
</filing_date>

<publication_date>
2020-04-07
</publication_date>

<priority_date>
2019-10-25
</priority_date>

<ipc_classes>
G06K9/00,G06K9/32,G06T7/292
</ipc_classes>

<assignee>
7-ELEVEN
</assignee>

<inventors>
KRISHNAMURTHY, SAILESH BHARATHWAAJ
MAUNG, CRYSTAL
MIRZA, SHAHMEER ALI
</inventors>

<docdb_family_id>
70056636
</docdb_family_id>

<title>
Sensor mapping to a global coordinate system using a marker grid
</title>

<abstract>
An object tracking system includes a sensor and a tracking system. The sensor is configured to capture a first frame of a global plane for at least a portion of a marker grid in a space. The tracking system is configured to receive a first coordinate in the global plane for a first corner of a marker grid, to determine a second coordinate in the global plane for the first marker on the marker grid, and to determine a third coordinate in the global plane where the second marker on the marker grid. The tracking system is further configured to determine a first pixel location for the first marker, to determine a second pixel location for the second marker, and to generate a homography based on the second coordinate for the first marker, the third coordinate for the second marker, the first pixel location, and the second pixel location.
</abstract>

<claims>
1. An object tracking system, comprising: a first sensor configured to capture a first frame of a global plane for at least a portion of a marker grid in a space, wherein: the global plane represents (x,y) coordinates for the at least a portion of the space; the marker grid comprises a first marker and a second marker; the first marker is a first object that identifies a first location on the marker grid; the second marker is a second object that identifies a second location on the marker grid; the first frame comprises a plurality of pixels; and each pixel from the plurality of pixels is associated with a pixel location comprising a pixel row and a pixel column; and a tracking system operably coupled to the first sensor, comprising: one or more memories operable to store a first homography associated with the first sensor, wherein: the first homography comprises coefficients that translate between pixel locations in the first frame and (x,y) coordinates in the global plane; and marker grid information that identifies: a first offset between a first corner of the marker grid and the first marker; and a second offset between the first corner of the marker grid and the second marker; and one or more processors operably coupled to the one or more memories, configured to: receive a first (x,y) coordinate identifying a first x-value and a first y-value in the global plane where a first corner of a marker grid is located in the space; determine a second (x,y) coordinate identifying a second x-value and a second y-value in the global plane where the first marker is located based on the first offset from the first (x,y) coordinate for the first corner of the marker grid; determine a third (x,y) coordinate identifying a third x-value and a third y-value in the global plane where the second marker is located based on the second offset from the first (x,y) coordinate for the first corner of the marker grid; receive the first frame; identify the first marker and the second marker in the first frame; identify a first bounding box for the first marker within the first frame, wherein the first bounding box comprises a first plurality of pixels that contain at least a portion of the first marker; identify a second bounding box for the second marker within the first frame, wherein the second bounding box comprises a second plurality of pixels that contain at least a portion of the second marker; identify a first pixel within the first bounding box corresponding with the first marker; identify a second pixel within the second bounding box corresponding with the second marker; determine a first pixel location for the first pixel, wherein the first pixel location comprises a first pixel row and a first pixel column of the first frame; determine a second pixel location for the second pixel, wherein the second pixel location comprises a second pixel row and a second pixel column of the first frame; and generate the first homography based on the second (x,y) coordinate for the first marker, the third (x,y) coordinate for the second marker, the first pixel location, and the second pixel location.
2. The system of claim 1, wherein the one or more processors are further configured to: determine a number of identified markers within the first frame; determine that the number of identified markers exceeds a predetermined threshold value; and identify the first bounding box for the first marker is in response to determining that the number of identified markers exceeds the predetermined threshold value.
3. The system of claim 1, wherein: the one or more memories are operable to store a marker dictionary comprising words; the first marker comprises text; and identifying the first marker comprises: identifying text within the first frame; comparing the identified text to the words in the marker dictionary; and determining the identified text matches a word in the marker dictionary.
4. The system of claim 1, wherein: the one or more memories are operable to store a marker dictionary comprising symbols; the first marker comprises a symbol; and identifying the first marker comprises: identifying a symbol within the first frame; comparing the identified symbol to the symbols in the marker dictionary; and determining the identified symbol matches a symbol in the marker dictionary.
5. The system of claim 1, wherein the one or more processors are further configured to: receive a fourth (x,y) coordinate identifying a fourth x-value and a fourth y-value in the global plane where a second corner of the marker grid is located in the space; determine a rotation angle within the global plane based on the first (x,y) coordinate for the first corner of the marker grid and the fourth (x,y) coordinate for the second corner of the marker grid; and wherein determining the second (x,y) coordinate for the first marker comprises: applying a translation using the first offset from the first (x,y) coordinate for the first corner of the marker grid; and applying a rotation using the rotation angle about the first (x,y) coordinate for the first corner of the marker grid.
6. The system of claim 1, further comprising a second sensor operably coupled to the tracking system, configured to capture a second frame of the at least a portion of the marker grid in the space; and wherein the one or more processors are further configured to: determine a third pixel location in the second frame for the first marker; determine a fourth pixel location in the second frame for the second marker; and generate a second homography based on the third pixel location, the fourth pixel location, the second (x,y) coordinate for the first marker, and the third (x,y) marker for the second marker, wherein: the second homography comprises coefficients that translate between the pixel locations in the second frame and (x,y) coordinates in the global plane; and coefficients of the second homography are different from coefficients of the first homography.
7. The system of claim 1, further comprising a second sensor operably coupled to the tracking system, configured to capture a second frame of at least a second portion of the space; and wherein: the first sensor and the second sensor are members of a plurality of sensors configured as a sensor array; and the sensor array is positioned parallel with the global plane.
8. The system of claim 1, wherein: each pixel in the first frame is associated with a pixel value; and the first homography is further configured to translate between pixel values in the first frame and z-coordinates in the global plane.
9. The system of claim 1, wherein: receiving the first (x,y) coordinate comprises receiving a signal identifying the first (x,y) coordinate from a beacon located at the first corner of the marker grid.
10. The system of claim 1, wherein: identifying the first pixel within the first bounding box comprises identifying a first pixel marker within the first bounding box; and identifying the second pixel within the second bounding box comprises identifying a second pixel marker within the second bounding box.
11. The system of claim 10, wherein: the first pixel marker is a first light source; and the second pixel marker is a second light source.
12. The system of claim 10, wherein; the first pixel marker is a first feature of the first marker; and the second pixel marker is a second feature of the second marker.
13. A sensor mapping method, comprising: receiving a first (x,y) coordinate identifying a first x-value and a first y-value in a global plane where a first corner of a marker grid is located in a space, wherein: the global plane represents (x,y) coordinates for the at least a portion of the space; the marker grid comprises a first marker and a second marker; the first marker is a first object that identifies a first location on the marker grid; and the second marker is a second object that identifies a second location on the marker grid; determining a second (x,y) coordinate identifying a second x-value and a second y-value in the global plane where the first marker is located based on a first offset from the first (x,y) coordinate for the first corner of the marker grid; determining a third (x,y) coordinate identifying a third x-value and a third y-value in the global plane where the second marker is located based on a second offset from the first (x,y) coordinate for the first corner of the marker grid; receiving a first frame of the global plane for at least a portion of the marker grid in the space, wherein: the first frame comprises a plurality of pixels; and each pixel from the plurality of pixels is associated with a pixel location comprising a pixel row and a pixel column; identifying the first marker and the second marker in the first frame; identifying a first bounding box for the first marker within the first frame, wherein the first bounding box comprises a first plurality of pixels that contain at least a portion of the first marker; identifying a second bounding box for the second marker within the first frame, wherein the second bounding box comprises a second plurality of pixels that contain at least a portion of the second marker; identifying a first pixel within the first bounding box corresponding with the first marker; identifying a second pixel within the second bounding box corresponding with the second marker; determining a first pixel location for the first pixel, wherein the first pixel location comprises a first pixel row and a first pixel column of the first frame; determining a second pixel location for the second pixel, wherein the second pixel location comprises a second pixel row and a second pixel column of the first frame; and generating a first homography based on the second (x,y) coordinate for the first marker, the third (x,y) coordinate for the second marker, the first pixel location, and the second pixel location, wherein the first homography comprises coefficients that translate between pixel locations in the first frame and (x,y) coordinates in the global plane.
14. The method of claim 13, further comprising: determining a number of identified markers within the first frame; determining that the number of identified markers exceeds a predetermined threshold value; and identifying the first bounding box for the first marker is in response to determining that the number of identified markers exceeds the predetermined threshold value.
15. The method of claim 13, wherein identifying the first marker comprises: identifying text within the first frame; comparing the identified text to the words in a marker dictionary; and determining the identified text matches a word in the marker dictionary.
16. The method of claim 13, wherein identifying the first marker comprises: identifying a symbol within the first frame; comparing the identified symbol to the symbols in a marker dictionary; and determining the identified symbol matches a symbol in the marker dictionary.
17. The method of claim 13, further comprising: receiving a fourth (x,y) coordinate identifying a fourth x-value and a fourth y-value in the global plane where a second corner of the marker grid is located in the space; determining a rotation angle within the global plane based on the first (x,y) coordinate for the first corner of the marker grid and the fourth (x,y) coordinate for the second corner of the marker grid; and wherein determining the second (x,y) coordinate for the first marker comprises: applying a translation using the first offset from the first (x,y) coordinate for the first corner of the marker grid; and applying a rotation using the rotation angle about the first (x,y) coordinate for the first corner of the marker grid.
18. The method of claim 13, further comprising: receiving a second frame of the at least a portion of the marker grid in the space from a second sensor; determining a third pixel location in the second frame for the first marker; determining a fourth pixel location in the second frame for the second marker; and generating a second homography based on the third pixel location, the fourth pixel location, the second (x,y) coordinate for the first marker, and the third (x,y) marker for the second marker, wherein: the second homography comprises coefficients that translate between the pixel locations in the second frame and (x,y) coordinates in the global plane; and coefficients of the second homography are different from coefficients of the first homography.
19. The method of claim 13, wherein: each pixel in the first frame is associated with a pixel value; and the first homography is further configured to translate between pixel values in the first frame and z-coordinates in the global plane.
20. A computer program comprising executable instructions stored in a non-transitory computer readable medium that when executed by a processor causes the processor to: receive a first (x,y) coordinate identifying a first x-value and a first y-value in a global plane where a first corner of a marker grid is located in a space, wherein: the global plane represents (x,y) coordinates for the at least a portion of the space; the marker grid comprises a first marker and a second marker; the first marker is a first object that identifies a first location on the marker grid; and the second marker is a second object that identifies a second location on the marker grid; determine a second (x,y) coordinate identifying a second x-value and a second y-value in the global plane where the first marker is located based on a first offset from the first (x,y) coordinate for the first corner of the marker grid; determine a third (x,y) coordinate identifying a third x-value and a third y-value in the global plane where the second marker is located based on a second offset from the first (x,y) coordinate for the first corner of the marker grid; receive a first frame of the global plane for at least a portion of the marker grid in the space, wherein: the first frame comprises a plurality of pixels; and each pixel from the plurality of pixels is associated with a pixel location comprising a pixel row and a pixel column; identify the first marker and the second marker in the first frame; identify a first bounding box for the first marker within the first frame, wherein the first bounding box comprises a first plurality of pixels that contain at least a portion of the first marker; identify a second bounding box for the second marker within the first frame, wherein the second bounding box comprises a second plurality of pixels that contain at least a portion of the second marker; identify a first pixel within the first bounding box corresponding with the first marker; identify a second pixel within the second bounding box corresponding with the second marker; determine a first pixel location for the first pixel, wherein the first pixel location comprises a first pixel row and a first pixel column of the first frame; determine a second pixel location for the second pixel, wherein the second pixel location comprises a second pixel row and a second pixel column of the first frame; and generate a first homography based on the second (x,y) coordinate for the first marker, the third (x,y) coordinate for the second marker, the first pixel location, and the second pixel location, wherein the first homography comprises coefficients that translate between pixel locations in the first frame and (x,y) coordinates in the global plane.
</claims>
</document>

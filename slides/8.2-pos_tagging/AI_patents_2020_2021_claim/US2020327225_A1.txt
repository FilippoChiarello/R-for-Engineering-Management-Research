<document>

<filing_date>
2019-07-10
</filing_date>

<publication_date>
2020-10-15
</publication_date>

<priority_date>
2019-04-15
</priority_date>

<ipc_classes>
G06F21/55,G06N3/04,G06N3/08
</ipc_classes>

<assignee>
CROWDSTRIKE
</assignee>

<inventors>
NGUYEN, CORY-KHOI QUANG
Bradley, Jaron Michael
Pauley, William Leon Charles
</inventors>

<docdb_family_id>
70277263
</docdb_family_id>

<title>
Detecting Security-Violation-Associated Event Data
</title>

<abstract>
An event can be analyzed for association with a security violation. Characters or other values of event data (e.g., command-line text) associated with the event can be provided sequentially to a trained representation mapping to determine respective representation vectors. Respective indicators can be determined by applying the vectors to a trained classifer. A token in the event data can be located based on the indicators. The event's can be determined to be associated with a security violation based on the token satisfying a token-security criterion. The representation mapping can be trained by adjusting model parameters so the trained representation predicts, based on a character of training command-line text, an immediately following character in the training command-line text. The classifier can be determined based on the trained representation mapping and classification training data indicating whether respective portions of training event data are associated with security violations.
</abstract>

<claims>
1. A method of determining that an event is associated with a security violation, wherein: the event is associated with a monitored computing device; the event is associated with event data comprising command-line text; the command-line text comprises a plurality of characters; and the method comprises: sequentially providing characters of the plurality of characters to a trained representation mapping to determine respective representation vectors; determining, for each of the characters, a respective indicator at least partly by applying the respective representation vector to a trained classifier; locating at least one token in the command-line text based at least in part on the respective indicators of the characters in the command-line text; and determining that the event is associated with a security violation based at least in part on the at least one token satisfying a stored token-security criterion.
2. The method according to claim 1, wherein: the plurality of characters comprises at least one special character and at least one non-special character; the locating the at least one token comprises identifying a first sequence of adjacent characters of the plurality of characters beginning from a starting character of the plurality of characters until reaching a special character preceded by a first character, wherein: the respective indicator of the special character indicates that the special character is not associated with a security violation; and the respective indicator of the first character indicates that the first character is not associated with a security violation.
3. The method according to claim 1, further comprising: receiving the event data from the monitored computing device via a network; and in response to the determining that the event is associated with a security violation, transmitting a security command to the monitored computing device to cause the monitored computing device to perform a mitigation action.
4. The method according to claim 1, wherein the command-line text comprises: at least some text of a command line of a first process, the first process being a process that triggered the event; at least some text of a command line of a second process that is a parent process of the first process; and at least some text of a command line of a third process that is a parent process of the second process.
5. The method according to claim 1, further comprising: determining the trained representation mapping at least partly by adjusting parameters of a first model structure so that the trained representation mapping predicts, based on a character of training command-line text, an immediately following character in the training command-line text, within a predetermined accuracy; and determining the classifier at least partly by adjusting parameters of a second model structure using a supervised learning technique based on classification training data comprising training indicators associated with respective portions of the training command-line text.
6. The method according to claim 1, wherein: the trained representation mapping comprises at least two recurrent neural network (RNN) layers; and the trained classifier comprises at least one logistic-classification unit.
7. A system comprising: at least one computer-readable memory storing a trained representation mapping, a trained classifier, and an indicator-security criterion; a communications interface configured to receive an event record, wherein the event record: is associated with an event of a plurality of events; is associated with a monitored computing device of a plurality of monitored computing devices; and comprises an ordered sequence of event-data values; and a control unit configured to perform operations comprising: sequentially providing event-data values of the ordered sequence of event-data values to the trained representation mapping to determine respective representation vectors, wherein a first representation vector of the representation vectors is associated with a first event-data value of the ordered sequence of event-data values; determining a first indicator at least partly by applying the first representation vector to the trained classifier; and determining that the first event-data value is associated with a security violation based at least in part on the first indicator satisfying the indicator-security criterion.
8. The system according to claim 7, wherein: the at least one computer-readable memory stores a tokenization criterion; and the operations further comprise: determining a second indicator at least partly by applying a second representation vector of the representation vectors to the trained classifier, wherein the second indicator is associated with a second event-data value that immediately follows the first event-data value in the ordered sequence of event-data values; and determining a token in the ordered sequence of event-data values based at least in part on the first indicator and the second indicator satisfying the tokenization criterion.
9. The system according to claim 8, wherein: the at least one computer-readable memory stores a token-security criterion; and the operations further comprise determining that the event is associated with a security violation based at least in part on the token satisfying the token-security criterion.
10. The system according to claim 7, the operations further comprising, after providing a predetermined number of the event-data values to the trained representation mapping, resetting a state value of the trained representation mapping.
11. The system according to claim 7, wherein the at least one computer-readable memory stores: the trained representation mapping comprising two recurrent neural network (RNN) layers; and the trained classifier comprising a logistic-classification unit.
12. The system according to claim 7, further comprising: at least partly in response to the determining that the first event-data value is associated with a security violation, transmitting a security command to the monitored computing device to cause the monitored computing device to perform a mitigation action.
13. The system according to claim 7, wherein the ordered sequence of event-data values comprises: at least one character of a command line of a first process, the first process being a process that triggered the event; at least one character of a command line of a second process that is a parent process of the first process; and at least one character of a command line of a third process that is a parent process of the second process.
14. At least one tangible, non-transitory computer-readable medium having stored thereon instructions executable by at least one processor to cause the at least one processor to perform operations comprising: determining a trained representation mapping at least partly by adjusting parameters of a first model structure so that the trained representation mapping predicts, based on a character of training command-line text, the immediately following character in the training command-line text, within a predetermined accuracy; and determining a classifier based at least in part on the trained representation mapping and at least partly by adjusting parameters of a second model structure using a supervised learning technique based on classification training data comprising training indicators indicating whether respective portions of the training command-line text are associated with security violations.
15. The at least one tangible, non-transitory computer-readable medium according to claim 14, wherein: the first model structure comprises: an encoder that receives a character of training command-line text; a first recurrent neural network (RNN) layer fed by the encoder; a second RNN layer fed by the first RNN layer; and a decoder that outputs a predicted character; and the trained representation mapping comprises the encoder, the first RNN layer, and the second RNN layer.
16. The at least one tangible, non-transitory computer-readable medium according to claim 14, wherein: the trained representation mapping is configured to receive a sequence of characters and output respective representation vectors; and the operations for determining the classifier comprise, for at least one portion of a plurality of the portions of the training command-line text: sequentially providing characters of that portion to the trained representation mapping; selecting one representation vector of the respective representation vectors provided in response to the sequentially providing the characters by the trained representation mapping; and adjusting the parameters of the second model structure based on the selected one representation vector and on the training indicator associated with that portion.
17. The at least one tangible, non-transitory computer-readable medium according to claim 14, the operations for determining the trained representation mapping comprising: sequentially providing characters of the training command-line text to the first model structure to cause the first model structure to output respective predicted characters; determining an error between one of the characters of the training command-line text and the corresponding predicted character; and updating the parameters of the first model structure based at least in part on the error.
18. The at least one tangible, non-transitory computer-readable medium according to claim 17, wherein: the trained representation mapping is configured to receive a sequence of characters and output respective representation vectors; and the operations for determining the classifier comprise, for at least one portion of a plurality of the portions of the training command-line text: sequentially providing characters of that portion to the trained representation mapping; selecting one representation vector of the respective representation vectors provided in response to the sequentially providing the characters by the trained representation mapping; and adjusting the parameters of the second model structure based on the selected one representation vector and on the training indicator associated with that portion.
19. The at least one tangible, non-transitory computer-readable medium according to claim 14, the operations further comprising: receiving event data associated with an event at a monitored computing device, the event data comprising trial command-line text and the trial command-line text comprising a plurality of trial characters; and sequentially providing trial characters of the plurality of trial characters to the trained representation mapping to determine respective trial representation vectors; determining, for each of the trial characters, a respective trial indicator at least partly by applying the respective trial representation vector to the trained classifier; locating at least one token in the trial command-line text based at least in part on the respective trial indicators of the trial characters in the trial command-line text; and determining that the event is associated with a security violation based at least in part on the at least one trial token satisfying a stored token-security criterion.
20. The at least one tangible, non-transitory computer-readable medium according to claim 19, wherein: the plurality of trial characters comprises at least one special trial character and at least one non-special trial character; the operations for locating the at least one trial token comprise identifying a first sequence of adjacent trial characters of the plurality of trial characters beginning from a starting trial character of the plurality of trial characters until reaching a special trial character preceded by a first trial character, wherein: the respective trial indicator of the special trial character indicates that the special trial character is not associated with a security violation; and the respective trial indicator of the first trial character indicates that the first trial character is not associated with a security violation.
</claims>
</document>

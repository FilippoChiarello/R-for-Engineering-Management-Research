<document>

<filing_date>
2016-12-22
</filing_date>

<publication_date>
2020-11-03
</publication_date>

<priority_date>
2015-12-23
</priority_date>

<ipc_classes>
G06N3/04,G06N3/08,G06N5/02
</ipc_classes>

<assignee>
THE TORONTO DOMINION BANK
</assignee>

<inventors>
VOLKOVS, MAKSIMS
POUTANEN, TOMI JOHAN
</inventors>

<docdb_family_id>
59088583
</docdb_family_id>

<title>
End-to-end deep collaborative filtering
</title>

<abstract>
A recommendation system generates recommendations for an online system using one or more neural network models that predict preferences of users for items in the online system. The neural network models generate a latent representation of a user and of a user that can be combined to determine the expected preference of the user to the item. By using neural network models, the recommendation system can generate predictions in real-time for new users and items without the need to re-calibrate the models. Moreover, the recommendation system can easily incorporate other forms of information other than preference information to generate improved preference predictions by including the additional information to generate the latent description of the user or item.
</abstract>

<claims>
1. A method for predicting a preference of a user in a plurality of users for an item in a plurality of items, the method comprising: generating a latent user vector with a first neural network model, the first neural network model trained to receive a plurality of types of user descriptors and output the latent user vector, the plurality of types of user descriptors including a user preference vector indicating preferences of the user for other items in the plurality of items, and a user content vector that indicates a set of identified characteristics for the user, the latent user vector generated by: identifying a set of user descriptors for the user corresponding to at least the user preference vector and the user content vector for the user, and applying at least the user preference vector and the user content vector for the user to the first neural network model to generate the latent user vector for the user; generating a latent item vector with a second neural network model, the second neural network model trained to receive a plurality of types of item descriptors and output the latent item vector, the plurality of types of item descriptors including an item preference vector indicating preferences of the item from other users in the plurality of users, and an item content vector that indicates a set of identified characteristics for the item, the latent item vector generated by: identifying a set of item descriptors for the item corresponding to at least the item preference vector and the item content vector, and applying at least the item preference vector and the item content vector to the second neural network model to generate the latent item vector for the item; and performing a dot product between the latent user vector and the latent item vector to determine the predicted preference of the user for the item.
2. The method of claim 1, wherein applying the set of user descriptors to the first neural network model further comprises: identifying other user descriptors in the plurality of user descriptors not included in the set of user descriptors; and setting each of the other user descriptors to a zero vector.
3. The method of claim 1, wherein applying the set of item descriptors to the second neural network model further comprises: identifying other item descriptors in the plurality of item descriptors not included in the set of item descriptors; and setting each of the other item descriptors to a zero vector.
4. The method of claim 1, wherein the plurality of types of user descriptors further include a rated item vector that describes characteristics of items in the plurality of items for which there is preference information for the user.
5. The method of claim 1, wherein the plurality of types of item descriptors further include a rating user vector that describes characteristics of users in the plurality of users that are associated with preference information for the item.
6. The method of claim 1, wherein the first neural network and the second neural network are identical.
7. The method of claim 1, wherein the user preference vector is a weighted sum of preferences for items that the user has preference information for.
8. The method of claim 1, wherein the latent user vector and the latent item vector are combined through a mathematical function that is not machine-learned.
9. The method of claim 1, further comprising: modifying the set of user descriptors for the user; applying the modified set of user descriptors to the first neural network model to generate another latent user vector for the user; and combining the other latent user vector with the latent item vector to update the predicted preference of the user for the item based on the modified set of user descriptors.
10. The method of claim 9, wherein the set of user descriptors for the user includes a user preference vector, and modifying the set of user descriptors comprises modifying the user preference vector based on a user interaction with another item in the plurality of items.
11. The method of claim 1, further comprising: modifying the set of item descriptors for the item; and applying the modified set of item descriptors to the second neural network model to generate another latent item vector for the item; and combining the other latent item vector with the latent user vector to update the predicted preference of the user for the item based on the modified set of item descriptors.
12. A method for predicting a preference of a user in a plurality of users for an item in a plurality of items, the method comprising: generating a latent user vector for the user by applying a set of user descriptors identified for the user to a first neural network model, the set of user descriptors including at least a user preference vector indicating preferences of the user for other items in the plurality of items, and a user content vector indicating a set of identified characteristics for the user; generating a latent item vector for the item by applying a set of item descriptors identified for the item to a second neural network model, the set of item descriptors including at least an item preference indicating preferences of the item from other users in the plurality of users, and an item content vector indicating a set of identified characteristics for the item; performing a dot product between the latent user vector and the latent item vector according to a non-trained mathematical formula to generate a predicted preference for the user and the item.
13. The method of claim 12, wherein the set of user descriptors includes a user preference vector indicating preferences of the user for other items in the plurality of items, a user content vector that indicates a set of identified characteristics for the user, and a rated item vector that describes characteristics of items in the plurality of items for which there is preference information for the user, or a combination thereof.
14. The method of claim 13, wherein the user preference vector is a weighted sum of preferences for items that the user has preference information for.
15. The method of claim 12, wherein the set of item descriptors includes an item preference vector indicating preferences of the item from other users in the plurality of users, an item content vector that indicates a set of identified characteristics for the item, and a rating user vector that describes characteristics of users in the plurality of users from which there is preference information for the item, or a combination thereof.
16. The method of claim 12, wherein the first neural network model and the second neural network model are jointly trained.
17. The method of claim 16, wherein the joint training of the first neural network model and the second neural network model minimizes error for a preference prediction when the latent item vector and the latent user vector are combined by the untrained function.
18. The method of claim 12, wherein the first neural network model and the second neural network model are identical.
19. The method of claim 12, further comprising: identifying another set of user descriptors for the user; and applying the other set of user descriptors to the first neural network model to generate another latent user vector for the user.
20. The method of claim 12, further comprising: identifying another set of item descriptors for the item; and applying the other set of item descriptors to the second neural network model to generate another latent item vector for the item.
21. A non-transitory computer-readable medium containing instructions for execution on the processor, the instructions comprising: generating a latent user vector with a first neural network model, the first neural network model trained to receive a plurality of types of user descriptors and output the latent user vector, the plurality of types of user descriptors including a user preference vector indicating preferences of the user for other items in the plurality of items, and a user content vector that indicates a set of identified characteristics for the user, the latent user vector generated by: identifying a set of user descriptors for the user corresponding to at least the user preference vector and the user content vector for the user, and applying at least the user preference vector and the user content vector for the user to the first neural network model to generate the latent user vector for the user; generating a latent item vector with a second neural network model, the second neural network model trained to receive a plurality of types of item descriptors and output the latent item vector, the plurality of types of item descriptors including an item preference vector indicating preferences of the item from other users in the plurality of users, and an item content vector that indicates a set of identified characteristics for the item, the latent item vector generated by: identifying a set of item descriptors for the item corresponding to at least the item preference vector and the item content vector, and applying at least the item preference vector and the item content vector to the second neural network model to generate the latent item vector for the item; and performing a dot product between the latent user vector and the latent item vector to determine the predicted preference of the user for the item.
22. The non-transitory computer-readable medium of claim 21, wherein applying the set of user descriptors to the first neural network model further comprises: identifying other user descriptors in the plurality of user descriptors not included in the set of user descriptors; and setting each of the other user descriptors to a zero vector.
23. The computer-readable medium of claim 21, wherein applying the set of item descriptors to the second neural network model further comprises: identifying other item descriptors in the plurality of item descriptors not included in the set of item descriptors; and setting each of the other item descriptors to a zero vector.
24. The non-transitory computer-readable medium of claim 21, wherein the plurality of types of user descriptors further include a rated item vector that describes characteristics of items in the plurality of items for which there is preference information for the user.
25. The non-transitory computer-readable medium of claim 21, wherein the plurality of types of item descriptors further include a rating user vector that describes characteristics of users in the plurality of users that are associated with preference information for the item.
26. The non-transitory computer-readable medium of claim 21, wherein the first neural network and the second neural network are identical.
27. The non-transitory computer-readable medium of claim 21, wherein the user preference vector is a weighted sum of preferences for items that the user has preference information for.
28. The non-transitory computer-readable medium of claim 21, wherein the latent user vector and the latent item vector are combined through a mathematical function that is not machine-learned.
29. The non-transitory computer-readable medium of claim 21, further comprising: identifying another set of user descriptors for the user; and applying the other set of user descriptors to the first neural network model to generate another latent user vector for the user.
30. The non-transitory computer-readable medium of claim 21, further comprising: identifying another set of item descriptors for the item; and applying the other set of item descriptors to the second neural network model to generate another latent item vector for the item.
31. A system comprising: a processor configured to execute instructions; a computer-readable medium containing instructions for execution on the processor, the instructions causing the processor to perform steps of: generating a latent user vector with a first neural network model, the first neural network model trained to receive a plurality of types of user descriptors and output the latent user vector, the plurality of types of user descriptors including a user preference vector indicating preferences of the user for other items in the plurality of items, and a user content vector that indicates a set of identified characteristics for the user, the latent user vector generated by: identifying a set of user descriptors for the user corresponding to at least the user preference vector and the user content vector for the user, and applying at least the user preference vector and the user content vector for the user to the first neural network model to generate the latent user vector for the user; generating a latent item vector with a second neural network model, the second neural network model trained to receive a plurality of types of item descriptors and output the latent item vector, the plurality of types of item descriptors including an item preference vector indicating preferences of the item from other users in the plurality of users, and an item content vector that indicates a set of identified characteristics for the item, the latent item vector generated by: identifying a set of item descriptors for the item corresponding to at least the item preference vector and the item content vector, and applying at least the item preference vector and the item content vector to the second neural network model to generate the latent item vector for the item; and performing a dot product between the latent user vector and the latent item vector to determine the predicted preference of the user for the item.
32. The system of claim 31, wherein applying the set of user descriptors to the first neural network model further comprises: identifying other user descriptors in the plurality of user descriptors not included in the set of user descriptors; and setting each of the other user descriptors to a zero vector.
33. The system of claim 31, wherein applying the set of item descriptors to the second neural network model further comprises: identifying other item descriptors in the plurality of item descriptors not included in the set of item descriptors; and setting each of the other item descriptors to a zero vector.
34. The system of claim 31, wherein the plurality of types of user descriptors further include a rated item vector that describes characteristics of items in the plurality of items for which there is preference information for the user.
35. The system of claim 31, wherein the plurality of types of item descriptors further include a rating user vector that describes characteristics of users in the plurality of users that are associated with preference information for the item.
36. The system of claim 31, wherein the first neural network and the second neural network are identical.
37. The system of claim 31, wherein the user preference vector is a weighted sum of preferences for items that the user has preference information for.
38. The system of claim 31, wherein the latent user vector and the latent item vector are combined through a mathematical function that is not machine-learned.
39. The system of claim 31, further comprising: identifying another set of user descriptors for the user; and applying the other set of user descriptors to the first neural network model to generate another latent user vector for the user.
40. The system of claim 31, further comprising: identifying another set of item descriptors for the item; and applying the other set of item descriptors to the second neural network model to generate another latent item vector for the item.
</claims>
</document>

<document>

<filing_date>
2019-11-19
</filing_date>

<publication_date>
2020-08-20
</publication_date>

<priority_date>
2019-02-15
</priority_date>

<ipc_classes>
G06F16/901,G06N20/00,G06N5/04
</ipc_classes>

<assignee>
ZESTFINANCE
</assignee>

<inventors>
BEAHAN, JR., JOHN JOSEPH
BUDZIK, JEROME LOUIS
EBERSTEIN, MARC FREDERICK
KAMKAR, SEAN JAVAD
MERRILL, JOHN WICKENS LAMB
VALENTIN, JOSE EFRAIN
WARD, GEOFFREY MICHAEL
</inventors>

<docdb_family_id>
72041989
</docdb_family_id>

<title>
SYSTEMS AND METHODS FOR DECOMPOSITION OF DIFFERENTIABLE AND NON-DIFFERENTIABLE MODELS
</title>

<abstract>
Systems and methods for understanding diverse machine learning models.
</abstract>

<claims>
1. A method comprising: with a decomposition module, accessing model access information for a model included in a modeling system, the model access information identifying at least one tree structure used by the model; with the decomposition module, identifying a reference input data set, an evaluation input data set, and a plurality of features included in at least one of the reference input data set and the evaluation input data set; with the decomposition module, determining a feature contribution value for each identified feature, wherein each feature contribution value identifies a contribution by the feature to a difference in output generated by the model for the evaluation input data set, relative to the reference input data set; generating model explanation information by using the determined feature contribution values, wherein the model explanation information is generated by using at least one of a model evaluation module, an output explanation module, and a model monitoring module, and wherein the model explanation information explains the difference in output generated by the model for the evaluation input data set, relative to the reference input data set, and wherein the model explanation information includes information relating to a model-based decision; with a user interface system, providing the generated model explanation information to an operator device, wherein, determining a feature contribution value for each identified feature comprises: identifying a path between the reference input data set and the evaluation input data set, identifying model decision boundary points along the path by using the model access information, identifying a plurality of path segments by segmenting the path at each identified boundary point, for each segment, determining a segment contribution value for each feature by determining an integral of a gradient for the model along the segment, for each boundary point, determining a boundary point contribution value for the boundary point, and assigning the boundary contribution value to at least one of the features, and for each endpoint of the path between the reference input data set and the evaluation input data set, assigning a contribution of each feature at the endpoint for each feature, combining the feature's segment contribution values and any boundary point and endpoint contribution values assigned to the feature to generate the feature contribution value for the feature with respect to at least two data points
2. The method of claim 1, wherein identifying model decision boundary points along the path by using the model access information comprises: comparing feature values along the path with corresponding decision-tree-node feature threshold values or decision rule threshold values identified by the model access information.
3. The method of claim 2, wherein identifying model decision boundary points along the path by using the model access information comprises: identifying each leaf node included in at least one tree structure identified by the model access information that corresponds to an input data set, wherein each input data set that corresponds to a leaf node is a decision boundary point.
4. The method of claim 3, wherein for each boundary point, the boundary point contribution value is a tree structure leaf node value of the corresponding leaf node.
5. The method of claim 4, wherein for each boundary point contribution value, the boundary contribution value is assigned to a feature associated with the corresponding leaf node.
6. The method of claim 1, wherein for each boundary point, determining a boundary point contribution value for the boundary point comprises: identifying a first discontinuous model output value for an input data set on the path that corresponds to a midpoint of the segment preceding the boundary point; identifying a second discontinuous model output value for an input data set on the path that corresponds to a midpoint of the segment following the boundary point; determining a difference between the second discontinuous model output value and the first discontinuous model output value; and determining the boundary point contribution value based on the difference.
7. The method of claim 6, wherein assigning the boundary contribution value to one of the features comprises: assigning the boundary contribution value to one of the features by using the model access information.
8. The method of claim 7, wherein the model is a pass-through model in which a collection of base features is passed through a gradient boosted tree forest (GBM) and a result of the gradient boosted tree forest is presented as a score.
9. The method of claim 7, wherein the model is a pass-through model in which an output of a GBM is transformed by using a Smoothed approximate empirical cumulative distribution function (ECDF).
10. The method of claim 7, wherein the model is a compound model in which outputs of a GBM, a neural network (NN), and an Extremely Random Forest (ETF) are ensembled together using one of a stacking function and a combining function.
11. The method of claim 7, wherein the model is an ensemble that includes at least a neutral network (NN), a GBM, and an ETF and an ensembling layer, wherein an output of the linear ensembling layer is processed by a differentiable function.
12. The method of claim 7, wherein the model is an ensemble that includes at least a neutral network (NN), a GBM, and a neural network ensembling layer, wherein an output of the ensembling layer is processed by a differentiable function
13. The method of claim 1, further comprising, automatically generating model documentation by using the determined feature contribution values, and providing the model documentation to at least one operator device via the user interface system, wherein the documentation includes at least one of a feature contribution table and a partial dependence plot.
14. The method of claim 1, wherein identifying a reference input data set comprises identifying the reference input data set by using user input received via the user interface system.
15. The method of claim 1, wherein identifying an evaluation input data set comprises identifying the evaluation input data set by using user input received via the user interface system.
16. The method of claim 1, wherein the model explanation information is generated by using the model evaluation module, wherein the model evaluation module selects the evaluation input data set, and wherein the model explanation information identifies model disparity between the evaluation input data set and the reference input data set.
17. The method of claim 16, wherein the evaluation input data set represents a protected class population.
18. The method of claim 1, wherein the model explanation information is generated by using the output explanation module, wherein the output explanation module selects the evaluation input data set, wherein the evaluation input data set represents an applicant, wherein the reference input data set represents a population of accepted applicants, wherein the model explanation information explains a difference in output generated by the model for the applicant, relative to the population of accepted applicants, and wherein the model explanation information is used to compute an adverse action reason code.
19. The method of claim 1, wherein the model explanation information is generated by using the model monitoring module, wherein the model monitoring module selects the evaluation input data set, wherein the model explanation information identifies feature importance for a first time period, and wherein the evaluation input data set represents a population of input data sets for the first time period.
20. A system comprising: a modeling system that includes a model; a decomposition module communicatively coupled to the modeling system; a model evaluation module communicatively coupled to the decomposition module; an output explanation module communicatively coupled to the decomposition module; a model monitoring module communicatively coupled to the decomposition module; and a user interface system communicatively coupled to at least one of the decomposition module, the evaluation module, the explanation module, and the monitoring module, wherein the decomposition module is constructed to: access model access information for the model included in the modeling system, the model access information identifying at least one tree structure used by the model, identify a reference input data set, an evaluation input data set, and a plurality of features included in at least one of the reference input data set and the evaluation input data set, determine a feature contribution value for each identified feature, wherein each feature contribution value identifies a contribution by the feature to output generated by the model for the evaluation input data set, relative to the reference input data set, wherein at least one of the model evaluation module, the output explanation module, and the model monitoring module is constructed to generate model explanation information by using the determined feature contribution values, wherein the model explanation information explains the model for the evaluation input data set relative to the reference input data set, wherein the user interface system is constructed to provide the generated model explanation information to an operator device, and wherein, determining a feature contribution value for each identified feature comprises: identifying a path between the reference input data set and the evaluation input data set, identifying model decision boundary points along the path by using the model access information, identifying a plurality of path segments by segmenting the path at each identified boundary point, for each segment, determining segment contribution values for each feature by determining an integral of a gradient for the model along the segment, for each boundary point, determining a boundary point contribution value for the boundary point, and assigning the boundary contribution value to one of the features, and for each feature, combining the feature's segment contribution values and any boundary point contribution values assigned to the feature to generate the feature contribution value for the feature.
</claims>
</document>

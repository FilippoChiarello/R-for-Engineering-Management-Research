<document>

<filing_date>
2019-09-11
</filing_date>

<publication_date>
2020-10-01
</publication_date>

<priority_date>
2019-04-01
</priority_date>

<ipc_classes>
G10L15/22,H04R1/40,H04R3/00,H04R3/04,H04R5/02,H04R5/04,H04S3/00,H04S7/00
</ipc_classes>

<assignee>
QUALCOMM
</assignee>

<inventors>
BERNAL CASTILLO, RICARDO DE JESUS
FILOS, JASON
DAVIS, Graham Bradley
</inventors>

<docdb_family_id>
72605405
</docdb_family_id>

<title>
METHOD AND APPARATUS FOR AUDIO SIGNAL EQUALIZATION
</title>

<abstract>
A device to perform audio signal equalization includes one or more processors configured to receive impulse response data corresponding to multiple audio channels. Each audio channel is associated with a corresponding microphone of multiple microphones of an audio device and indicative of sound propagation from one or more speakers of the audio device to the corresponding microphone. The one or more processors are configured to generate equalization filter data that is based on the impulse response data and that is indicative of multiple equalization filters. Each of the equalization filters is associated with a corresponding audio channel of the multiple audio channels. The one or more processors are also configured to process the equalization filter data to determine a playback equalization filter to be applied to an audio playback signal prior to playout at the one or more speakers.
</abstract>

<claims>
1. A device to perform audio signal equalization, the device comprising: a memory configured to store instructions; and one or more processors configured to execute the instructions to: receive impulse response data corresponding to multiple audio channels, each audio channel associated with a corresponding microphone of multiple microphones of an audio device and indicative of sound propagation from one or more speakers of the audio device to the corresponding microphone; generate equalization filter data that is based on the impulse response data and that is indicative of multiple equalization filters, each of the equalization filters associated with a corresponding audio channel of the multiple audio channels; and process the equalization filter data to determine a playback equalization filter to be applied to an audio playback signal prior to playout at the one or more speakers.
2. The device of claim 1, wherein the one or more processors are implemented in the audio device, and wherein the audio device includes one of: a speaker bar; or a wireless speaker and voice command device with an integrated assistant application.
3. The device of claim 1, wherein the one or more processors are further configured to: receive, from each of the microphones via a respective audio channel of the multiple audio channels, an associated audio input signal, the associated audio input signal indicative of an input sound that is captured by the corresponding microphone and that corresponds to an audio output signal that is played out at the one or more speakers; and generate, based on each of the audio input signals and the audio output signal, room impulse response data for each audio channel of the multiple audio channels, wherein the impulse response data includes the room impulse response data for each audio channel of the multiple audio channels.
4. The device of claim 3, wherein the room impulse response data for each audio channel of the multiple audio channels is generated based on a supervised system identification operation.
5. The device of claim 3, further comprising the multiple microphones configured to provide the audio input signals to the one or more processors.
6. The device of claim 1, wherein the one or more processors are further configured to, for each of the audio channels: perform a weighted least squares operation based on the impulse response data corresponding to the audio channel and further based on a desired response; invert a result of the weighted least squares operation to generate a first equalization filter associated with the audio channel; and perform a regularization operation based on the first equalization filter to generate the equalization filter associated with the audio channel.
7. The device of claim 6, wherein the regularization operation includes reducing one or more peaks in the first equalization filter.
8. The device of claim 1, wherein the one or more processors are configured to determine the playback equalization filter based on at least one of: selection of one of the equalization filters associated with an audio channel to use as the playback equalization filter; application of an averaging operation to the equalization filters to generate the playback equalization filter; or estimation of an impulse response and equalization filter corresponding to an acoustic channel between the device and a user based on a speech signal from voice commands received from the user at the multiple microphones.
9. The device of claim 1, further comprising: a mixer configured to apply the playback equalization filter to the audio playback signal to generate a filtered playback signal; and the one or more speakers coupled to the mixer and configured to generate output sound responsive to the filtered playback signal.
10. A method of audio signal equalization, the method comprising: receiving, at one or more processors of a device, impulse response data corresponding to multiple audio channels, each audio channel associated with a corresponding microphone of multiple microphones of the device and indicative of sound propagation from one or more speakers of the device to the corresponding microphone; generating equalization filter data that is based on the impulse response data and that is indicative of multiple equalization filters, each of the equalization filters associated with a corresponding audio channel of the multiple audio channels; and processing the equalization filter data to determine a playback equalization filter to be applied to an audio playback signal prior to playout at the one or more speakers.
11. The method of claim 10, further comprising: receiving, from each of the microphones, an associated audio input signal via a respective audio channel of the multiple audio channels, the associated audio input signal indicative of an input sound that is captured by the corresponding microphone and that corresponds to an audio output signal that is played out at the one or more speakers; and generating, based on each of the audio input signals and the audio output signal, room impulse response data for each audio channel of the multiple audio channels, wherein the impulse response data includes the room impulse response data for each audio channel of the multiple audio channels.
12. The method of claim 11, wherein the room impulse response data for each audio channel of the multiple audio channels is generated based on a supervised system identification operation.
13. The method of claim 10, wherein generating the equalization filter data includes, for each audio channel of the multiple audio channels: performing a weighted least squares operation based on the impulse response data corresponding to the audio channel and further based on a desired response; inverting a result of the weighted least squares operation to generate a first equalization filter associated with the audio channel; and performing a regularization operation based on the first equalization filter to generate the equalization filter associated with the audio channel.
14. The method of claim 13, wherein the regularization operation includes reducing one or more peaks in the first equalization filter.
15. The method of claim 10, the playback equalization filter is determined based on at least one of: selecting one of the equalization filters associated with an audio channel to use as the playback equalization filter; applying an averaging operation to the equalization filters to generate the playback equalization filter; or estimating an impulse response and equalization filter corresponding to an acoustic channel between the device and a user based on a speech signal from voice commands received from the user at the multiple microphones.
16. The method of claim 10, further comprising: applying the playback equalization filter to the audio playback signal to generate a filtered playback signal; and generating output sound responsive to the filtered playback signal at the one or more speakers.
17. A non-transitory computer-readable medium comprising instructions that, when executed by one or more processors of a device, cause the one or more processors to perform operations for audio signal equalization, the operations comprising: receiving, at the one or more processors, impulse response data corresponding to multiple audio channels, each audio channel associated with a corresponding microphone of multiple microphones of the device and indicative of sound propagation from one or more speakers of the device to the corresponding microphone; generating equalization filter data that is based on the impulse response data and that is indicative of multiple equalization filters, each of the equalization filters associated with a corresponding audio channel of the multiple audio channels; and processing the equalization filter data to determine a playback equalization filter to be applied to an audio playback signal prior to playout at the one or more speakers.
18. The non-transitory computer-readable medium of claim 17, the operations further comprising: receiving, from each of the microphones via a respective audio channel of the multiple audio channels, an associated audio input signal, the associated audio input signal indicative of an input sound that is captured by the corresponding microphone and that corresponds to an audio output signal that is played out at the one or more speakers; and generating, based on each of the audio input signals and the audio output signal, room impulse response data for each audio channel of the multiple audio channels, wherein the impulse response data includes the room impulse response data for each audio channel of the multiple audio channels.
19. The non-transitory computer-readable medium of claim 18, wherein the room impulse response data for each audio channel of the multiple audio channels is generated based on a supervised system identification operation.
20. The non-transitory computer-readable medium of claim 17, wherein generating the equalization filter data includes, for each audio channel of the multiple audio channels: performing a weighted least squares operation based on the impulse response data corresponding to the audio channel and further based on a desired response; inverting a result of the weighted least squares operation to generate a first equalization filter associated with the audio channel; and performing a regularization operation based on the first equalization filter to generate the equalization filter associated with the audio channel.
21. The non-transitory computer-readable medium of claim 20, wherein the regularization operation includes reducing one or more peaks in the first equalization filter.
22. The non-transitory computer-readable medium of claim 17, wherein the playback equalization filter is determined based on at least one of: selecting one of the equalization filters associated with an audio channel to use as the playback equalization filter; applying an averaging operation to the equalization filters to generate the playback equalization filter; or estimating an impulse response and equalization filter corresponding to an acoustic channel between the device and a user based on a speech signal from voice commands received from the user at the multiple microphones.
23. The non-transitory computer-readable medium of claim 17, further comprising: applying the playback equalization filter to the audio playback signal to generate a filtered playback signal; and generating output sound responsive to the filtered playback signal at the one or more speakers.
24. An apparatus to perform audio signal equalization, the apparatus comprising: means for receiving impulse response data corresponding to multiple audio channels and for generating equalization filter data that is based on the impulse response data and that is indicative of multiple equalization filters, each audio channel associated with a corresponding microphone of multiple microphones of a device and indicative of sound propagation from one or more speakers of the device to the corresponding microphone, and each of the equalization filters associated with a corresponding audio channel of the multiple audio channels; and means for processing the equalization filter data to determine a playback equalization filter to be applied to an audio playback signal prior to playout at the one or more speakers.
25. The apparatus of claim 24, further comprising: means for generating, based on each of multiple audio input signals indicative of an input sound that is captured by the corresponding microphone and that corresponds to an audio output signal that is played out at the one or more speakers, room impulse response data for each audio channel of the multiple audio channels.
26. The apparatus of claim 25, wherein the room impulse response data for each audio channel of the multiple audio channels is generated based on a supervised system identification operation.
27. The apparatus of claim 24, further comprising means for applying the playback equalization filter to the audio playback signal to generate a filtered playback signal.
28. The apparatus of claim 24, wherein the means for processing the equalization filter data to determine a playback equalization filter is configured, for each of the audio channels, to: perform a weighted least squares operation based on the impulse response data corresponding to the audio channel and further based on a desired response; invert a result of the weighted least squares operation to generate a first equalization filter associated with the audio channel; and perform a regularization operation based on the first equalization filter to generate the equalization filter associated with the audio channel.
29. The apparatus of claim 28, wherein the regularization operation includes reducing one or more peaks in the first equalization filter.
30. The apparatus of claim 24, wherein the means for processing the equalization filter data to determine a playback equalization filter is configured to determine the playback equalization filter based on at least one of: selection of one of the equalization filters associated with an audio channel to use as the playback equalization filter; application of an averaging operation to the equalization filters to generate the playback equalization filter; or estimation of an impulse response and equalization filter corresponding to an acoustic channel between the device and a user based on a speech signal from voice commands received from the user at the multiple microphones.
</claims>
</document>

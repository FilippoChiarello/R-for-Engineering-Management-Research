<document>

<filing_date>
2020-03-27
</filing_date>

<publication_date>
2020-10-01
</publication_date>

<priority_date>
2019-03-28
</priority_date>

<ipc_classes>
G16B20/00
</ipc_classes>

<assignee>
PHASE GENOMICS, INC.
</assignee>

<inventors>
NELSON, BRAD
SULLIVAN, SHAWN
LIACHKO, IVAN
KRONENBERG, Zev
EACKER, Stephen
PRESS, Max
</inventors>

<docdb_family_id>
72610735
</docdb_family_id>

<title>
SYSTEMS AND METHODS FOR KARYOTYPING BY SEQUENCING
</title>

<abstract>
The disclosure relates to methods and systems for identifying chromosomal structural variants in a subject using chromosomal conformational capture data, relating the chromosomal structural variants to diseases or disorders, and methods of treating same.
</abstract>

<claims>
What is claimed is:
1. A method of treating a subject with a chromosomal structural variant comprising:
a. receiving a test set of reads from a sample from the subject;
b. aligning the test set of reads from the subject to a reference genome to produce a mapped set of reads from the subject;
c. generating a geometric data structure from the mapped set of reads; d. training a machine learning model to distinguish between geometric data structures from sets of reads from healthy subjects and sets of reads corresponding to known chromosomal structural variants;
e. applying the machine learning model to the geometric data structure from the subject after training the machine learning model;
f. computing a likelihood that the subject has a known chromosomal structural variant based on applying the machine learning model to the geometric data structure from the subject; and
g. generating a karyotype of the subject based on the likelihood the subject has the known chromosomal structural variant;
wherein the test set of reads, the sets of reads from healthy subjects and the sets of reads corresponding to known chromosomal structural variants are generated by a chromosome conformation analysis technique.
2. The method of claim 1, wherein the known chromosomal structural variant causes a disease or a disorder in a subject.
3. The method of claim 1 or 2, further comprising treating the subject for the disease or disorder caused by the known chromosomal structural if the karyotype indicates that the subject has said known chromosomal structural variant.
4. The method of any one of claims 1-3, wherein the machine learning model includes a deep learning model, a gradient descent model, a graph network model, a neural network model, a support vector machine, an export system model, a decision tree model, a logistic regression model, a clustering model, a Markov model, a Monte Carlo model, or a likelihood model.
5. The method of any one of claims 1-3, wherein the machine learning model is a
likelihood model classifier.
6. The method of claim 5, wherein training the likelihood model classifier in step (d) comprises:
i. receiving a plurality of geometric data structures generated from sets of reads from healthy subjects into the machine learning model;
ii. receiving a plurality of geometric data structures generated from sets of reads corresponding to known chromosomal structural variants into the machine learning model;
iii. representing each known chromosomal structural variant as a bounding rectangle comprising a start location and an end location in a genome of the chromosomal structural variant, and a label;
iv. modeling a frequency of links between any two genomic locations for the sets of reads from (i) and (ii) using a negative binomial distribution model; and
v. training the negative binomial distribution model to recognize a null distribution from the plurality of sets of reads from healthy subjects, wherein the negative binomial distribution model is trained to recognize a null distribution at the bounding rectangle of each known chromosomal structural variant.
7. The method of any one of claims 1-6, wherein generating the geometric data structure from the test set of reads, the sets of reads from healthy subjects, or the sets of reads corresponding to known chromosomal structural variants comprises:
i. partitioning the sets of reads by genomic location; and
ii. transforming the partitioned sets of reads into a geometric data structure.
8. The method of claim 6 or 7, wherein the geometric data structure represents a
frequency of links between any two genomic locations in each of sets of reads.
9. The method of claim 7 or 8, wherein the partitioning step partitions the set of reads into genomic locations corresponding to cytogenetic bands in a karyotype.
10. The method of claim 9, wherein the cytogenetic bands in the karyotype comprise a resolution of about 5 Mb per band.
11. The method of any one of claims 6-10, wherein at least one set of reads corresponding to a known chromosomal structural variant in (ii) is experimentally determined.
12. The method of any one of claims 6-10, wherein at least one set of reads corresponding to a known chromosomal structural variant in (ii) is simulated.
13. The method of any one of claims 6-12, wherein at least one set of reads from healthy subjects in (i) comprises a simulated set of reads, a theoretical set of reads, or a set of reads experimentally determined from a healthy tissue.
14. The method of claim 13, wherein the healthy tissue comprises a tissue from the
subject that does not have the disease or disorder.
15. The method of any one of claims 6-14, wherein the sets of reads from healthy subjects comprise reads corresponding to the genomic locations of each known chromosomal structural variant.
16. The method of any one of claims 1-15, wherein the geometric data structure is a kdimensional tree (k-d tree).
17. The method of claim 16, wherein the k-d tree is a 2 dimensional (2-d) k-d tree.
18. The method of claim 17, wherein a first axis of the k-d tree represents a first genomic region, and a second axis of the k-d represents a second genomic location, and wherein the k-d tree represents a frequency of links between any two genomic locations in the set of reads from the subject, the sets of reads from healthy subjects or the sets of reads corresponding to known chromosomal structural variants.
19. The method of any one of claims 16-18, wherein the k-d tree can encode an arbitrary resolution.
20. The method of claim 19, wherein the arbitrary resolution is chosen based on the size of a known chromosomal structural variant.
21. The method of any one of claims 1-15, wherein the geometric data structure is a
matrix.
22. The method of claim 21, wherein each cell of the matrix represents a frequency of links between any two genomic locations in each of the sets of reads from the subject, the sets of reads from healthy subjects or the sets of reads corresponding to known chromosomal structural variants.
23. The method of claim 22, wherein each cell of the matrix comprises between about 1 million and 10 million base pairs (bp) of the genome of the subject.
24. The method of claim 22, wherein each cell of the matrix comprises between about 3 million bp of the genome of the subject.
25. The method of any one of claims 6-24, wherein the label at step (iii) identifies the known chromosomal structural variant as a balanced translocation, an unbalanced translocation, an inversion, an insertion, a deletion, a repeat expansion, or a combination thereof.
26. The method of any one of claims 1-25, further comprising filtering out reads in the test set of reads that align poorly to the reference genome prior to generating the geometric data structure.
27. The method of claim 26, wherein applying the machine learning model at step (e) comprises fitting the geometric data structure from the test set of reads from the subject to the null model and to an alternate model for each known chromosomal structural variant.
28. The method of claim 27, wherein the fitting comprises fitting across the entire
genome.
29. The method of claim 26, wherein the fitting comprises fitting across a portion of the genome corresponding to the bounding rectangle of each known chromosomal or subchromosomal structural variant.
30. The method of any one of claims 6-29, wherein step (f) comprises computing a
likelihood ratio of the fit of the transformed and partitioned test set of reads to the null model versus the alternative models for each known chromosomal structural variant.
31. The method of claim 30, wherein the subject is determined to have a known
chromosomal structural variant when the likelihood ratio for that known chromosomal variant is less than 0.5, 0.45, 0.40, 0.35, 0.30, 0.25, 0.20, 0.15, 0.10, 0.09, 0.08, 0.07, 0.06, 0.05, 0.04, 0.03, 0.02, 0.01, 0.009, 0.008, 0.007, 0.006, 0.005, 0.003, 0.002, 0.001, 0.0009, 0.0008, 0.007, 0.006, 0.005, 0.0004, 0.0003, 0.0002 or 0.0001.
32. The method of claim 30, wherein the likelihood ratio is greater than 75%, 80%, 85%, 90%, 95%, 96%, 97, 98%, 99%, 99.1%, 99.2%, 99.3%, 99.4%, 99.5%, 99.6%, 99.7%, 99.8% or 99.9%.
33. The method of claim 30, wherein the likelihood ratio is expressed as a log likelihood ratio.
34. The method of any one of claims 1-33, wherein the chromatin conformation analysis technique comprises chromatin conformation capture (3C), circularized chromatin conformation capture (4C), carbon copy chromosome conformation capture (5C), chromatin immunoprecipitation (ChIP), ChIP-Loop, Hi-C, combined 3C-CMPcloning (6C), Capture-C, Split-pool barcoding (SPLiT-seq), Nuclear Ligation Assay (NLA), Single-cell Hi-C (scHi-C), Combinatorial Single-cell Hi-C, Concatamer Ligation Assay (COLA), Cleavage Under Targets and Release Using Nuclease (CUT& RUN), in vitro proximity ligation (Chicago®), in situ proximity ligation (in situ Hi-C), proximity ligation followed by sequencing on an Oxford Nanopore machine (Pore-C), proximity ligation sequenced on a Pacific Biosciences machine (SMRT-C), DNase Hi-C, Micro-C or Hybrid Capture Hi-C .
35. The method of any one of claims 1-34, wherein the subject has cancer.
36. The method of claim 35, wherein the sample is from a tumor.
37. The method of claim 36, wherein the tumor is a solid tumor or a liquid tumor.
38. A system for determining if a subject has a known chromosomal structural variant comprising:
a. a computer-readable storage medium which stores computer-executable
instructions comprising:
i. instructions for receiving a test set of reads from a sample from the subject,
wherein the test set of reads is generated by a chromosome conformation analysis technique;
ii. instructions for mapping the test set of reads from the subject onto a reference genome;
iii. instructions for generating a geometric data structure from the mapped set of reads;
iv. instructions for applying a machine learning model to the geometric data structure from test set of reads from the subject after training the machine learning model,
wherein the machine learning model is trained to distinguish between geometric data structures sets of reads from healthy subjects and sets of reads corresponding to known chromosomal structural variants; v. instructions for computing a likelihood that the geometric data structure from test set of reads contains a known chromosomal structural variant based on applying the machine learning model to the test set of reads; and
vi. instructions for generating a karyotype of the subject based on the
likelihood the subject has the known chromosomal structural variant; and b. a processor which is configured to perform steps comprising:
i. receiving a set of input files which comprise the test set of reads from the subject and the reference genome; and
ii. executing the computer-executable instructions stored in the computerreadable storage medium.
39. A method of identifying chromosomal structural variants in a subject comprising:
a. training a first machine learning model to identify at least one region of a first contact matrix comprising at least one chromosomal structural variant;
b. receiving the first contact matrix from a subject by the first machine learning model,
wherein the first contact matrix is produced by a chromosome conformation analysis technique;
c. applying the first machine learning model to the first contact matrix to identify at least one region of the first contact matrix containing at least one chromosomal structural variant;
d. expressing each chromosomal structural variant identified by the first machine learning model as a bounding box comprising a start location and an end location in a genome, and a label;
e. training a second machine learning model to relate the at least one
chromosomal structural variant to biological information;
f. receiving the bounding box and the label of the at least one chromosomal structural variant identified by the first machine learning model by the second machine learning model; and
g. applying the second machine learning model to the bounding box and the label of the at least one chromosomal structural variant identified by the first machine learning classifier, after training the second machine learning model; thereby identifying each chromosomal structural variant of the subject and the biological information related to each chromosomal structural variant of the subject.
40. The method of claim 39, wherein each cell of the first contact matrix comprises
between about 100 bp and 10,000,000 bp of the genome of the subject.
41. The method of claim 39 or 40, wherein the first contact matrix comprises the entire genome of the subject.
42. The method of any one of claims 39-41, further comprising, after step (d) and before step (e):
i. generating a second contact matrix,
wherein the second contact matrix comprises the start and end genomic locations of the bounding box, and
wherein a resolution of the second contact matrix is finer than a resolution of the first contact matrix;
ii. applying the first machine learning model to the second contact matrix to identify at least one region of the second contact matrix containing the at least one chromosomal structural variant; and
iii. expressing the at least one chromosomal structural variant as a second bounding box comprising a second start and a second end genomic location of the at least one chromosomal structural variant, and the label, wherein the second bounding box comprises a higher resolution than the bounding box.
43. The method of claim 42, further comprising repeating steps (i), (ii) and (iii) until a resolution of at least 500,000 bp per cell, at least 100,000 bp per cell, at least 50,000 bp per cell, at least 10,000 bp per cell, at least 1,000 bp per cell, at least 500 bp per cell or at least 100 bp per cell of the contact matrix is reached.
44. The method of any one of claims 39-43, wherein the first contact matrix comprises a data structure that can be accessed at an arbitrary resolution.
45. The method of claim 44, wherein the data structure comprises a k-dimensional tree (kd tree).
46. The method of claim 45, wherein the k-d tree is a 2 dimensional (2-d) k-d tree.
47. The method of claim 46, wherein a first axis of the 2-d k-d tree represents a first genomic region, and a second axis of the k-d represents a second genomic location, and wherein the k-d tree represents a frequency of links between any two genomic locations.
48. The method of any one of claims 45-47, wherein the 2-d k-d tree can encode an
arbitrary resolution.
49. The method of claim 48, wherein the arbitrary resolution is chosen based on the size of a known chromosomal structural variant.
50. The method of any one of claims 39-49, wherein the first contact matrix is an
averaged contact matrix, a median contact matrix or a contact matrix with a percentile cut-off.
51. The method of claim 50, wherein the averaged contact matrix has a resolution of between 100 bp per cell and 10,000,000 bp per cell.
52. The method of any one of claims 39-51, wherein the label identifies the chromosomal structural variant as a balanced translocation, an unbalanced translocation, an inversion, an insertion, a deletion, a repeat expansion or a combination thereof.
53. The method of any one of claims 39-52, wherein the first machine learning model comprises a convolutional neural network (CNN).
54. The method of claim 53, wherein training the first machine learning model comprises training the CNN on contact matrices generated from simulated and/or biological samples.
55. The method of claim 54, wherein training the CNN comprises:
i. receiving a first training dataset by the CNN,
wherein the training dataset comprises contact matrices generated from simulated and/or biological samples;
ii. using transfer learning to apply a pre-trained model to the CNN; and iii. re-training the CNN with a second training dataset,
wherein the second training dataset comprises or consists of contact matrices from biological samples.
56. The method of claim 55, wherein the first training dataset comprises or consists of contact matrices from subjects that do not have chromosomal structural variants.
57. The method of claim 55, wherein the first training dataset comprises at least one contract matrix form a subject with a chromosomal structural variant.
58. The method of claim 55, wherein the first training dataset comprises contact matrices comprising a plurality of chromosomal structural variants.
59. The method of any one of claims 56-58, wherein the first training dataset comprises full genome contract matrices and contact matrices consisting of portions of genomes.
60. The method of any one of claims 39-59, wherein the first contact matrix from the subject is generated by:
a. performing a chromosome conformation analysis technique on a sample from the subject to generate a set of reads;
b. aligning the set of reads from the subject to a reference genome; and
c. transforming the aligned set of reads into a contact matrix.
61. The method of claim 60, wherein the chromatin conformation analysis technique comprises chromatin conformation capture (3C), circularized chromatin conformation capture (4C), carbon copy chromosome conformation capture (5C), chromatin immunoprecipitation (ChIP), ChIP-Loop, Hi-C, combined 3C-ChIP-cloning (6C), Capture-C, Split-pool barcoding (SPLiT-seq), Nuclear Ligation Assay (NLA), Single cell Hi-C (scHi-C), Combinatorial Single-cell Hi-C, Concatamer Ligation Assay (COLA), Cleavage Under Targets and Release Using Nuclease (CUT& RUN), in vitro proximity ligation (Chicago®), in situ proximity ligation (in situ Hi-C), proximity ligation followed by sequencing on an Oxford Nanopore machine (Pore-C), proximity ligation sequenced on a Pacific Biosciences machine (SMRT-C), DNase Hi-C, Micro-C or Hybrid Capture Hi-C.
62. The method of claim 60 or 61, further comprising filtering out reads from the set of reads from the subject that align poorly to the reference genome prior to transforming the aligned set of reads from the subject into the contact matrix.
63. The method of any one of claims 39-62, wherein the second machine learning model comprises a recurrent neural network, a sense detector or a Unearest neighbors model.
64. The method of claim 63, wherein the sense detector is trained using clinical label data from known chromosomal structural variations, diagnosis data, clinical outcome data, drug or treatment response data or metabolic data.
65. The method of any one of claims 39-64, wherein the second machine learning model identifies the chromosomal structural variant as a balanced translocation, an unbalanced translocation, an inversion, an insertion, a deletion, a repeat expansion or a combination thereof
66. The method of any one of claims 39-65, wherein the biological information comprises one or more genes, a diagnosis, a patient outcome, a metabolic effect, a drug target, a drug response, a course of treatment or a combination thereof.
67. The method of claim 66, wherein the subject has a disease or a disorder caused by the at least one chromosomal structural variant.
68. The method of claim 67, wherein the method comprises treating the subject for the disease or disorder caused by the at least one chromosomal structural variant.
69. The method of any one of claims 39-68, wherein the subject has cancer.
70. The method of claim 69, wherein the first contact matrix from the subject is from a cancer sample.
71. The method of claim 70, wherein the cancer is a solid tumor or a liquid tumor.
72. A system for identifying chromosomal structural variants in a subject comprising:
a. a computer-readable storage medium which stores computer-executable instructions comprising:
i. instructions for receiving a first contact matrix from a subject by a first machine learning model,
wherein the first contact matrix is produced by a chromosome conformation analysis technique;
ii. instructions for applying the first machine learning model to the contact matrix to identify at least one region of the first contact matrix comprising at least one chromosomal structural variant;
iii. instructions for expressing each chromosomal structural variant
identified by the first machine learning model as a bounding box comprising a start and an end in a genome, and a label;
iv. instructions for receiving the bounding box and the label of the at least one chromosomal structural variant identified by the first machine learning model into a second machine learning model; and v. instructions for applying the second machine learning model, wherein the second machine learning model is trained to relate a chromosomal structural variant to biological information, and wherein applying the second machine learning model occurs after training the second machine learning model; and
b. a processor which is configured to perform steps comprising:
i. receiving a set of input files which comprise at least the first contact matrix from the subject; and
ii. executing the computer-executable instructions stored in the computerreadable storage medium.
73. A method of identifying chromosomal structural variants in a subject comprising:
a. receiving a contact matrix,
wherein the contact matrix is produced by a chromosome conformation analysis technique applied to a sample from the subject;
b. representing the contact matrix as an image,
wherein an intensity of each pixel in the image represents a density of links between two genomic locations in the contact matrix; and
c. applying image processing to the image;
thereby detecting chromosomal structural variants in the subject.
74. The method of claim 73, wherein each pixel represents 5-500 kilobase pairs (kbp) of a genome of the subject.
75. The method of claim 73, wherein each pixel represents 40 kbp of a genome of the subject.
76. The method of any one of claims 73-75, wherein the image processing in step (c) comprises:
i. applying a global normalization to the image;
ii. applying a first threshold to the image;
iii. identifying sub regions of the image corresponding to chromosome comparisons;
iv. applying a second threshold to each sub region;
v. de-noising each sub region;
vi. applying an edge and/or comer detecting algorithm to the image; vii. applying at least one filter to remove false positives; and
viii. determining the genomic locations of all chromosomal structural variants in the image.
77. The method of claim 76, wherein applying an edge and/or comer detecting algorithm at (vi) comprises applying the edge and/or comer detecting algorithm to each sub region.
78. The method of claim 76, wherein the global normalization of (i) comprises fitting a matrix of weights to the image.
79. The method of claim 76, wherein each cell in the matrix corresponds to a pixel in the image.
80. The method of claim 79, wherein fitting a matrix of weights comprises
i. generating a contact matrix from a healthy sample;
ii. representing the contact matrix from the healthy subject as an image from a healthy subject; and
iii. subtracting the image from the healthy subject from the image, wherein pixels within 10-300 kbp of a cis-chromosome diagonal of the image are excluded.
81. The method of claim 80, wherein the contact matrix from a healthy sample is
generated using a simulated set of reads, a theoretical set of reads or a set of reads experimentally determined from a healthy tissue.
82. The method of claim 81, wherein the healthy tissue comprises a tissue from the
subject that does not have a disease or disorder.
83. The method of claim 81, wherein the contact matrix from the healthy sample
comprises a reference matrix.
84. The method of claim 80, wherein subtracting the matrix of weights from the image minimizes a sum of each row and each column of pixels of the image.
85. The method of any one of claims 80-84, further comprising calculating a balanced interaction density for each pixel.
86. The method of any one of claims 76-85, wherein the first threshold comprises a global threshold.
87. The method of claim 86, wherein the global threshold is calculated using the balanced density interaction for each pixel.
88. The method of any one of claims 76-87, wherein the edge and/or comer detecting algorithm comprises a Harris comer method, a Roberts cross method, a Hough transform or a combination thereof.
89. The method of any one of 76-88, wherein the least one filter to remove false positives comprises a Diagonal Path Finder, non-maximum suppression filter, Neighbor threshold or a combination thereof.
90. The method of any one of claims 73-89, wherein the chromosomal structural variant is a balanced translocation, an unbalanced translocation, an inversion, an insertion, a deletion, a repeat expansion or a combination thereof.
91. The method of any one of any one of claims 73-90, wherein the subject has a disease or disorder caused by the chromosomal structural variant.
92. The method of claim 91, further comprising treating the subject for the disease or disorder caused by the chromosomal structural variant.
93. The method of any one of any one of claims 73-92, wherein the chromosome
conformation analysis technique chromatin conformation capture (3C), circularized chromatin conformation capture (4C), carbon copy chromosome conformation capture (5C), chromatin immunoprecipitation (ChIP), ChIP-Loop, Hi-C, combined 3C-ChIP-cloning (6C),Capture-C, Split-pool barcoding (SPLiT-seq), Nuclear Ligation Assay (NLA), Single-cell Hi-C (scHi-C), Combinatorial Single-cell Hi-C, Concatamer Ligation Assay (COLA), Cleavage Under Targets and Release Using Nuclease (CUT& RUN), in vitro proximity ligation (Chicago®), in situ proximity ligation (in situ Hi-C), proximity ligation followed by sequencing on an Oxford Nanopore machine (Pore-C), proximity ligation sequenced on a Pacific Biosciences machine (SMRT-C), DNase Hi-C, Micro-C or Hybrid Capture Hi-C.
94. A system for identifying chromosomal structural variants in a subject comprising:
a. a computer-readable storage medium which stores computer-executable instructions comprising:
i. instructions for receiving a contact matrix,
wherein the contact matrix is produced by a chromosome conformation analysis technique applied to a sample from the subject;
ii. instructions for representing the contact matrix as an image, wherein an intensity of each pixel in the image represents a density of links between two genomic locations in the contact matrix; and
iii. instructions for applying image processing to the image; and b. a processor which is configured to perform the steps of executing the
computer executable-instructions for receiving a first contact matrix, representing the contact matrix as an image, and applying image processing to the image, which are stored in the computer-readable storage medium;
thereby detecting chromosomal structural variants in the subject.
95. The method of any one of claims 73-94, wherein the subject has cancer.
96. The method of claim 95, wherein the sample is from a tumor.
97. The method of claim 96, wherein the tumor is a solid tumor or a liquid tumor.
98. A method comprising: a. contacting a sample from a subject with a stabilizing agent, wherein said sample comprises nucleic acids;
b. cleaving the nucleic acids into a plurality of fragments comprising at least a first segment and a second segment;
c. attaching the first segment and the second segment at a junction to generate a plurality of fragments comprising attached segments;
d. obtaining at least some sequence on each side of the junction of the plurality of fragments comprising attached segments to generate a plurality of reads; and
e. applying the method of any one of claims 1-37, 39-71 or 73-96.
</claims>
</document>

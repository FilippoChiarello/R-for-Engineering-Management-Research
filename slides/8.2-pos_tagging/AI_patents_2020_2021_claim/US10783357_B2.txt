<document>

<filing_date>
2017-10-31
</filing_date>

<publication_date>
2020-09-22
</publication_date>

<priority_date>
2016-11-02
</priority_date>

<ipc_classes>
G06K9/00,G06T7/50,G06T7/73,G06T7/90
</ipc_classes>

<assignee>
CANON
</assignee>

<inventors>
WU BO
LI, XIAN
HU QI
SUN, DONGHUI
</inventors>

<docdb_family_id>
62021700
</docdb_family_id>

<title>
Apparatus and method for recognizing expression of a face, image processing apparatus and system
</title>

<abstract>
One of the aspects of the present disclosure discloses an apparatus for recognizing expression of a face in a face region of an image, comprising: a unit configured to detect feature points of the face in the face region of the image; a unit configured to determine a face shape of the face in the face region based on the detected feature points; a unit configured to determine a group that the face in the face region belongs to based on the determined face shape and pre-defined shape groups; and a unit configured to determine an expression of the face in the face region based on pre-generated first models corresponding to the determined group and features extracted from at least one region in the face region, wherein the at least one of the regions are regions which are labeled out in the pre-generated first models corresponding to the determined group.
</abstract>

<claims>
1. An apparatus for recognizing expression of a face in a face region of an input image, comprising: one or more processors; and one or more memories coupled to the one or more processors, the memories stored thereon instructions which, when executed by the one or more processors, cause the apparatus to: detect local features of the face in the face region of the input image; determine a face shape of the face based on the detected local features; determine a face pose of the face in the face region based on the detected local features; determine a group that the face belongs to based on the determined face shape, the determined face pose, pre-defined shape groups and pre-defined pose groups among the pre-defined shape groups, wherein the pre-defined pose groups correspond to angle ranges of rotation angles of faces relative to coordinates; and determine an expression of the face in the face region based on at least one pre-generated model corresponding to the determined group and features extracted from at least one region in the face region, wherein the at least one region is a region which is prescribed in the pre-generated model corresponding to the determined group, wherein the pre-generated model is generated by the following steps: determining, as for each pre-defined shape group, face poses of faces in a plurality of sample images based on detected local features of the faces whose face shapes are clustered into the each pre-defined shape group; grouping, as for each pre-defined shape group, the face poses of the faces based on pre-defined angle intervals for the rotation angles of the faces relative to the coordinates, and regarding the grouping results as the pre-defined pose groups in the each pre-defined shape group; and generating, as for each pre-defined pose group in each pre-defined shape group, the corresponding pre-generated model based on the corresponding sample images, in which the face shapes of the faces belong to the each pre-defined shape group and the face poses of the faces belong to the each pre-defined pose group.
2. The apparatus according to claim 1, wherein one of the pre-defined shape groups is selected as the determined group based on distances among the determined face shape and centers of the pre-defined shape groups.
3. The apparatus according to claim 2, wherein the pre-generated model is generated further by the following steps: detecting local features of faces in face regions in a plurality of sample images; determining face shapes of the faces based on the detected local features; and clustering the face shapes of the faces and regarding the clustered results with the centers as the pre-defined shape groups.
4. The apparatus according to claim 1, wherein the group is determined by determining one of the pre-defined shape groups based on distances among the determined face shape and centers of the pre-defined shape groups; and selecting one of the pre-defined pose groups in the determined pre-defined shape group as the determined group by comparing the determined face pose with angle ranges of the pre-defined pose groups in the determined pre-defined shape group.
5. The apparatus according to claim 3, wherein at least one of the classifiers in the pre-generated model is generated by the following steps: weighting the corresponding sample images; obtaining at least one candidate region from each weighted sample image; as for the candidate regions with the same position among the weighted sample images, generating a candidate classifier with a classification error based on features extracted from these candidate regions; and selecting the candidate classifier with the minimum classification error as the corresponding classifier; wherein, a region whose position corresponds to the position of the candidate regions used to generate this classifier is regarded as the labeled region of this classifier.
6. The apparatus according to claim 1, wherein, as for a 3-dimensional image, the extracted local features are depth features of the face in the input image.
7. The apparatus according to claim 1, wherein, as for a 3-dimensional image, the extracted local features are depth features and color features of the face in the input image.
8. An image processing apparatus, comprising: a detection apparatus configured to detect at least one face region from an input image; an apparatus according to claim 1, configured to recognize expressions of the faces in the detected face regions.
9. An image processing system, comprising: an image acquiring apparatus configured to acquire at least one image; an image processing apparatus, comprising: a detection apparatus configured to detect at least one face region from the acquired images; an apparatus according to claim 1, configured to recognize expressions of the faces in the detected face regions.
10. An apparatus for recognizing expression of a face in a face region of an input image, comprising: one or more processors; and one or more memories coupled to the one or more processors, the memories stored thereon instructions which, when executed by the one or more processors, cause the apparatus to: detect local features of the face in the face region of the input image; determine a face shape of the face based on the detected local features; determine a face pose of the face based on the detected local features; determine a group that the face belongs to based on the determined face shape, the determined face pose, pre-defined pose groups and pre-defined shape groups among the pre-defined pose groups, wherein the pre-defined pose groups correspond to angle ranges of rotation angles of faces relative to coordinates; and determine an expression of the face in the face region based on at least one pre-generated model corresponding to the determined group and features extracted from at least one region in the face region, wherein the at least one region is a region which is prescribed in the pre-generated model corresponding to the determined group, wherein the pre-generated model is generated by the following steps: grouping face poses of faces in a plurality of sample images based on pre-defined angle intervals for rotation angles of the faces relative to coordinates, and regarding the grouping results as the pre-defined pose groups; determining, as for each pre-defined pose group, face shapes of the faces based on detected local features of the faces whose face pose are grouped into the each pre-defined pose group; and generating, as for each pre-defined shape group in each pre-defined pose group, the corresponding pre-generated model based on the corresponding sample images, in which the face poses of the faces belong to the each pre-defined pose group and the face shapes of the faces belong to the each pre-defined shape group.
11. The apparatus according to claim 10, wherein one of the pre-defined pose groups is determined by comparing the determined face pose with angle ranges of the pre-defined pose groups; and one of the pre-defined shape groups in the determined pre-defined pose group is selected as the determined group based on distances among the determined face shape and centers of the pre-defined shape groups in the determined pre-defined pose group.
12. The apparatus according to claim 11, wherein the pre-generated model is generated further by the following steps: detecting local features of faces in face regions in a plurality of sample images; determining face poses of the faces based on the detected local features; and clustering, as for each pre-defined pose group, the face shapes of the faces and regarding the clustered results with the centers as the pre-defined shape groups in the each pre-defined pose group; wherein, each pre-generated model includes at least one classifier with a labeled region, and the classifiers are generated based on features extracted from the corresponding labeled regions among the corresponding sample images.
13. The apparatus according to claim 11, wherein, as for a 3-dimensional image, the extracted local features are depth features of the face in the input image.
14. The apparatus according to claim 11, wherein, as for a 3-dimensional image, the extracted local features are depth features and color features of the face in the input image.
15. A method for recognizing expression of a face in a face region of an input image, the method comprising: detecting local features of the face in the face region of the input image; determining a face shape of the face based on the detected local features; determining a face pose of the face based on the detected local features; determining a group that the face belongs to based on the determined face shape, the determined face pose, pre-defined shape groups and pre-defined pose groups among the pre-defined shape groups, wherein the pre-defined pose groups correspond to angle ranges of rotation angles of faces relative to coordinates; and determining an expression of the face in the face region based on at least one pre-generated first model corresponding to the determined group and features extracted from at least one region in the face region, wherein the at least one region is a region which is prescribed in the pre-generated model corresponding to the determined group, wherein the pre-generated model is generated by the following steps: determining, as for each pre-defined shape group, face poses of faces in a plurality of sample images based on detected local features of the faces whose face shapes are clustered into the each pre-defined shape group; grouping, as for each pre-defined shape group, the face poses of the faces based on pre-defined angle intervals for the rotation angles of the faces relative to the coordinates, and regarding the grouping results as the pre-defined pose groups in the each pre-defined shape group; and generating, as for each pre-defined pose group in each pre-defined shape group, the corresponding pre-generated model based on the corresponding sample images, in which the face shapes of the faces belong to the each pre-defined shape group and the face poses of the faces belong to the each pre-defined pose group.
16. The method according to claim 15, wherein, as for a 3-dimensional image, the extracted local features are depth features and color features of the face in the input image.
17. A non-transitory computer readable storage medium storing a program, which causes a computer to execute the method according to claim 15.
18. A method for recognizing expression of a face in a face region of an input image, the method comprising: detecting local features of the face in the face region of the input image; determining a face shape of the face based on the detected local features; determining a face pose of the face in the face region based on the detected local features; determining a group that the face belongs to based on the determined face shape, the determined face pose, pre-defined pose groups and pre-defined shape groups among the pre-defined pose groups, wherein the pre-defined pose groups correspond to angle ranges of rotation angles of faces relative to coordinates; and determining an expression of the face in the face region based on at least one pre-generated model corresponding to the determined group and features extracted from at least one region in the face region, wherein the at least one region is a region which is prescribed in the pre-generated model corresponding to the determined group, wherein the pre-generated model is generated by the following steps: grouping face poses of faces in a plurality of sample images based on pre-defined angle intervals for rotation angles of the faces relative to coordinates, and regarding the grouping results as the pre-defined pose groups; determining, as for each pre-defined pose group, face shapes of the faces based on detected local features of the faces whose face pose are grouped into the each pre-defined pose group; and generating, as for each pre-defined shape group in each pre-defined pose group, the corresponding pre-generated model based on the corresponding sample images, in which the face poses of the faces belong to the each pre-defined pose group and the face shapes of the faces belong to the each pre-defined shape group.
19. The method according to claim 18, wherein, as for a 3-dimensional image, the extracted local features are depth features and color features of the face in the input image.
20. A non-transitory computer readable storage medium storing a program, which causes a computer to execute the method according to claim 18.
</claims>
</document>

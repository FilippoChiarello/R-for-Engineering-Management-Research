<document>

<filing_date>
2020-02-25
</filing_date>

<publication_date>
2020-09-03
</publication_date>

<priority_date>
2019-02-25
</priority_date>

<ipc_classes>
G06F16/24,G06F16/28,G06K9/22,G06K9/62,G06Q20/20,G06Q20/22,G06Q30/02,G06Q30/06
</ipc_classes>

<assignee>
WALMART APOLLO
</assignee>

<inventors>
PALIWAL, PRIYANKA
GARNER, MICHAEL A.
</inventors>

<docdb_family_id>
72141238
</docdb_family_id>

<title>
SYSTEMS AND METHODS OF PRODUCT RECOGNITION THROUGH MULTI-MODEL IMAGE PROCESSING
</title>

<abstract>
In some embodiments, systems and methods are provided to recognize retail products, comprising: a model training system configured to: identify a customer; access an associated customer profile; access and apply a set of filtering rules to a product database based on customer data; generate a listing of products specific to the customer; access and apply a model training set of rules to train a machine learning model based on the listing of products and corresponding image data for each of the products in the listing of products; and communicate the trained model to the portable user device associated with first customer.
</abstract>

<claims>
What is claimed is:
1. A system to recognize retail products in a physical retail store, comprising:
a customer database storing, for each of a plurality of customers of a retail company operating at least a first retail store, a customer profile storing one or more of purchase history information, product search history information, and product preference data;
a retail product database storing product data comprising product imaging data corresponding to each of tens of thousands of different retail products available for sale from the first retail store, wherein each of the imaging data corresponding to one of the different retail products and comprises a corresponding product identifier and at least image attribute data exclusively corresponding to the respective product; and
a model training system communicatively coupled with the product database, wherein the modeling training system comprises a training control circuit communicatively coupled with tangible memory storing a rules database maintaining rules and code that is when executed by the training control circuit cause the training control circuit, for each of the plurality of customers, to:
identify a first customer of the plurality of customers;
access, in the customer database, a first customer profile associated with the first customer;
access the rules database and obtain a first set of one or more filtering rules, and apply the first set of one or more filtering rules to filter the products identified in the product database based on each of the purchase history information, the search history information, and the product preference data corresponding to the first customer;
generate, based on a result of filtering the product database, a first listing of products specific to the first customer, wherein the first listing comprises a first subset of tens of retail products, of the tens of thousands of retail products, that the customer is predicted to attempt to identify one or more of the first subset of tens of retail products through image recognition implemented on a portable user device associated with the first customer;
access a second set of model training rules and apply the second set of model training rules to train a machine learning model to be applied by the portable user device in identifying one or more products from frames of video content captured by the portable user device, wherein the training is limited to the first listing of products and corresponding image data for each of the products in the first listing of products; and
communicate the trained machine learning model to the portable user device associated with the first customer. 2. The system of claim 1, wherein the model training system is further configured to repeatedly update and retrain, over time, the machine learning model; and
communicate the retrained machine learning model to the portable user device associated with the first customer to replace a previously stored trained machine learning model on the portable user device. 3. The system of claim 2, wherein the model training system, in repeatedly updating and retraining the machine learning model, is configured to:
reapply, over time, the first set of filtering rules to the product database based on updates to one or more of the purchase history information, the search history information, and the product preference data corresponding to the first customer;
generate, based on a result of reapplying the first set of filtering rules, an updated first listing of products specific to the first customer; and
access the second set of model training rules and reapply the second set of model training rules to retrain the machine learning model, wherein the retraining is limited to the updated first listing of products. 4. The system of claim 2, wherein the model training system, in repeatedly updating and retraining the machine learning model, is configured to initiate the retraining in response to a modification to one of the purchase history information, the search history information, and the product preference data corresponding to the first customer. 5. The system of claim 2, wherein the model training system, in repeatedly updating and retraining the machine learning model, is configured to initiate the retraining in response to receiving a notification that the portable user device associated with the first customer is within a geographic threshold of a second retail store that is at a second geographic location that is different than a first geographic location of the first retail store;
update the first listing of products to include a second subset of products, wherein the second subset of products comprises products relevant to at least one of the second retail store and the geographic location of the second retail store; and
wherein the retraining the machine learning model is limited to the updated first listing of products including the second subset of products. 6. The system of claim 1, wherein the model training system, in generating the first listing of products specific to the first customer, is configured to identify, for multiple products identified based on the result of filtering the product database, a corresponding product category comprising a set of a plurality of similar products defined as being part of the product category, and include two or more products from each of the product categories into the first listing of products specific to the first customer. 7. The system of claim 6, wherein the model training system, in repeatedly updating and retraining the machine learning model, is configured to identify that a first product, which was included in the most recent updated first listing of products, has not been purchased by the first customer within a threshold purchase period of time; and
update the first listing of products to exclude the first product from the updated first listing of products in response to identifying that the first product has not been purchased by the first customer within the threshold purchase period of time; and
wherein the retraining the machine learning model is limited to the updated first listing of products excluding the first product. 8. The system of claim 1, wherein the model training system is configured to:
receive a notification from the portable user device associated with the customer identifying a version of a stored machine learning model presently stored on the portable user device;
determine that the version of the stored machine learning model is not the most recently updated version of the machine learning model; and cause the communication of the most recently updated version of the trained machine learning model to the portable user device. 9. The system of claim 1, further comprising:
the portable user device associated with the first customer, wherein the portable user device comprises:
an imaging system configured to capture at least video content, wherein each video content comprising a series of frames;
at least one tangible memory positioned within the housing and storing the trained machine learning model, and a local product database locally storing sets of product imaging data, wherein each set of product imaging data corresponds to one of the first subset of tens of retail products available for sale and comprises a product identifier and at least image attribute data exclusively corresponding to the respective product; and
a decision control circuit communicatively coupled with the memory and configured to: process each frame of a subset of one or more frames of the video content by at least a first modeling technique implemented by the trained machine learning model relative to a first image attribute and obtain a corresponding first product identification probability that an item, captured within each of the subset of at least one frame, is estimated to be a first product of the first subset of tens of retail products; process each frame of the subset of at least one frame by a second modeling technique implemented by the trained machine learning model relative to a second image attribute that is different than the first attribute, and obtain corresponding second product identification probability that the item, captured within each of the subset of at least one frame, is estimated to be the first product of the first subset of tens of retail products; determine an aggregated first identification probability of the first product as a function of the first product identification probabilities corresponding to the frames of the subset of at least one frame;
determine an aggregated second identification probability of the first product as a function of the second product identification probabilities corresponding to the frames of the subset of at least one frame; collectively evaluate the aggregated first identification probability and the aggregated second identification probability of the first product for the frames of the subset of at least one frame and identify when one or more of the aggregated first identification probability and the aggregated second identification probability has a predefined relationship with a collective threshold probability; and cause an image of the first product to be displayed in response to identifying that one or more of the aggregated first identification probability and the aggregated second identification probability has the predefined relationship with the collective threshold probability. 10. The system of claim 8, wherein the portable user device further comprising a control circuit coupled with the memory and configured to:
add the first product to a virtual cart; and
initiate a checkout of and payment for each product within the virtual shopping cart. 11. The system of claim 10, wherein the control circuit in initiating the checkout of the virtual cart activates a generation at a central server of an order corresponding to the virtual cart and each product included in the virtual cart, obtain a dynamically generated optical machinereadable representation of the order corresponding to the virtual cart, wherein the optical machine-readable representation of the order is configured to be scanned by a scanning system associated with a point of sale system to acquire cost information of the products in the virtual cart. 12. The system of claim 10, wherein the control circuit in initiating the checkout of the virtual cart activates a generation at a central server of an order corresponding to the virtual cart and each product included in the virtual cart, authorize payment for the products represented in the virtual cart, and receive a confirmation of payment at the portable user device, wherein the confirmation of payment is configured to be displayed on a display of the portable user device to confirm payment prior to the customer leaving the first retail store. 13. The system of claim 1, wherein the model training system, in applying the first set of one or more filtering rules and filtering the products identified in the product database is further configured to apply the first set of one or more filtering rules and filter the products identified in the product database further based on one or more of a location of the first retail store, rates of sales of one or more of the products at the first retail store, and inventory levels of one or more of the products at the first retail store.
14. A method of recognizing retail products in a physical retail store, comprising:
by a model training system communicatively coupled with a product database and a customer database:
identifying a first customer of the plurality of customers;
accessing, in the customer database, a first customer profile associated with the first customer;
accessing a rules database and obtain a first set of one or more filtering rules, and applying the first set of one or more filtering rules filtering the products identified in the product database based on each of a purchase history information, search history information, and product preference data corresponding to the first customer;
generating, based on a result of filtering the product database, a first listing of products specific to the first customer, wherein the first listing comprises a first subset of tens of retail products, of the tens of thousands of retail products, that the customer is predicted to attempt to identify through image recognition implemented on a portable user device associated with the first customer;
accessing a second set of model training rules, applying the second set of model training rules, and training a machine learning model to be applied by the portable user device in identifying one or more products from frames of video content captured by the portable user device, wherein the training is limited to the first listing of products and corresponding image data for each of the products in the first listing of products; and
communicating the trained machine learning model to the portable user device associated with the first customer. 15. The method of claim 14, further comprising:
repeatedly updating and retraining, over time, the machine learning model; and communicating the retrained machine learning model to the portable user device associated with the first customer to replace a previously stored trained machine learning model on the portable user device.
16. The method of claim 15, wherein the repeatedly updating and retraining the machine learning model, comprises:
reapplying, over time, the first set of filtering rules to the product database based on updates to one or more of the purchase history information, the search history information, and the product preference data corresponding to the first customer;
generating, based on a result of reapplying the first set of filtering rules, an updated first listing of products specific to the first customer; and
accessing the second set of model training rules, reapplying the second set of model training rules, and retraining the machine learning model, wherein the retraining is limited to the updated first listing of products. 17. The method of claim 15, wherein the repeatedly updating and retraining the machine learning model comprises:
initiating the retraining in response to a modification to one of the purchase history information, the search history information, and the product preference data corresponding to the first customer. 18. The method of claim 15, wherein the repeatedly updating and retraining the machine learning model comprises:
initiating the retraining in response to receiving a notification that the portable user device associated with the first customer is within a geographic threshold of a second retail store that is at a second geographic location that is different than a first geographic location of the first retail store; and
updating the first listing of products to include a second subset of products, wherein the second subset of products comprises products relevant to at least one of the second retail store and the geographic location of the second retail store; and
wherein the retraining the machine learning model is limited to the updated first listing of products including the second subset of products. 19. The method of claim 14, wherein the generating the first listing of products specific to the first customer comprises: identifying, for multiple products identified based on the result of filtering the product database, a corresponding product category comprising a set of a plurality of similar products defined as being part of the product category; and
including two or more products from each of the product categories into the first listing of products specific to the first customer. 20. The method of claim 19, wherein the repeatedly updating and retraining the machine learning model comprises:
identifying that a first product, which was included in the most recent updated first listing of products, has not been purchased by the first customer within a threshold purchase period of time; and
updating the first listing of products to exclude the first product from the updated first listing of products in response to identifying that the first product has not been purchased by the first customer within the threshold purchase period of time; and
wherein the retraining the machine learning model is limited to the updated first listing of products excluding the first product. 21. The method of claim 14, further comprising:
receiving a notification from the portable user device associated with the customer identifying a version of a stored machine learning model presently stored on the portable user device;
determining that the version of the stored machine learning model is not the most recently updated version of the machine learning model; and
causing the communication of the most recently updated version of the trained machine learning model to the portable user device. 22. The method of claim 14, comprising:
by a decision control circuit of the portable user device:
processing each frame of a subset of one or more frames of a video content, captured by an imaging system of the portable use device, by at least a first modeling technique implemented by the trained machine learning model relative to a first image attribute and obtaining a corresponding first product identification probability that an item, captured within each of the subset of at least one frame, is estimated to be a first product of the first subset of tens of retail products;
processing each frame of the subset of at least one frame by a second modeling technique implemented by the trained machine learning model relative to a second image attribute that is different than the first attribute, and obtaining corresponding second product identification probability that the item, captured within each of the subset of at least one frame, is estimated to be the first product of the first subset of tens of retail products;
determining an aggregated first identification probability of the first product as a function of the first product identification probabilities corresponding to the frames of the subset of at least one frame;
determining an aggregated second identification probability of the first product as a function of the second product identification probabilities corresponding to the frames of the subset of at least one frame;
collectively evaluating the aggregated first identification probability and the aggregated second identification probability of the first product for the frames of the subset of at least one frame and identifying when one or more of the aggregated first identification probability and the aggregated second identification probability has a predefined relationship with a collective threshold probability; and
causing an image of the first product to be displayed in response to identifying that one or more of the aggregated first identification probability and the aggregated second identification probability has the predefined relationship with the collective threshold probability.
</claims>
</document>

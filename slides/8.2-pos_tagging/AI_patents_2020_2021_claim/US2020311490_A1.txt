<document>

<filing_date>
2019-04-01
</filing_date>

<publication_date>
2020-10-01
</publication_date>

<priority_date>
2019-04-01
</priority_date>

<ipc_classes>
A61B6/00,G01T1/161,G06K9/40,G06K9/66,G06T7/00
</ipc_classes>

<assignee>
CANON MEDICAL SYSTEMS CORPORATION
</assignee>

<inventors>
YU, ZHOU
ZHOU, JIAN
LEE, Tzu-Cheng
</inventors>

<docdb_family_id>
72607353
</docdb_family_id>

<title>
APPARATUS AND METHOD FOR SINOGRAM RESTORATION IN COMPUTED TOMOGRAPHY (CT) USING ADAPTIVE FILTERING WITH DEEP LEARNING (DL)
</title>

<abstract>
A method and apparatus is provided to reduce the noise in medical imaging by training a deep learning (DL) network to select the optimal parameters for a convolution kernel of an adaptive filter that is applied in the data domain. For example, in X-ray computed tomography (CT) the adaptive filter applies smoothing to a sinogram, and the optimal amount of the smoothing and orientation of the kernel (e.g., a bivariate Gaussian) can be determined on a pixel-by-pixel basis by applying a noisy sinogram to the DL network, which outputs the parameters of the filter (e.g., the orientation and variances of the Gaussian kernel). The DL network is trained using a training data set including target data (e.g., the gold standard) and input data. The input data can be sinograms generated by a low-dose CT scan, and the target data generated by a high-dose CT scan.
</abstract>

<claims>
1. An apparatus, comprising: circuitry configured to obtain radiation data representing an intensity of radiation detected at a plurality of detectors, acquire a neural network having weighting coefficients that have been trained to determine parameters of a filter, the parameters defining a shape function of a convolution kernel of the filter, apply the radiation data to the neural network, and in response outputting parameters based on the radiation data, and filter the radiation data by applying the filter defined by the output parameters from the neural network to generate filtered radiation data.
2. The apparatus according to claim 1, wherein the circuitry is further configured to obtain the radiation data, wherein the radiation data is a sinogram acquired by generating X-ray projection images at a series of projection views in which an angle between an X-ray source and the plurality of detectors is rotated relative to an image subject, and denoising the sinogram by applying the filter defined by the output parameters from the neural network generates a denoised sinogram, wherein the filter is applied to a three-dimensional volume of the sinogram or to two-dimensional slices of the sinogram, which include a segment dimension and a channel dimension, a view dimension and the channel dimension, and/or the segment dimension and a view dimension.
3. The apparatus according to claim 1, wherein the circuitry is further configured to obtain the radiation data, wherein the radiation data is one of X-ray computed tomography (CT) data, X-ray fluoroscopy data, gamma-ray positron emission tomography (PET), and single-photon emission CT data (SPECT).
4. The apparatus according to claim 2, wherein the circuitry is further configured to reconstruct a computed tomography (CT) image from the denoised sinogram using an analytical reconstruction method.
5. The apparatus according to claim 1, wherein the circuitry is further configured to filter the radiation data, wherein the filter is a smoothing filter, and filtering the radiation data denoises the radiation data.
6. The apparatus according to claim 5, wherein the circuitry is further configured to denoise the radiation data by applying the smoothing filter, wherein the shape function of the smoothing filter is a multi-variate, low-pass-filter kernel and the parameters of the smoothing filter comprise values defining widths and an orientation of the multi-variate, low-pass-filter kernel, and the values comprising the parameters vary as a function of pixel position within the radiation data.
7. The apparatus according to claim 6, wherein the circuitry is further configured to denoise the radiation data by applying the smoothing filter, wherein the multi-variate, low-pass-filter kernel is a multi-variate Gaussian.
8. The apparatus according to claim 1, wherein the circuitry is further configured to filter the radiation data by applying the filter, wherein the filter is a two-dimensional filter applied to two-dimensional slices of the radiation data along a segment dimension and a channel dimension, a view dimension and the channel dimension, or the view dimension and the segment dimension.
9. The apparatus according to claim 2, wherein the circuitry is further configured to acquire the neural network, wherein the weighting coefficients have been trained using training data that includes input data and target data, the input data comprising first training sinograms acquired using a first radiation dose, and the target data comprising second training sinograms acquired using a second radiation dose that is greater than the first radiation dose.
10. The apparatus according to claim 2, wherein the circuitry is further configured to obtain a training dataset comprising input sinograms paired with respective target sinograms, the input sinograms exhibiting greater noise than the corresponding target sinograms in the respective pairs, use the neural network to filter one of the input sinograms by applying the one of the input sinograms to the neural network and in response outputting parameters of the filter, and denoising the one of the input sinograms by applying, to the one of the input sinograms, the filter defined by the parameters output from the neural network, and thereby generating a filtered sinogram, and train the neural network iteratively adjusting the weighting coefficients to minimize a value of a loss function, the loss function measuring a disagreement between the respective target sinograms and the filtered sinograms corresponding to the input sinograms.
11. The apparatus according to claim 10, wherein the circuitry is further configured to train the neural network wherein the loss function includes a peak signal to noise ratio, a structural similarity index, and/or an p-norm of a difference between the respective target sinograms and the filtered sinograms corresponding to the input sinograms.
12. The apparatus according to claim 10, wherein the circuitry is further configured to filter the one of the input sinograms using the filter, wherein the filter is an adaptive filter in which the convolution kernel varies as a function of position within the one of the input sinograms thereby adapting to features represented in the one of the input sinograms.
13. A method, comprising: obtaining radiation data representing an intensity of radiation detected at a plurality of detectors; acquiring a neural network having weighting coefficients that have been trained to determine parameters of a filter in response to an input, the parameters defining a shape function of a convolution kernel of the filter; applying the radiation data to the neural network, and in response outputting parameters based on the radiation data; and denoising the radiation data by applying the filter defined by the output parameters from the neural network to generate filtered radiation data.
14. The method according to claim 13, wherein obtaining the radiation data includes that the radiation data is a sinogram acquired by generating X-ray projection images at a series of projection views in which an angle between an X-ray source and the plurality of detectors is rotated relative to an image subject, and denoising the sinogram by applying the filter defined by the output parameters from the neural network generates a filtered sinogram, wherein the filter is applied to a three-dimensional volume of the sinogram or to two-dimensional slices of the sinogram, which include a segment dimension and a channel dimension, a view dimension and the channel dimension, and/or the segment dimension and a view dimension.
15. The method according to claim 13, wherein obtaining the radiation data includes that the radiation data is one of X-ray computed tomography (CT) data, X-ray fluoroscopy data, gamma-ray positron emission tomography (PET), and single-photon emission CT data (SPECT).
16. The method according to claim 13, wherein denoising the radiation data by applying the filter further includes that the shape function of the filter is a multi-variate, low-pass-filter kernel and the parameters of the filter comprise values defining widths and an orientation of the multi-variate, low-pass-filter kernel, and the values comprising the parameters vary as a function of pixel position within the radiation data.
17. The method according to claim 14, wherein acquiring the neural network further includes that the weighting coefficients have been trained using training data including input data and target data, the input data comprising first training sinograms acquired using a first radiation dose, and the target data comprising second training sinograms acquired using a second radiation dose that is greater than the first radiation dose.
18. The method according to claim 14, further comprising obtaining a training dataset comprising input sinograms paired with respective target sinograms, the input sinograms exhibiting greater noise than the corresponding target sinograms in the respective pairs, using the neural network to filterone of the input sinograms by applying the one of the input sinograms to the neural network and in response outputting parameters of the filter, and denoising the one of the input sinograms by applying, to the one of the input sinograms, the filter defined by the parameters output from the neural network, and thereby generating a denoisfiltered sinogram, and training the neural network iteratively adjusting the weighting coefficients to minimize a value of a loss function, the loss function measuring a disagreement between the respective target sinograms and the denoised sinograms corresponding to the input sinograms.
19. The method according to claim 18, wherein denoising the one of the input sinograms using the filter further includes that the filter is an adaptive filter in which the convolution kernel varies as a function of position within the one of the input sinograms thereby adapting to features represented in the one of the input sinograms.
20. A non-transitory computer-readable storage medium including executable instructions, which when executed by circuitry, cause the circuitry to perform the method according to claim 13.
</claims>
</document>

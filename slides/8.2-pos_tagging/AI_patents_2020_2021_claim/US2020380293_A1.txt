<document>

<filing_date>
2020-05-21
</filing_date>

<publication_date>
2020-12-03
</publication_date>

<priority_date>
2019-06-03
</priority_date>

<ipc_classes>
G06K9/62,G06N3/08,G06T3/00,G06T3/60
</ipc_classes>

<assignee>
ROBERT BOSCH
</assignee>

<inventors>
FINNIE, NICOLE YING
Staffler, Benedikt Sebastian
</inventors>

<docdb_family_id>
66690215
</docdb_family_id>

<title>
DEVICE AND METHOD OF DIGITAL IMAGE CONTENT RECOGNITION, TRAINING OF THE SAME
</title>

<abstract>
A device and computer implemented method for digital image content recognition. The method includes determining, depending on a digital image, a first candidate class for the content of the digital image by a baseline model neural network comprising a first feature extractor and a first classifier for classifying digital images; determining a second candidate class for the content of the digital image by a prototypical neural network comprising a second feature extractor and a second classifier for classifying digital images, classifying the content of the digital image into either the first candidate class or the second candidate class depending on the result of a comparison of a first confidence score for the first candidate class to a threshold or of a comparison of a first confidence score for the first candidate class to a second confidence score for the second candidate class.
</abstract>

<claims>
1. A computer implemented method of digital image content recognition, the method comprising the following steps: determining, depending on a digital image, a first candidate class for content of the digital image, by a baseline model neural network, the baseline model neural network including a first feature extractor and a first classifier for classifying digital images; determining a second candidate class for the content of the digital image by a prototypical neural network, the prototypical neural network including a second feature extractor and a second classifier for classifying digital images; and classifying the content of the digital image into either the first candidate class or the second candidate class depending on the result of a comparison of a first confidence score for the first candidate class to a threshold or of a comparison of a first confidence score for the first candidate class to a second confidence score for the second candidate class.
2. The method according to claim 1, further comprising the following steps: applying one or more transformations to the digital image to create a modified digital image, the one or more transformations including cropping and/or mirroring and/or rotating and/or smoothing and/or contrast reduction; determining the first candidate class and/or the second candidate class for the modified digital image; determining an average of a numerical representation of the first and second candidate classes for the digital image and the modified digital image; and determining a class for the content of the digital image depending on the average.
3. A computer implemented method of training an artificial neural network for image content recognition, the method comprising the following steps: collecting a first set of digital images from a database, the database including digital images assigned to many shot classes and digital images assigned to few shot classes, wherein the first set of digital images is sampled from the digital images assigned to a many shot class; creating a first training set including the collected first set of digital images; training, in a first stage, a first artificial neural network, the first artificial neural network including a first feature extractor and a first classifier for classifying digital images using the first training set; collecting first parameters of the first feature extractor of the trained first artificial neural network; and determining, in a second stage, second parameters of a second feature extractor of a second artificial neural network, the second artificial neural network including the second feature extractor and a second classifier for classifying digital images depending on the first parameters.
4. The method according to claim 3, wherein, for the first digital images in each multi shot class, the same amount of digital images is sampled.
5. The method according to claim 3, wherein each multi shot class includes more digital images than each few shot class.
6. The method according to claim 3, further comprising the following step: training the second feature extractor with a second set of training data.
7. The method according to claim 3, further comprising: using the second classifier with the second feature extractor having fixed second parameters.
8. The method according to claim 3, wherein the first classifier is a cosine norm distance based classifier and/or the second classifier is a second cosine norm distance based classifier or a euclidean norm distance based classifier.
9. The method according to claim 3, wherein, digital images assigned to a class are sampled for the first set of digital images when the number of digital images assigned to the class exceeds a first threshold, wherein the digital images assigned to the class are sampled for the second set of digital images when the number of digital images assigned to the class exceeds a second threshold, and wherein digital images assigned to the class are neither sampled for the first set of digital images nor for the second set of digital images, when the number of digital images assigned to the class is equal to or below the first threshold and the second threshold.
10. The method according to claim 3, further comprising the following step: applying one or more transformations to a digital image to create a modified digital image, the one or more transformations including: cropping, and/or mirroring, and/or rotating, and/or smoothing, and/or contrast reduction; wherein: (i) the digital image is a digital image assigned to the multi shot class and the modified digital image is for the first training set, or (ii) the digital image is a digital image assigned to the low shot class and the modified digital image is for the second training set.
11. A computer implemented method, the method comprising the following steps: collecting a first set of digital images from a database, the database including digital images assigned to many shot classes and digital images assigned to few shot classes, wherein the first set of digital images is sampled from the digital images assigned to a many shot class; creating a first training set including the collected first set of digital images; training, in a first stage, a baseline model neural network, the baseline model neural network including a first feature extractor and a first classifier for classifying digital images using the first training set; collecting first parameters of the first feature extractor of the trained baseline model neural network; and determining, in a second stage, second parameters of a second feature extractor of a prototypical neural network, the prototypical neural network including the second feature extractor and a second classifier for classifying digital images depending on the first parameters; determining, depending on a digital image, a first candidate class for content of the digital image, by the trained baseline model neural network; determining a second candidate class for the content of the digital image by the trained prototypical neural network; and classifying the content of the digital image into either the first candidate class or the second candidate class depending on the result of a comparison of a first confidence score for the first candidate class to a threshold or of a comparison of a first confidence score for the first candidate class to a second confidence score for the second candidate class.
12. A device for image content recognition, the device comprising: a processor and a memory that are configured for image content recognition; wherein the device is configured to: determine, depending on a digital image, a first candidate class for content of the digital image, by a baseline model neural network, the baseline model neural network including a first feature extractor and a first classifier for classifying digital images; determine a second candidate class for the content of the digital image by a prototypical neural network, the prototypical neural network including a second feature extractor and a second classifier for classifying digital images; and classify the content of the digital image into either the first candidate class or the second candidate class depending on the result of a comparison of a first confidence score for the first candidate class to a threshold or of a comparison of a first confidence score for the first candidate class to a second confidence score for the second candidate class.
13. A device for processing digital images, comprising: a baseline model neural network device including a first feature extractor unit and a first classifier unit for classifying digital images adapted to determine, depending on a digital image, a first candidate class for content of the digital image; a prototypical neural network device including a second feature extractor unit and a second classifier unit for classifying digital images adapted to determine a second candidate class for the content of the digital image; and an aggregation device adapted to classify the content of the digital image into either the first candidate class or the second candidate class depending on the result of a comparison of a first confidence score for the first candidate class to a threshold or of a comparison of a first confidence score for the first candidate class to a second confidence score for the second candidate class.
14. The device according to claim 13, further comprising: a digital image transformation device adapted to apply one or more transformations to the digital image to create a modified digital image, the one or more transformations including: cropping, and/or mirroring, and/or rotating, and/or smoothing, and/or contrast reduction, to create a modified digital image, the first candidate class and/or the second candidate class being determined for the modified digital image; wherein the aggregation device is adapted to determine an average of a numerical representation of the first and second candidate classes for the digital image and the modified digital image, the class for the content of the digital image being determined depending on the average.
15. The device according to claim 12, further comprising: an input for providing the digital image, the digital image being captured from a digital image sensor; and an output adapted to output the class of the content of the digital image for controlling a motion or an operating state of a vehicle, or a robot, or a machine, in response to the digital image depending on the class of the content.
16. A non-transitory computer-readable memory medium on which is stored a computer program digital for image content recognition, the computer program, when executed by a computer, causing the computer to perform the following steps: determining, depending on a digital image, a first candidate class for content of the digital image, by a baseline model neural network, the baseline model neural network including a first feature extractor and a first classifier for classifying digital images; determining a second candidate class for the content of the digital image by a prototypical neural network, the prototypical neural network including a second feature extractor and a second classifier for classifying digital images; and classifying the content of the digital image into either the first candidate class or the second candidate class depending on the result of a comparison of a first confidence score for the first candidate class to a threshold or of a comparison of a first confidence score for the first candidate class to a second confidence score for the second candidate class.
17. A non-transitory computer-readable memory medium on which is stored a computer program digital for training an artificial neural network for image content recognition, the computer program, when executed by a computer, causing the computer to perform: collecting a first set of digital images from a database, the database including digital images assigned to many shot classes and digital images assigned to few shot classes, wherein the first set of digital images is sampled from the digital images assigned to a many shot class; creating a first training set including the collected first set of digital images; training, in a first stage, a first artificial neural network, the first artificial neural network including a first feature extractor and a first classifier for classifying digital images using the first training set; collecting first parameters of the first feature extractor of the trained first artificial neural network; and determining, in a second stage, second parameters of a second feature extractor of a second artificial neural network, the second artificial neural network including the second feature extractor and a second classifier for classifying digital images depending on the first parameters.
</claims>
</document>

<document>

<filing_date>
2020-08-17
</filing_date>

<publication_date>
2020-12-03
</publication_date>

<priority_date>
2017-01-30
</priority_date>

<ipc_classes>
G06N3/04,G06N3/08
</ipc_classes>

<assignee>
DEEPMIND TECHNOLOGIES
</assignee>

<inventors>
BANARSE, DYLAN SUNIL
BLUNDELL, CHARLES
FERNANDO, CHRISANTHA THOMAS
HA, DAVID
PRITZEL, ALEXANDER
RUSU, ANDREI-ALEXANDRU
WIERSTRA, DANIEL PIETER
ZWOLS, YORI
</inventors>

<docdb_family_id>
61224569
</docdb_family_id>

<title>
MULTI-TASK NEURAL NETWORKS WITH TASK-SPECIFIC PATHS
</title>

<abstract>
Methods, systems, and apparatus, including computer programs encoded on computer storage media, for using multi-task neural networks. One of the methods includes receiving a first network input and data identifying a first machine learning task to be performed on the first network input; selecting a path through the plurality of layers in a super neural network that is specific to the first machine learning task, the path specifying, for each of the layers, a proper subset of the modular neural networks in the layer that are designated as active when performing the first machine learning task; and causing the super neural network to process the first network input using (i) for each layer, the modular neural networks in the layer that are designated as active by the selected path and (ii) the set of one or more output layers corresponding to the identified first machine learning task.
</abstract>

<claims>
1. A method of training a super neural network on a particular machine learning task from a plurality of machine learning tasks, the super neural network comprising: a plurality of layers arranged in a stack one after the other, wherein each layer comprises a respective plurality of modular neural networks, and wherein the modular neural networks in each layer are each configured to receive a layer input for the layer and to generate a respective modular output; and a plurality of sets of one or more output layers, wherein each set of output layers corresponds to a different machine learning task from the plurality of machine learning tasks, and wherein each set of one or more output layers is configured to receive a stack output and to generate a neural network output that is specific to the corresponding machine learning task, and the method comprising: selecting a plurality of candidate paths through the plurality of layers, each of the candidate paths specifying, for each of the layers, a respective proper subset of the modular neural networks in the layer that are designated as active when performing the particular machine learning task; training the super neural network on each of the plurality of candidate paths, wherein training the super neural network on each of the plurality of candidate paths comprises, for each of the candidate paths, training the super neural network while processing training inputs only using the modular neural networks designated as active by the candidate paths and the output layer corresponding to the particular machine learning task; determining a fitness of each of the plurality of candidate paths based on results of the training of the super neural network on the candidate path; and selecting the candidate path having the best fitness as a best fit path for the particular machine learning task.
2. The method of claim 1, wherein selecting the plurality of candidate paths comprises: selecting a first candidate path and a second candidate path; determining, from training the super neural network on the first candidate path and the second candidate path, that the first candidate path has a better fitness than the second candidate path; based on determining that the first candidate path has a better fitness than the second candidate path: mutating the first candidate path by changing one or more of the active modular neural networks in the first candidate path; and replacing the second candidate path with the mutated first candidate path.
3. The method of claim 2, wherein mutating the first candidate path comprises, for each modular neural network designated as active by the first candidate path: determining whether to replace the modular neural network; and in response to determining to replace the modular neural network, designating the modular neural network as inactive and designating another modular neural network in the same layer as active.
4. The method of claim 3, wherein determining whether to replace the modular neural network comprises determining to replace the modular neural network with probability that is equal to or proportional to 1 divided by a total number of modular neural networks in the first candidate path.
5. The method of claim 1, wherein training the super neural network on each of the plurality of candidate paths comprises: training the super neural network on an initial plurality of candidate paths in parallel, and wherein selecting the plurality of candidate paths comprises: for each candidate path in the initial plurality: determining whether any of a subset of other candidate paths in the initial plurality has a better fitness than the candidate path; if any of the subset have a better fitness: identifying the candidate path in the subset that has a best fitness of the other candidate paths in the subset; mutating the identified candidate path by changing one or more of the active modular neural networks in the identified candidate path; and replacing the candidate path with the mutated identified candidate path.
6. The method of claim 5, wherein selecting the plurality of candidate paths comprises: if none of the candidate paths in the subset have a better fitness: maintaining the candidate path for further training.
7. The method of claim 5, wherein, for each candidate path in the initial plurality the subset of other candidate paths is chosen randomly.
8. The method of claim 1, wherein training the super neural network on each of the plurality of candidate paths comprises: during the training, holding fixed values of parameters of any modular neural networks that are in best fit paths for any machine learning tasks in the plurality of machine learning tasks for which a best fit path has already been determined.
9. The method of claim 1, further comprising: fixing values of parameters of modular neural networks that are designated as active by the best fit path for the particular machine learning task to not be adjusted during training of the super neural network on other tasks in the plurality of machine learning tasks.
10. A system comprising one or more computers and one or more storage devices storing instructions that when executed by the one or more computers cause the one or more computers to perform operations for training a super neural network on a particular machine learning task from a plurality of machine learning tasks, the super neural network comprising: a plurality of layers arranged in a stack one after the other, wherein each layer comprises a respective plurality of modular neural networks, and wherein the modular neural networks in each layer are each configured to receive a layer input for the layer and to generate a respective modular output; and a plurality of sets of one or more output layers, wherein each set of output layers corresponds to a different machine learning task from the plurality of machine learning tasks, and wherein each set of one or more output layers is configured to receive a stack output and to generate a neural network output that is specific to the corresponding machine learning task, and the operations comprising: selecting a plurality of candidate paths through the plurality of layers, each of the candidate paths specifying, for each of the layers, a respective proper subset of the modular neural networks in the layer that are designated as active when performing the particular machine learning task; training the super neural network on each of the plurality of candidate paths, wherein training the super neural network on each of the plurality of candidate paths comprises, for each of the candidate paths, training the super neural network while processing training inputs only using the modular neural networks designated as active by the candidate paths and the output layer corresponding to the particular machine learning task; determining a fitness of each of the plurality of candidate paths based on results of the training of the super neural network on the candidate path; and selecting the candidate path having the best fitness as a best fit path for the particular machine learning task.
11. The system of claim 10, wherein selecting the plurality of candidate paths comprises: selecting a first candidate path and a second candidate path; determining, from training the super neural network on the first candidate path and the second candidate path, that the first candidate path has a better fitness than the second candidate path; based on determining that the first candidate path has a better fitness than the second candidate path: mutating the first candidate path by changing one or more of the active modular neural networks in the first candidate path; and replacing the second candidate path with the mutated first candidate path.
12. The system of claim 11, wherein mutating the first candidate path comprises, for each modular neural network designated as active by the first candidate path: determining whether to replace the modular neural network; and in response to determining to replace the modular neural network, designating the modular neural network as inactive and designating another modular neural network in the same layer as active.
13. The system of claim 12, wherein determining whether to replace the modular neural network comprises determining to replace the modular neural network with probability that is equal to or proportional to 1 divided by a total number of modular neural networks in the first candidate path.
14. The system of claim 11, wherein training the super neural network on each of the plurality of candidate paths comprises: training the super neural network on an initial plurality of candidate paths in parallel, and wherein selecting the plurality of candidate paths comprises: for each candidate path in the initial plurality: determining whether any of a subset of other candidate paths in the initial plurality has a better fitness than the candidate path; if any of the subset have a better fitness: identifying the candidate path in the subset that has a best fitness of the other candidate paths in the subset; mutating the identified candidate path by changing one or more of the active modular neural networks in the identified candidate path; and replacing the candidate path with the mutated identified candidate path.
15. The system of claim 14, wherein selecting the plurality of candidate paths comprises: if none of the candidate paths in the subset have a better fitness: maintaining the candidate path for further training.
16. The system of claim 14, wherein, for each candidate path in the initial plurality the subset of other candidate paths is chosen randomly.
17. The system of claim 11, wherein training the super neural network on each of the plurality of candidate paths comprises: during the training, holding fixed values of parameters of any modular neural networks that are in best fit paths for any machine learning tasks in the plurality of machine learning tasks for which a best fit path has already been determined.
18. The system of claim 11, the operations further comprising: fixing values of parameters of modular neural networks that are designated as active by the best fit path for the particular machine learning task to not be adjusted during training of the super neural network on other tasks in the plurality of machine learning tasks.
19. One or more non-transitory computer-readable storage media storing instructions that when executed by one or more computers cause the one or more computers to perform operations for training a super neural network on a particular machine learning task from a plurality of machine learning tasks, the super neural network comprising: a plurality of layers arranged in a stack one after the other, wherein each layer comprises a respective plurality of modular neural networks, and wherein the modular neural networks in each layer are each configured to receive a layer input for the layer and to generate a respective modular output; and a plurality of sets of one or more output layers, wherein each set of output layers corresponds to a different machine learning task from the plurality of machine learning tasks, and wherein each set of one or more output layers is configured to receive a stack output and to generate a neural network output that is specific to the corresponding machine learning task, and the operations comprising: selecting a plurality of candidate paths through the plurality of layers, each of the candidate paths specifying, for each of the layers, a respective proper subset of the modular neural networks in the layer that are designated as active when performing the particular machine learning task; training the super neural network on each of the plurality of candidate paths, wherein training the super neural network on each of the plurality of candidate paths comprises, for each of the candidate paths, training the super neural network while processing training inputs only using the modular neural networks designated as active by the candidate paths and the output layer corresponding to the particular machine learning task; determining a fitness of each of the plurality of candidate paths based on results of the training of the super neural network on the candidate path; and selecting the candidate path having the best fitness as a best fit path for the particular machine learning task.
20. The computer-readable storage media of claim 19, wherein selecting the plurality of candidate paths comprises: selecting a first candidate path and a second candidate path; determining, from training the super neural network on the first candidate path and the second candidate path, that the first candidate path has a better fitness than the second candidate path; based on determining that the first candidate path has a better fitness than the second candidate path: mutating the first candidate path by changing one or more of the active modular neural networks in the first candidate path; and replacing the second candidate path with the mutated first candidate path.
</claims>
</document>

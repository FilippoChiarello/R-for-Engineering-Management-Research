<document>

<filing_date>
2017-06-23
</filing_date>

<publication_date>
2020-06-16
</publication_date>

<priority_date>
2016-06-23
</priority_date>

<ipc_classes>
A61B17/00,A61B17/56,A61B34/10,A61B34/20,A61B90/00,G06T7/00,G06T7/10,G06T7/11,G06T7/168,G06T7/262,G06T7/38
</ipc_classes>

<assignee>
7D SURGICAL
</assignee>

<inventors>
STANDISH, BEAU ANTHONY
MARIAMPILLAI, ADRIAN
SIEGLER, PETER
YANG, VICTOR X. D.
LEUNG, MICHAEL K. K.
</inventors>

<docdb_family_id>
60783595
</docdb_family_id>

<title>
Systems and methods for intraoperative spinal level verification
</title>

<abstract>
Systems and methods are provided in which intraoperatively acquired surface data is employed to verify the correspondence of an intraoperatively selected spinal level with a spinal level that is pre-selected based on volumetric image data. Segmented surface data corresponding to the pre-selected spinal levels may be obtained from the volumetric image data, such that the segmented surface data corresponds to a spinal segment that is expected to be exposed and identified intraoperatively during the surgical procedure. The segmented surface data from the pre-selected spinal level, and adjacent segmented surface data from an adjacent spinal level that is adjacent to the pre-selected spinal level, is registered to the intraoperative surface data, and quality measures associated with the registration are obtained, thereby permitting an assessment or a determination of whether or not the pre-selected spinal surface (in the volumetric frame of reference) is likely to correspond to the intraoperatively selected spinal level.
</abstract>

<claims>
Therefore what is claimed is:
1. A method of performing intraoperative spinal level verification, the method comprising: obtaining volumetric image data pertaining to a plurality of spinal levels of a spine; processing the volumetric image data to generate multi-level surface data characterizing a bone surface of the spine; obtaining input identifying at least three volumetric fiducial points at a pre-selected set of one or more contiguous spinal levels within a volumetric frame of reference associated with the volumetric image data and the multi-level surface data; obtaining directional information associated with an orientation of the spine in the volumetric frame of reference; employing at least one of the volumetric fiducial points to perform segmentation on the multi-level surface data, thereby obtaining segmented surface data associated with the pre-selected set of one or more contiguous spinal levels; employing the directional information to determine an adjacent volumetric region within the volumetric frame of reference that is associated with an adjacent set of one or more contiguous spinal levels that is adjacent to the pre-selected set of one or more contiguous spinal levels; performing segmentation on the multi-level surface data within the adjacent volumetric region, thereby obtaining adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels; registering the segmented surface data associated with the pre-selected set of one or more contiguous spinal levels to the adjacent segmented surface data, thereby obtaining an inter-level registration transform between the pre-selected set of one or more contiguous spinal levels and the adjacent set of one or more contiguous spinal levels; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing a surface region including at least a portion of an intraoperatively selected set of one or more contiguous spinal levels; obtaining input identifying at least three intraoperative fiducial points associated with the intraoperatively selected set of one or more contiguous spinal levels, within an intraoperative frame of reference associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point; employing the volumetric fiducial points and the corresponding intraoperative fiducial points to perform an initial registration between the segmented surface data and the intraoperative surface data, and performing a secondary surface-to-surface registration between the segmented surface data and the intraoperative surface data; employing the inter-level registration transform to perform registration between the intraoperative surface data and the adjacent segmented surface data; determining registration quality measures comprising: a primary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data; and an adjacent registration quality measure associated with a quality of the registration between the intraoperative surface data and the adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels; and providing feedback associated with the registration quality measures.
2. The method according to claim 1 wherein the feedback is suitable for inferring whether or not the intraoperatively selected set of one or more contiguous spinal levels is likely to correspond to the pre-selected set of one or more contiguous spinal levels.
3. The method according to claim 1 wherein the adjacent set of one or more contiguous spinal levels is a first adjacent set of one or more contiguous spinal levels, and wherein an additional adjacent registration quality measure is also determined for a second adjacent set of one or more contiguous spinal levels that is adjacent to the pre-selected set of one or more contiguous spinal levels and is located on an opposite side of the pre-selected set of one or more contiguous spinal levels relative to the first adjacent set of one or more contiguous spinal levels.
4. The method according to claim 1 further comprising: generating additional adjacent segmented surface data associated with an additional adjacent set of one or more contiguous spinal levels, wherein the additional adjacent set of one or more contiguous spinal levels is adjacent to the adjacent set of one or more contiguous spinal levels having the adjacent segmented surface data associated therewith; registering the adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels to the additional adjacent segmented surface data associated with the additional adjacent set of one or more contiguous spinal levels, thereby obtaining an additional inter-level registration transform between the adjacent set of one or more contiguous spinal levels and the additional adjacent set of one or more contiguous spinal levels; employing the additional inter-level registration transform to perform registration between the intraoperative surface data and the additional adjacent segmented surface data; determining an additional registration quality measure characterizing a quality of the registration between the intraoperative surface data and the additional adjacent segmented surface data.
5. The method according to claim 4 wherein the additional adjacent segmented surface data is determined by: employing the adjacent segmented surface data and the directional information to determine an additional adjacent volumetric region associated with the additional adjacent set of one or more contiguous spinal levels; and performing segmentation on the multi-level surface data within the additional adjacent volumetric region, thereby obtaining the additional adjacent segmented surface data associated with the additional adjacent set of one or more contiguous spinal levels.
6. The method according to claim 5 wherein a size of the additional adjacent volumetric region is determined by processing the adjacent segmented surface data to determine a spatial extent of the adjacent set of one or more contiguous spinal levels.
7. The method according to claim 4 wherein the additional adjacent segmented surface data is determined by: applying the additional inter-level registration transform to one or more of the adjacent volumetric fiducial points, thereby obtaining one or more estimated additional adjacent volumetric fiducial locations associated with the additional adjacent set of one or more contiguous spinal levels; employing the one or more estimated additional adjacent volumetric fiducial locations to determine one or more additional adjacent volumetric fiducial points associated with the additional adjacent set of one or more contiguous spinal levels; and performing region growing on the multi-level surface data relative to one or more of the additional adjacent volumetric fiducial points.
8. The method according to claim 1 further comprising, in the event that the primary registration quality measure is not a highest registration quality measure, providing feedback indicating that the intraoperatively selected set of one or more contiguous spinal levels may not correspond to the pre-selected set of one or more contiguous spinal levels.
9. The method according to claim 8 further comprising employing the inter-level registration transform to perform segmentation of the intraoperative surface data within a region corresponding to an adjacent intraoperative set of one or more contiguous spinal levels that is adjacent to the intraoperatively selected set of one or more contiguous spinal levels, thereby obtaining segmented adjacent intraoperative surface data, and employing registration between the segmented adjacent intraoperative surface data and segmented surface data associated with one or more of spinal levels of the volumetric image data in order to improve an accuracy of the feedback.
10. The method according to claim 8 further comprising: obtaining input identifying at least three additional intraoperative fiducial points associated with an adjacent intraoperative set of one or more contiguous spinal levels that is adjacent to the intraoperatively selected set of one or more contiguous spinal levels; employing the volumetric fiducial points and the corresponding additional intraoperative fiducial points to perform an initial registration between the segmented surface data and the intraoperative surface data, and performing a secondary surface-to-surface registration between the segmented surface data and the intraoperative surface data; determining a supplementary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data, where the registration is based on the use of the at least three additional intraoperative fiducial points; and providing additional feedback suitable for inferring whether or not the adjacent intraoperative set of one or more contiguous spinal levels is likely to correspond to the pre-selected set of one or more contiguous spinal levels.
11. The method according to claim 1 further comprising, in the event that the primary registration quality measure is not a highest registration quality measure, providing feedback identifying an alternative intraoperative set of one or more contiguous spinal levels that is estimated to correspond to the pre-selected set of one or more contiguous spinal levels.
12. The method according to claim 11 further comprising: obtaining input identifying at least three additional intraoperative fiducial points associated with the alternative intraoperative set of one or more contiguous spinal levels; employing the volumetric fiducial points and the corresponding additional intraoperative fiducial points to perform an initial registration between the segmented surface data and the intraoperative surface data, and performing a secondary surface-to-surface registration between the segmented surface data and the intraoperative surface data; determining a supplementary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data, where the registration is based on the use of the at least three additional intraoperative fiducial points; and providing additional feedback suitable for inferring whether or not the alternative intraoperative set of one or more contiguous spinal levels is likely to correspond to the pre-selected set of one or more contiguous spinal levels.
13. The method according to claim 11 further comprising: identifying an inter-level registration transform corresponding to the set of one or more contiguous spinal levels in the volumetric image data that is associated with a largest registration quality measure; employing the identified inter-level registration transform to determine additional intraoperative fiducial points within the intraoperative surface data; employing the identified inter-level registration transform to transform the intraoperative fiducial points, thereby obtaining additional intraoperative fiducial points within the intraoperative surface data that correspond to the alternative intraoperative set of one or more contiguous spinal levels; determining a supplementary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data, where the registration is based on the use of the at least three additional intraoperative fiducial points to perform an initial registration, followed by surface-to-surface registration; and providing additional feedback suitable for inferring whether or not the alternative intraoperative set of one or more contiguous spinal levels is likely to correspond to the pre-selected set of one or more contiguous spinal levels.
14. The method according to claim 1 wherein registration between the intraoperative surface data and the adjacent segmented surface data of the adjacent set of one or more contiguous spinal levels is performed by: applying the inter-level registration transform between the pre-selected set of one or more contiguous spinal levels and the adjacent set of one or more contiguous spinal levels to the volumetric fiducial points, thereby obtaining estimated adjacent volumetric fiducial locations associated with the adjacent set of one or more contiguous spinal levels; employing the estimated adjacent volumetric fiducial locations to determine adjacent volumetric fiducial points residing within an adjacent segmented surface defined by the adjacent segmented surface data; and employing the adjacent volumetric fiducial points and the corresponding intraoperative fiducial points to perform an initial registration between the adjacent segmented surface data of the adjacent set of one or more contiguous spinal levels and the intraoperative surface data, and performing a secondary surface-to-surface registration.
15. The method according to claim 1 wherein registration between the intraoperative surface data and the adjacent segmented surface data of a given adjacent set of one or more contiguous spinal levels is performed by: applying, to the adjacent segmented surface data of the adjacent set of one or more contiguous spinal levels: the inter-level registration transform between the pre-selected set of one or more contiguous spinal levels and the adjacent set of one or more contiguous spinal levels, for aligning the adjacent segmented surface data with the segmented surface data of the pre-selected set of one or more contiguous spinal levels; and a volumetric-to-intraoperative registration transform determined when registering the segmented surface data to the intraoperative surface data, for aligning the adjacent segmented surface data with the intraoperative surface data, thereby obtaining transformed adjacent segmented surface data; and performing registration between the segmented surface data and the transformed adjacent segmented surface data.
16. The method according to claim 1 wherein the directional information is determined employing one of: a DICOM header, principal component analysis, and spinal cord location extraction via image processing.
17. The method according to claim 1 wherein the directional information is determined by: a) determining a preferential axis for processing the volumetric image data; b) segmenting the volumetric image data into a series of volumetric slab segments arranged along the preferential axis; c) identifying a volumetric slab segment containing at least one of the volumetric fiducial points; d) determining an initial volumetric test region bounding the at least one of the volumetric fiducial points within the volumetric slab segment; e) determining a center of mass location within the initial volumetric test region; f) determining, based on the center of mass location, an adjacent volumetric test region within an adjacent volumetric slab segment, and determining an adjacent center of mass location within the adjacent volumetric test region; g) repeating step f) one or more times to obtain a set of center of mass locations corresponding to different volumetric slab segments; and h) processing the set of center of mass locations to determine the directional information characterizing the orientation of the spine.
18. The method according to claim 17 wherein when repeating step f) to identify an additional adjacent center of mass location within an additional adjacent volumetric slab segment, an additional adjacent volumetric test region within the additional adjacent volumetric slab segment is determined by translating a previously determined adjacent volumetric test region along a local axis, wherein the local axis is determined based on two center of mass locations corresponding to volumetric slab segments neighbouring the additional adjacent volumetric slab segment.
19. The method according to claim 17 wherein, when performing steps e) or f), the center of mass location that is determined is an estimated center of mass location, the method further comprising: (i) generating a refined center of mass location by determining a second volumetric test region bounding the estimated center of mass location, and (ii) determining the refined center of mass location within the second volumetric test region.
20. The method according to claim 19 further comprising repeating steps (i) and (ii) one or more times until a pre-selected convergence criterion has been satisfied.
21. The method according to claim 1 wherein one or more of the segmented surface data and the adjacent segmented surface data is obtained by performing region growing on the multi-level surface data.
22. The method according to claim 1 wherein the adjacent volumetric region associated with the adjacent set of one or more contiguous spinal levels is determined by: determining a bounding box associated with the segmented surface data; employing the directional information to translate the bounding box to a spatial region expected to contain the adjacent set of one or more contiguous spinal levels.
23. The method according to claim 1 wherein one or more of the intraoperative fiducial points are employed to segment the intraoperative surface data prior to performing registration.
24. The method according to claim 1 wherein the input identifying the at least three volumetric fiducial points at the pre-selected set of one or more contiguous spinal levels identifies the at least three volumetric fiducial points within the multi-level surface data.
25. The method according to claim 1 wherein the surface detection subsystem is a structured light subsystem.
26. A system for performing intraoperative spinal level verification, the system comprising: a surface detection subsystem; and computer hardware operatively coupled to said surface detection subsystem, wherein said computer hardware comprises memory coupled with one or more processors to store instructions, which when executed by the one or more processors, causes the one or more processors to perform operations comprising: processing volumetric image data pertaining to a plurality of spinal levels of a spine to generate multi-level surface data characterizing a bone surface of the spine; receiving input identifying at least three volumetric fiducial points at a pre-selected set of one or more contiguous spinal levels within a volumetric frame of reference associated with the volumetric image data and the multi-level surface data; obtaining directional information associated with an orientation of the spine in the volumetric frame of reference; employing at least one of the volumetric fiducial points to perform segmentation on the multi-level surface data, thereby obtaining segmented surface data associated with the pre-selected set of one or more contiguous spinal levels; employing the directional information to determine an adjacent volumetric region within the volumetric frame of reference that is associated with an adjacent set of one or more contiguous spinal levels that is adjacent to the pre-selected set of one or more contiguous spinal levels; performing segmentation on the multi-level surface data within the adjacent volumetric region, thereby obtaining adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels; registering the segmented surface data associated with the pre-selected set of one or more contiguous spinal levels to the adjacent segmented surface data, thereby obtaining an inter-level registration transform between the pre-selected set of one or more contiguous spinal levels and the adjacent set of one or more contiguous spinal levels; controlling said surface detection subsystem to intraoperatively detect intraoperative surface data characterizing a surface region including at least a portion of an intraoperatively selected set of one or more contiguous spinal levels; receiving input identifying at least three intraoperative fiducial points associated with the intraoperatively selected set of one or more contiguous spinal levels, within an intraoperative frame of reference associated with the intraoperative surface data, each intraoperative fiducial point corresponding to a respective volumetric fiducial point; employing the volumetric fiducial points and the corresponding intraoperative fiducial points to perform an initial registration between the segmented surface data and the intraoperative surface data, and performing a secondary surface-to-surface registration between the segmented surface data and the intraoperative surface data; employing the inter-level registration transform to perform registration between the intraoperative surface data and the adjacent segmented surface data; determining registration quality measures comprising: a primary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data; and an adjacent registration quality measure associated with a quality of the registration between the intraoperative surface data and the adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels; and providing feedback associated with the registration quality measures.
27. A method of performing intraoperative spinal level verification, the method comprising: obtaining volumetric image data pertaining to a plurality of spinal levels of a spine; processing the volumetric image data to generate multi-level surface data characterizing a bone surface of the spine; performing segmentation on the multi-level surface data, thereby obtaining: segmented surface data associated with a pre-selected set of one or more contiguous spinal levels; and adjacent segmented surface data associated with an adjacent set of one or more contiguous spinal levels; intraoperatively detecting, with a surface detection subsystem, intraoperative surface data characterizing a surface region including at least a portion of an intraoperatively selected set of one or more contiguous spinal levels; performing registration between the intraoperative surface data and the segmented surface data; performing registration between the intraoperative surface data and the adjacent segmented surface data; determining registration quality measures comprising: a primary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data; and an adjacent registration quality measure associated with a quality of the registration between the intraoperative surface data and the adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels; and providing feedback associated with the registration quality measures.
28. A system for performing intraoperative spinal level verification, the system comprising: a surface detection subsystem; and computer hardware operatively coupled to said surface detection subsystem, wherein said computer hardware comprises memory coupled with one or more processors to store instructions, which when executed by the one or more processors, causes the one or more processors to perform operations comprising: processing volumetric image data pertaining to a plurality of spinal levels of a spine to generate multi-level surface data characterizing a bone surface of the spine; performing segmentation on the multi-level surface data, thereby obtaining: segmented surface data associated with a pre-selected set of one or more contiguous spinal levels; and adjacent segmented surface data associated with an adjacent set of one or more contiguous spinal levels; intraoperatively detecting, with said surface detection subsystem, intraoperative surface data characterizing a surface region including at least a portion of an intraoperatively selected set of one or more contiguous spinal levels; performing registration between the intraoperative surface data and the segmented surface data; performing registration between the intraoperative surface data and the adjacent segmented surface data; determining registration quality measures comprising: a primary registration quality measure associated with a quality of the registration between the intraoperative surface data and the segmented surface data; and an adjacent registration quality measure associated with a quality of the registration between the intraoperative surface data and the adjacent segmented surface data associated with the adjacent set of one or more contiguous spinal levels; and providing feedback associated with the registration quality measures.
</claims>
</document>

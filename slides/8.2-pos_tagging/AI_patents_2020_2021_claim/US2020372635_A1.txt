<document>

<filing_date>
2018-08-02
</filing_date>

<publication_date>
2020-11-26
</publication_date>

<priority_date>
2017-08-03
</priority_date>

<ipc_classes>
G06K9/46,G06K9/62,G06N3/08,G06T7/00,G06T7/11,G16H10/40,G16H50/20
</ipc_classes>

<assignee>
Nucleai Ltd
</assignee>

<inventors>
CHOREV, Lotan
VEIDMAN, Avi
</inventors>

<docdb_family_id>
63371754
</docdb_family_id>

<title>
SYSTEMS AND METHODS FOR ANALYSIS OF TISSUE IMAGES
</title>

<abstract>
There is provided a method of computing at least one slide-level tissue type for a tissue image of tissue extracted from a patient, comprising: receiving a tissue image of a slide including tissue extracted from the patient, segmenting tissue objects of the tissue image, creating a tissue image patches from the segmented tissue objects of the tissue image, classifying, by a patch-level classifier, each of the plurality of tissue image patches into at least one patch-level tissue type, wherein each of the classified tissue image patches is associated with a relative location within the tissue image, analyzing, by a slide-level analysis code, the classified at least one patch-level tissue type and associated relative location for each of the plurality of tissue image patches outputted by the patch-level classifier, for computing at least one slide-level tissue type for the tissue image, and providing the at least one slide-level tissue type.
</abstract>

<claims>
1. A computer implemented method of computing at least one slide-level tissue type for a tissue image of tissue extracted from a patient, comprising: receiving a tissue image of a slide including tissue extracted from the patient; segmenting tissue objects of the tissue image; creating a plurality of tissue image patches from the segmented tissue objects of the tissue image; classifying, by a patch-level classifier, each of the plurality of tissue image patches into at least one patch-level tissue type, wherein each of the classified tissue image patches is associated with a relative location within the tissue image, wherein the patch-level classifier outputs, for each respective patch, a vector storing plurality of probabilities, each probability indicative of the respective patch being classified to one of a plurality of possible patch-level tissue types; analyzing, by a slide-level analysis code, the classified at least one patch-level tissue type and associated relative location for each of the plurality of tissue image patches outputted by the patch-level classifier, for computing at least one slide-level tissue type for the tissue image, wherein the slide-level analysis code comprises a convolutional neural network (CNN) that receives as input each respective vector outputted by the patch-level classifier for each of the plurality of patches of the tissue image; and providing the at least one slide-level tissue type.
2. The method according to claim 1, wherein the at least one slide-level tissue type is distinct from the at least one patch-level tissue type.
3. The method according to claim 1, wherein the at least one slide-level tissue type is computed based on two or more distinct patch level tissue types computed for two or more patches.
4. The method according to claim 1, wherein the at least one slide-level tissue type is computed according to at least one geometric feature based on associated relative location of each of the plurality of tissue patches, wherein the at least one geometric feature is selected from the group consisting of: distance between patches, total area of patches of a same patch-level tissue type, area of patches of a same patch-level tissue type directly neighboring one another, patches of a first patch level-tissue type separated by at least one patch of a second patch level-tissue type, density of tissue objects identified in at least one patch, relative angle between patches according to a center point, and combinations of the aforementioned.
5. (canceled)
6. The method according to claim 1, wherein the associated relative location is according to location of patches of the extracted tissue located on the slide, and excludes relative in-situ anatomical locations within the body of the patient.
7. The method according to claim 1, further comprising: generating instructions for treatment of the patient according to a set of rules applied to the analysis, wherein the instructions for treatment of the patient comprise instructions to obtain another tissue sample from the patient, and further comprising iterating the acts of the method for analysis of the another tissue for generating updated instructions for treatment of the patient, wherein the instructions for treatment of the patient are presented in a graphical user interface (GUI), and wherein the GUI is updated according to updated instructions, wherein the set of rules is indicative of adequacy of the tissue image, wherein when the set of rules is not met the generated instructions include instructions for additional treatment of the patient, wherein the set of rules for generating instructions to obtain another tissue sample include: blurry tissue image, poor sample preparation, unclean margins and instructions to cut additional tissue, identified tissue does not correspond to target biopsy location, insufficient tissue for proper classification, and no malignancy detected, wherein when the set of rules is met the instructions include instructions to stop the treatment.
8. 8-16. (canceled)
17. The method of claim 1, wherein the slide-level analysis code comprises: computing a probability heatmap, wherein each pixel of the heatmap corresponds to a certain patch of plurality of tissue image patches and includes a respective value indicative of the patch-level tissue type of the corresponding tissue image patch selected from the group consisting of: a vector storing plurality of probabilities each probability indicative of the respective patch being classified to one of a plurality of possible patch-level tissue types, and a single indication of one of a plurality of possible patch-level issue types associated with each patch; extracting features from the probability heatmap according to a plurality of feature thresholds; computing a respective binary mask of a plurality of binary masks, according to features extracted according to each feature threshold of the plurality of feature thresholds; extracting geometrical features from each respective binary mask of the plurality of binary masks; and computing the at least one slide-level tissue type according to the extracted geometrical features of each respective binary mask, wherein features extracted from the probability heatmap and geometrical features extracted from binary masks are selected from the group consisting of: size of a largest connected area in the mask and/or heatmap, eccentricity of the largest connected area in the mask and/or heatmap, solidity of the largest connected area in the mask and/or heatmap, extent of the largest connected area in the mask and/or heatmap, number of pixels above a pixel threshold, distance between largest connected areas, and combinations of the aforementioned, wherein the plurality of feature thresholds are selected according to values of heat pixels corresponding to respective patch-level tissue types.
18. 18-19. (canceled)
20. The method according to claim 1, wherein the slide-level analysis code comprises: computing, for each pixel element of each patch of the plurality of tissue image patches, a pixel element level segmentation including a probability of the respective pixel element being associated with the at least one patch-level tissue type; extracting geometrical features according to the pixel element level segmentation of each patch, wherein the geometrical features are computed based on relative locations of at least two segmented pixels of at least two patches; and computing the at least one slide-level tissue type according to the extracted geometrical features.
21. The method according to claim 1, wherein a plurality of tissue images of a plurality of slides of sequential sections of the tissue extracted from the patient are received, wherein the plurality of tissue images are registered to compute a single registered tissue image, wherein values of pixels of the single registered tissue image are computed according to values of pixels of the registered tissue images, wherein the segmenting, the creating the plurality of tissue image patches, the classifying, the analyzing, and the providing are performed for the single registered tissue image for computing at least one multi-slide level tissue type, wherein a plurality of tissue images of a plurality of slides of the tissue extracted from the patient are received, wherein the segmenting, the creating the plurality of tissue image patches, the classifying, the analyzing, and the providing are performed for the single registered tissue image for computing at least one multi-slide level tissue type.
22. (canceled)
23. The method according to claim 1, wherein a plurality of tissue images of a plurality of slides of sequential sections of the tissue extracted from the patient are received, wherein each of the plurality of slides is stained with a different staining type, wherein the segmenting, the creating the plurality of tissue image patches, the classifying, the analyzing, and the providing are performed for each of the plurality of tissue images, and further comprising computing at least one multi-level tissue type according to an analysis based on a set of rules for each tissue image of the plurality of tissue images.
24. The method according to claim 1, wherein the tissue image is of a whole slide including a plurality of tissue regions and non-tissue background, and wherein the plurality of tissues regions are segmented from the non-tissue background by a trained segmentation CNN.
25. The method according to claim 1, wherein segmenting tissue objects comprises computing at least one of: a binary mask indicative of tissue objects of the tissue image, and polygons denoting tissue objects of the tissue image.
26. The method according to claim 1, wherein segmenting tissue objects comprises: excluding non-tissue background of the tissue image according to a color of pixels of the tissue image indicative of non-tissue background, to obtain a set of pixels indicative of tissue objects; converting the set of pixels indicative of tissue objects to a selected color space according to a resolution of the tissue image; clustering the set of converted pixels indicative of tissue objects according to the selected color space to computed a plurality of clusters; computing a color distance between a respective location of a respective cluster of the plurality of clusters within a plane of the selected color space, and a defined configuration of colors of the selected color space; and defining pixels of clusters having color distance above a pre-defined distance threshold as non-tissue.
27. The method according to claim 1, wherein segmenting tissue objects comprises identifying pixels indicative of non-tissue background of the tissue image, and dilating identified pixels indicative of non-tissue background surrounded by pixels indicative of tissue for defining the identified pixels as tissue.
28. The method according to claim 1, wherein segmenting tissue objects comprises: dividing the tissue image into a plurality of tissue image patches; identifying a sub-set of the plurality of tissue image patches as indicative of out-of-focus by a trained classifier that receives as input each of the plurality of tissue image patches and outputs a corresponding out-of-focus indication; removing the sub-set of the plurality of tissue image patches indicative of out-of-focus from the plurality of tissue image patches to create a set of remaining in-focus patches; outputting the set of remaining in-focus patches for classifying by the patch-level classifier; and computing an indication of an amount of the out-of-focus of the sub-set of the plurality of tissue image patches; and when the indication of the amount of the out-of-focus is above an out-of-focus threshold, at least one of: stopping execution of the method prior to classifying by the patch-level classifier, and presenting instructions on a display to re-scan a slide with tissue to generate another tissue image.
29. (canceled)
30. The method according to claim 1, wherein the tissue image of the slide including tissue extracted from the patient is performed using a multispectral imager that creates tissues images with at least 4 spectrum frequencies.
31. 31-33. (canceled)
34. The method according to claim 1, wherein the patch-level classifier outputs, for each respective patch, a single indication of one of a plurality of possible patch-level tissue types.
35. 35-36. (canceled)
37. The method according to claim 1, further comprising detecting tissue objects of a certain tissue type in the tissue image, wherein the detecting is performed according to at least one of: at least one patch of the plurality of patches classified as the certain tissue type, and segmenting of tissue objects of the certain tissue type, above a predefined threshold number of pixels of the tissue image segmented as the certain tissue type.
38. 38-48. (canceled)
49. A system for computing at least one slide-level tissue type for a tissue image of tissue extracted from a patient, comprising: a non-transitory memory having stored thereon a code for execution by at least one hardware processor, the code comprising: code for receiving a tissue image of a slide including tissue extracted from the patient; code for segmenting tissue objects of the tissue image; code for creating a plurality of tissue image patches from the segmented tissue objects of the tissue image; code for classifying, by a patch-level classifier, each of the plurality of tissue image patches into at least one patch-level tissue type, wherein each of the classified tissue image patches is associated with a relative location within the tissue image, wherein the patch-level classifier outputs, for each respective patch, a vector storing plurality of probabilities, each probability indicative of the respective patch being classified to one of a plurality of possible patch-level tissue types; code for analyzing, by a slide-level analysis code, the classified at least one patch-level tissue type and associated relative location for each of the plurality of tissue image patches outputted by the patch-level classifier, for computing at least one slide-level tissue type for the tissue image, wherein the slide-level analysis code comprises a convolutional neural network (CNN) that receives as input each respective vector outputted by the patch-level classifier for each of the plurality of patches of the tissue image; and code for outputting the at least one slide-level tissue type.
50. A computer program product for computing at least one slide-level tissue type for a tissue image of tissue extracted from a patient, comprising: a non-transitory memory having stored thereon a code for execution by at least one hardware processor, the code comprising instructions for: receiving a tissue image of a slide including tissue extracted from the patient; segmenting tissue objects of the tissue image; creating a plurality of tissue image patches from the segmented tissue objects of the tissue image; classifying, by a patch-level classifier, each of the plurality of tissue image patches into at least one patch-level tissue type, wherein each of the classified tissue image patches is associated with a relative location within the tissue image, wherein the patch-level classifier outputs, for each respective patch, a vector storing plurality of probabilities, each probability indicative of the respective patch being classified to one of a plurality of possible patch-level tissue types; analyzing, by a slide-level analysis code, the classified at least one patch-level tissue type and associated relative location for each of the plurality of tissue image patches outputted by the patch-level classifier, for computing at least one slide-level tissue type for the tissue image, wherein the slide-level analysis code comprises a convolutional neural network (CNN) that receives as input each respective vector outputted by the patch-level classifier for each of the plurality of patches of the tissue image; and outputting the at least one slide-level tissue type.
</claims>
</document>

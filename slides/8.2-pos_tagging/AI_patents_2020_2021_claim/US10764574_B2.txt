<document>

<filing_date>
2016-03-18
</filing_date>

<publication_date>
2020-09-01
</publication_date>

<priority_date>
2015-07-01
</priority_date>

<ipc_classes>
G06N20/00,G06N99/00,H04N19/103,H04N19/11,H04N19/117,H04N19/136,H04N19/14,H04N19/176,H04N19/46,H04N19/82
</ipc_classes>

<assignee>
PANASONIC INTELLECTUAL PROPERTY
</assignee>

<inventors>
LIM, CHONG SOON
TERADA, KENGO
NISHI TAKAHIRO
TOMA TADAMASA
TEO, HAN BOON
</inventors>

<docdb_family_id>
57608121
</docdb_family_id>

<title>
Encoding method, decoding method, encoding apparatus, decoding apparatus, and encoding and decoding apparatus
</title>

<abstract>
To provide an encoding method for reducing deterioration in encoding efficiency when encoding a video/an image by selecting one operation mode out of a number of operation modes. The encoding method includes: extracting one or more features from one or more reconstructed pixel groups; categorizing the one or more reconstructed pixel groups using the extracted one or more features and a first machine learning model; and performing an encoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing, the parameter set being one of a plurality of predefined parameter sets.
</abstract>

<claims>
1. An encoding method, comprising: extracting one or more features from one or more reconstructed pixel groups; writing, in a header of a bitstream, a first control parameter for controlling which one of a first machine learning model and a second machine learning model is to be used, the second machine learning model being different from the first machine learning model; categorizing the one or more reconstructed pixel groups, wherein (i) when the written first control parameter has a predefined first value for using the first machine learning model, the one of more reconstructed pixel groups are categorized using the extracted one or more features and the first machine learning model, and (ii) when the written first control parameter does not have the predefined first value, the one of more reconstructed pixel groups are categorized using the extracted one or more features and the second machine learning model; performing an encoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing, the parameter set being one of a plurality of predefined parameter sets; writing, in the header of the bitstream, a second control parameter for controlling whether to modify the first machine learning model; when the written second control parameter does not have a predefined second value for controlling whether to modify the first machine learning model, performing the categorizing of the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model; when the written second control parameter has the predefined second value: writing, in the header of the bitstream, a third control parameter for modifying the first machine learning model; and modifying the first machine learning model using the third control parameter; and when the written first control parameter has the predefined first value, performing the categorizing of the one or more reconstructed pixel groups using the extracted one or more features and the modified first machine learning model.
2. The encoding method according to claim 1, further comprising: writing, in the header of the bitstream, a fourth control parameter for controlling whether to use a machine learning model, when the written fourth control parameter has a predefined third value for using a machine learning model: performing the categorizing of the one or more reconstructed pixel groups using the extracted one or more features and the first machine learning model; and performing the encoding process on the current block using the parameter set corresponding to the result of the categorizing; and when the written second control parameter does not have the predefined third value, performing the encoding process on the current block using a predetermined parameter set.
3. The encoding method according to claim 2, further comprising: when the written fourth control parameter does not have the predefined third value: deriving a parameter set from a spatially or temporally neighboring block; and performing the encoding process on the current block using the derived parameter set.
4. The encoding method according to claim 1, wherein at least part of the one or more reconstructed pixel groups is included in a reference block in a reference picture different from the current picture, the parameter set includes a filter coefficient set which is used in an interpolation process to be performed on image pixels in inter prediction, and the encoding process includes the interpolation process.
5. The encoding method according to claim 1, wherein the one or more reconstructed pixel groups are included in the current block, the parameter set includes a filter coefficient set which is used in a filtering process to be performed on the current block, and the encoding process includes the filtering process.
6. The encoding method according to claim 1, wherein the one or more reconstructed pixel groups includes reconstructed pixels spatially neighboring the current block, the parameter set indicates an intra prediction method for use in an intra prediction process, and the encoding process includes the intra prediction process.
7. The encoding method according to claim 1, wherein at least part of the one or more reconstructed pixel groups is included in a plurality of reference blocks in a plurality of reference pictures different from the current picture, the parameter set includes a weighting coefficient set which is used in an averaging process to be performed on a plurality of inter prediction blocks, and the encoding process includes the averaging process.
8. The encoding method according to claim 1, wherein the first machine learning model maps a reconstructed pixel group which is a two-dimensional input space into a multi-dimensional feature space, and associates segment spaces with the one or more features, the segment spaces being obtained by dividing the feature space, and in the categorizing, the segment spaces corresponding to the one or more reconstructed pixel groups are identified.
9. A decoding method, comprising: extracting one or more features from one or more reconstructed pixel groups; parsing, from a header of a bitstream, a first control parameter for controlling which one of a first machine learning model and a second machine learning model is to be used, the second machine learning model being different from the first machine learning model; categorizing the one or more reconstructed pixel groups, wherein (i) when the parsed first control parameter has a predefined first value for using the first machine learning model, the one of more reconstructed pixel groups are categorized using the extracted one or more features and first machine learning model, and (ii) when the written first control parameter does not have the predefined first value, the one of more reconstructed pixel groups are categorized using the extracted one or more features and the second machine learning model; performing a decoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing, the parameter set being one of a plurality of predefined parameter sets; parsing, from the header of the bitstream, a second control parameter for controlling whether to modify the first machine learning model; when the parsed second control parameter does not have a predefined second value for modifying the first machine learning model, performing the categorizing of the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model; when the parsed second control parameter has the predefined second value: parsing, from the header of the bitstream, a third control parameter for modifying the first machine learning model; and modifying the first machine learning model using the third control parameter; and when the parsed first control parameter has the predefined first value, performing the categorizing of the one or more reconstructed pixel groups using the extracted one or more features and the modified first machine learning model.
10. The decoding method according to claim 9, further comprising: parsing, from the header of the bitstream, a fourth control parameter for controlling whether to use a machine learning model; when the parsed fourth control parameter has a predefined third value for using a machine learning model: performing the categorizing of the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model; and performing the decoding process on the current block using the parameter set corresponding to the result of the categorizing; and when the parsed fourth control parameter does not have the predefined third value, performing the decoding process on the current block using a predetermined parameter set.
11. The decoding method according to claim 10, further comprising: when the parsed fourth control parameter does not have the predefined third value: deriving a parameter set from a spatially or temporally neighboring block; and performing the decoding process on the current block using the derived parameter set.
12. The decoding method according to claim 9, wherein at least part of the one or more reconstructed pixel groups is included in a reference block in a reference picture different from the current picture, the parameter set includes a filter coefficient set which is used in an interpolation process to be performed on image pixels in inter prediction, and the decoding process includes the interpolation process.
13. The decoding method according to claim 9, wherein the one or more reconstructed pixel groups are included in the current block, the parameter set includes a filter coefficient set which is used in a filtering process to be performed on the current block, and the decoding process includes the filtering process.
14. The decoding method according to claim 9, wherein the one or more reconstructed pixel groups includes reconstructed pixels spatially neighboring the current block, the parameter set indicates an intra prediction method for use in an intra prediction process, and the decoding process includes the intra prediction process.
15. The decoding method according to claim 9, wherein at least part of the one or more reconstructed pixel groups is included in a plurality of reference blocks in a plurality of reference pictures different from the current picture, the parameter set includes a weighting coefficient set which is used in an averaging process to be performed on a plurality of inter prediction blocks, and the decoding process includes the averaging process.
16. The decoding method according to claim 9, wherein the first machine learning model maps a reconstructed pixel group which is a two-dimensional input space into a multi-dimensional feature space, and associates segment spaces with the one or more features, the segment spaces being obtained by dividing the feature space, and in the categorizing, the segment spaces corresponding to the one or more reconstructed pixel groups are identified.
17. An encoding apparatus, comprising: an extractor which extracts one or more features from one or more reconstructed pixel groups; a writer which writes, in a header of a bitstream, a first control parameter for controlling which one of a first machine learning model and a second machine learning model is to be used, the second machine learning model being different from the first machine learning model; a categorizer which categorizes the one or more reconstructed pixel groups, wherein (i) when the written first control parameter has a predefined first value for using the first machine learning model, the categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the first machine learning model, and (ii) when the written first control parameter does not have the predefined first value, the categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the second machine learning model; an encoder which performs an encoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing, the parameter set being one of a plurality of predefined parameter sets, wherein the writer writes, in the header of the bitstream, a second control parameter for controlling whether to modify the first machine learning model, wherein when the written second control parameter does not have a predefined second value for controlling whether to modify the first machine learning model, the categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model, wherein when the written second control parameter has the predefined second value: the writer writes, in the header of the bitstream, a third control parameter for modifying the first machine learning model; and the categorizer modifies the first machine learning model using the third control parameter, and wherein when the written first control parameter has the predefined first value, the categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and the modified first machine learning model.
18. A decoding apparatus, comprising: an extractor which extracts one or more features from one or more reconstructed pixel groups; a parser which parses, from a header of a bitstream, a first control parameter for controlling which one of a first machine learning model and a second machine learning model is to be used, the second machine learning model being different from the first machine learning model; a categorizer which categorizes the one or more reconstructed pixel groups, wherein (i) when the parsed first control parameter has a predefined first value for using the first machine learning model, the categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the first machine learning model, and (ii) when the parsed first control parameter does not have the predefined first value, the categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the second machine learning model; a decoder which performs a decoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing, the parameter set being one of a plurality of predefined parameter sets, wherein the parser parses, from the header of the bitstream, a second control parameter for controlling whether to modify the first machine learning model, wherein when the parsed second control parameter does not have a predefined second value for modifying the first machine learning model, the categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model, wherein when the parsed second control parameter has the predefined second value: the parser parses, from the header of the bitstream, a third control parameter for modifying the first machine learning model; and the categorizer modifies the first machine learning model using the third control parameter, and wherein when the parsed first control parameter has the predefined first value, the categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and the modified first machine learning model.
19. An encoding and decoding apparatus, comprising: an encoding apparatus including: an extractor which extracts one or more features from one or more reconstructed pixel groups; a writer which writes, in a header of a bitstream, a first control parameter for controlling which one of a first machine learning model and a second machine learning model is to be used, the second machine learning model being different from the first machine learning model; a first categorizer which categorizes the one or more reconstructed pixel groups, wherein (i) when the written first control parameter has a predefined first value for using the first machine learning model, the first categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the first machine learning model, and (ii) when the written first control parameter does not have the predefined first value, the first categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the second machine learning model; and an encoder which performs an encoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing performing by the first categorizer, the parameter set being one of a plurality of predefined parameter sets, wherein the writer writes, in the header of the bitstream, a second control parameter for controlling whether to modify the first machine learning model, wherein when the written second control parameter does not have a predefined second value for controlling whether to modify the first machine learning model, the first categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model, wherein when the written second control parameter has the predefined second value; the writer writes, in the header of the bitstream, a third control parameter for modifying the first machine learning model; and the first categorizer modifies the first machine learning model using the third control parameter, wherein when the written first control parameter has the predefined first value, the first categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and the modified first machine learning model, wherein the encoding and decoding apparatus further comprises a decoding apparatus, including: a parser which parses, from the header of the bitstream, the first control parameter for controlling which one of the first machine learning model and the second machine learning model is to be used, the second machine learning model being different from the first machine learning model; a second categorizer which categorizes the one or more reconstructed pixel groups, wherein (i) when the parsed first control parameter has the predefined first value for using the first machine learning model, the second categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the first machine learning model, and (ii) when the written first control parameter does not have the predefined first value, the second categorizer categorizes the one of more reconstructed pixel groups using the extracted one or more features and the second machine learning model; and a decoder which performs a decoding process on a current block of image samples included in a current picture using a parameter set corresponding to a result of the categorizing performed by the second categorizer, the parameter set being one of a plurality of predefined parameter sets, wherein the parser parses, from the header of the bitstream, the second control parameter for controlling whether to modify the first machine learning model, wherein when the parsed second control parameter does not have the predefined second value for modifying the first machine learning model, the second categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and one of the first machine learning model and the second machine learning model, wherein when the parsed second control parameter has the predefined second value: the parser parses, from the header of the bitstream, the third control parameter for modifying the first machine learning model; and the second categorizer modifies the first machine learning model using the third control parameter, and wherein when the parsed first control parameter has the predefined first value, the second categorizer categorizes the one or more reconstructed pixel groups using the extracted one or more features and the modified first machine learning model.
</claims>
</document>

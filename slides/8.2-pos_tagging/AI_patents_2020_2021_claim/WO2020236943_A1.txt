<document>

<filing_date>
2020-05-20
</filing_date>

<publication_date>
2020-11-26
</publication_date>

<priority_date>
2019-05-22
</priority_date>

<ipc_classes>
G01R33/00,G01R33/02,G06F3/01
</ipc_classes>

<assignee>
FACEBOOK TECH LLC
</assignee>

<inventors>
ZHAO YI
HOGAN MARK DAVID
</inventors>

<docdb_family_id>
73456645
</docdb_family_id>

<title>
SYNCHRONIZATION OF MAGNETIC SENSOR SAMPLING FREQUENCY FOR BODY POSE TRACKING IN ARTIFICIAL REALITY SYSTEMS
</title>

<abstract>
Magnetic sensor synchronization techniques for pose tracking in artificial reality systems include managing and sending, by one or more primary magnetic sensors, a wireless synchronization signal to other magnetic sensors to trigger sensing sampling. The primary magnetic sensor may generate and send sensor data to a wireless data hub that operates as a sensor data collector and transmits data for pose tracking in the system. Each of the other (nonÂ¬ primary) magnetic sensors, in response to receiving the wireless synchronization signal, updates its sampling starting clock based on new synchronization timing. Each of the magnetic sensors sends generated sensor data to its corresponding primary sensor or wireless data hub according to a different schedule to avoid conflicts between the various magnetic sensors. The synchronization process may be repeated a number of times if a sensor fails to receive or respond to a synchronization signal.
</abstract>

<claims>
What is claimed is:
1. A method comprising:
receiving, by a primary magnetic sensor, an indication of a trigger event from an internal system;
in response to receiving the indication, transmitting, by the primary magnetic sensor, a synchronization signal to each of a plurality of magnetic sensors, wherein the synchronization signal includes a sampling start time;
in response to receiving the synchronization signal, determining, by each magnetic sensor of the plurality of magnetic sensors based on the sampling start time, a sampling time for the magnetic sensor;
sampling, by each magnetic sensor of the plurality of magnetic sensors at the sampling time for the magnetic sensor, a magnetic field generated by a magnetic transmitter associated with the plurality of magnetic sensors to generate sensor data of the magnetic sensor;
providing, by each magnetic sensor of the plurality of magnetic sensors, to the primary magnetic sensor, sensor data of the magnetic sensor, wherein the sensor data of the magnetic sensor is transmitted according to a transmission time that is based at least in part on the sampling time and an offset time for the magnetic sensor, wherein the offset times for at least two of the plurality of magnetic sensors are different; and
providing, by the primary magnetic sensor, to a pose detector, the sensor data of each magnetic sensor of the plurality of magnetic sensors.
2. The method of claim 1, wherein the internal system comprises a head mounted device (HMD), and wherein the method further comprises determining a timing for the trigger event based, at least in part, a camera exposure window of one or more cameras of the HMD.
3. The method of claim 1, further comprising:
in response to detecting a packet loss of a packet including the sensor data, retransmitting the sensor data within a frame beginning at a time of the trigger event.
4. The method of claim 1, wherein transmitting the synchronization signal comprises transmitting a Bluetooth connection request that is modified from a Bluetooth standard to include the sampling start time.
5. The method of claim 1, wherein determining the sampling time is based, at least in part, a time that is one half of a sampling frequency.
6. The method of claim 5, wherein the sampling time is further based, at least in part, on a second offset provided by the primary magnetic sensor, the second offset based on an initial calibration of the magnetic sensors.
7. The method of claim 1, further comprising:
updating, by each magnetic sensor of the plurality of magnetic sensors, a local sampling clock of the magnetic sensor in response to receiving the synchronization signal;
wherein in response to the magnetic sensor failing to receive a second synchronization signal, the magnetic sensor determines the sampling time based on the local sampling clock of the magnetic sensor and a default frequency.
8. The method of claim 1, wherein the primary magnetic sensor is a first primary magnetic sensor, the method further comprising:
receiving, by a second primary magnetic sensor, the indication of the trigger event from the internal system;
in response to receiving the indication, transmitting, by the second primary magnetic sensor, a synchronization signal to each of a second plurality of magnetic sensors, wherein the synchronization signal includes a start time;
in response to receiving the synchronization signal, determining, by each second magnetic sensor of the second plurality of magnetic sensors based on the start time, a second sampling time for the second magnetic sensor;
sampling, by each second magnetic sensor of the second plurality of magnetic sensors at the second sampling time for the second magnetic sensor, the magnetic field generated by the magnetic transmitter to generate second sensor data of the second magnetic sensor; providing, by each second magnet sensor of the second plurality of magnetic sensors, to the second primary magnetic sensor, the second sensor data of the second magnetic sensor, wherein the second sensor data of the second magnetic sensor is transmitted according to a second transmission time that is based, at least in part, on the second sampling time and a second offset time for the second magnetic sensor, wherein the second offset times for at least two of the second plurality of magnetic sensors are different; and
providing, by the second primary magnetic sensor, to the pose detector, the second sensor data of each second magnetic sensor of the second plurality of magnetic sensors.
9. The method of claim 1, wherein a magnetic sensor system for an artificial reality system that executes the pose detector comprises the primary magnetic sensor and the plurality of magnetic sensors.
10. The method of claim 1, further comprising:
computing, by the pose detector, a pose of an object based on the sensor data.
11. The method of claim 10, wherein the object is a human body.
12. An artificial reality system comprising:
an image capture device configured to capture image data representative of a physical environment;
a head mounted display (HMD) configured to output artificial reality content;
a magnetic transmitter configured to generate a magnetic field; and
a plurality of magnetic sensors including a primary magnetic sensor and non-primary magnetic sensors, wherein the primary magnetic sensor is configured to:
receive an indication of a trigger event from the HMD, and
in response to receipt of the indication, transmit a synchronization signal to each non-primary magnetic sensor of the non-primary magnetic sensors, wherein the synchronization signal includes a sampling start time;
wherein each non-primary magnetic sensor of the non-primary magnetic sensors is configured to:
in response to receipt of the synchronization signal, determine based on the sampling start time, a sampling time for the non-primary magnetic sensor,
sample, at the sampling time for the non-primary magnetic sensor, a magnetic field generated by the magnetic transmitter to generate sensor data of the magnetic sensor, and
provide, to the primary magnetic sensor, sensor data of the non-primary magnetic sensor, wherein the sensor data of the non-primary magnetic sensor is transmitted according to a transmission time that is based at least in part on the sampling time and an offset time for the non-primary magnetic sensor, wherein the offset times for at least two of the non-primary magnetic sensors are different;
wherein the primary magnetic sensor is further configured to provide, to a pose detector of the artificial reality system, sensor data of the primary magnetic sensor and the sensor data of each non-primary magnetic sensor of the plurality of magnetic sensors, wherein the pose detector is configured to determine a pose for an object based, at least in part on the image data, the sensor data of each non-primary magnetic sensor of the plurality of magnetic sensors, and sensor data of the primary magnetic sensor.
13. The artificial reality system of claim 12, wherein the HMD is further configured to determine a timing for the trigger event based, at least in part, a camera exposure window of the image capture device.
14. The artificial reality system of claim 12, wherein the synchronization signal comprises a Bluetooth connection request that is modified from a Bluetooth standard to include the sampling start time.
15. The artificial reality system of claim 12, wherein each non-primary magnetic sensor is further configured to update a local sampling clock of the magnetic sensor in response to receiving the synchronization signal;
wherein in response to a failure to receive a second synchronization signal, the non primary magnetic sensor determines the sampling time based on the local sampling clock of the magnetic sensor and a default frequency.
16. The artificial reality system of claim 12, wherein the primary magnetic sensor is a first primary magnetic sensor, the system further comprising:
a second plurality of magnetic sensors including a second primary magnetic sensor and second non-primary magnetic sensors, wherein the second primary magnetic sensor is configured to:
receive the indication of the trigger event from the HMD;
in response to receipt of the indication, transmit a synchronization signal to each of second non-primary magnetic sensor of the second non-primary magnetic sensors, wherein the synchronization signal includes a start time;
wherein each second non-primary magnetic sensor of the second non-primary magnetic sensors is configured to:
in response to receipt of the synchronization signal, based on the start time, a second sampling time for the second non-primary magnetic sensor,
sample, at the second sampling time for the second non-primary magnetic sensor, the magnetic field generated by the magnetic transmitter to generate second sensor data of the second non-primary magnetic sensor, and provide, to the second primary magnetic sensor, the second sensor data of the second non-primary magnetic sensor, wherein the second sensor data of the second non primary magnetic sensor is transmitted according to a second transmission time that is based, at least in part, on the second sampling time and a second offset time for the second non-primary magnetic sensor, wherein the second offset times for at least two of the second non-primary magnetic sensors are different; and
wherein the second primary magnetic sensor is further configured to provide, to the pose detector of the artificial reality system, sensor data of the second primary magnetic sensor and the sensor data of each second non-primary magnetic sensor of the second magnetic sensors, wherein the pose detector is further configured to determine the pose for the object based, at least in part on the sensor data of each second non-primary magnetic sensor of the second magnetic sensors, and sensor data of the second primary magnetic sensor.
17. A magnetic sensor system comprising:
a magnetic transmitter configured to generate a magnetic field; and
a plurality of magnetic sensors including a primary magnetic sensor and non-primary magnetic sensors, wherein the primary magnetic sensor is configured to:
receive an indication of a trigger event from a trigger source, and in response to receipt of the indication, transmit a synchronization signal to each non-primary magnetic sensor of the non-primary magnetic sensors, wherein the synchronization signal includes a sampling start time;
wherein each non-primary magnetic sensor of the non-primary magnetic sensors is configured to:
in response to receipt of the synchronization signal, determine based on the sampling start time, a sampling time for the non-primary magnetic sensor,
sample, at the sampling time for the non-primary magnetic sensor, a magnetic field generated by the magnetic transmitter to generate sensor data of the magnetic sensor,
provide, to the primary magnetic sensor, sensor data of the non-primary magnetic sensor, wherein the sensor data of the non-primary magnetic sensor is transmitted according to a transmission time that is based at least in part on the sampling time and an offset time for the non-primary magnetic sensor, wherein the offset times for at least two of the non-primary magnetic sensors are different; and
wherein the primary magnetic sensor is further configured to provide, as output of the magnetic sensor system, sensor data of the primary magnetic sensor and the sensor data of each non-primary magnetic sensor of the plurality of magnetic sensors.
18. The magnetic sensor system of claim 17, wherein the synchronization signal comprises a Bluetooth connection request that is modified from a Bluetooth standard to include the sampling start time.
19. The magnetic sensor system of claim 17, further comprising:
a second plurality of magnetic sensors;
a data hub configured to: receive the indication of the trigger event from the trigger source;
in response to receipt of the indication, transmit a synchronization signal to each second magnetic sensor of the second plurality of magnetic sensors, wherein the synchronization signal includes a start time;
wherein each second magnetic sensor of the second plurality of magnetic sensors is configured to:
in response to receipt of the synchronization signal, based on the start time, a second sampling time for the second magnetic sensor,
sample, at the second sampling time for the second magnetic sensor, the magnetic field generated by the magnetic transmitter to generate second sensor data of the second magnetic sensor, and
provide, to the data hub, the second sensor data of the second magnetic sensor, wherein the second sensor data of the second magnetic sensor is transmitted according to a second transmission time that is based, at least in part, on the second sampling time and a second offset time for the second magnetic sensor, wherein the second offset times for at least two of the second magnetic sensors are different; and
wherein the data hub is further configured to provide, as the output of the magnetic sensor system, the sensor data of each second magnetic sensor of the second magnetic sensors,
20. The magnetic sensor system of claim 19, wherein the second plurality of magnetic sensors includes a second primary magnetic sensor, and
wherein the data hub comprises the second primary magnetic sensor.
</claims>
</document>

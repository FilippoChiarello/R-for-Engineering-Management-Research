<document>

<filing_date>
2020-07-01
</filing_date>

<publication_date>
2021-01-07
</publication_date>

<priority_date>
2019-07-02
</priority_date>

<ipc_classes>
G06N3/04,G06N3/08
</ipc_classes>

<assignee>
CANON
</assignee>

<inventors>
CHEN, TSEWEI
TATE, SHUNTA
</inventors>

<docdb_family_id>
74065752
</docdb_family_id>

<title>
DATA PROCESSING APPARATUS, TRAINING APPARATUS, METHOD OF DETECTING AN OBJECT, METHOD OF TRAINING, AND MEDIUM
</title>

<abstract>
There is provided with a data processing apparatus for detecting an object from an image using a hierarchical neural network. The data processing apparatus has parallel first and second neural networks. An obtaining unit obtains a table which defines different first and second portions. An operation unit performs calculation of the feature data of a third portion based on feature data of the first portion identified using the table and on a weighting parameter between first and second layers of the first neural network, and calculation of feature data of a fourth portion based on feature data of the second portion identified using the table and on a weighting parameter between the first and second layers of the second neural network.
</abstract>

<claims>
1. A data processing apparatus for detecting an object from an image using a hierarchical neural network, comprising: parallel first and second neural networks; an obtaining unit configured to obtain a table which defines different first and second portions, wherein the first portion comprises both a part of channels of a first layer of the first neural network and a part of channels of a first layer of the second neural network, both of the parts of channels being referenced in order to calculate feature data of a third portion of a second layer of the first neural network, and wherein the second portion comprises a part of channels of the first layer of the first neural network and a part of channels of a first layer of the second neural network, both of the parts of channels being referenced in order to calculate feature data of a fourth portion of a second layer of the second neural network; and an operation unit configured to perform calculation of the feature data of the third portion based on feature data of the first portion identified using the table and on a weighting parameter between the first and second layers of the first neural network, and calculation of the feature data of the fourth portion based on feature data of the second portion identified using the table and on a weighting parameter between the first and second layers of the second neural network.
2. The data processing apparatus according to claim 1, wherein the first portion and the second portion of the first layer do not overlap.
3. The data processing apparatus according to claim 1, wherein the first portion and the second portion of the first layer partially overlap.
4. The data processing apparatus according to claim 1, wherein a size of the third portion of the second layer is different from a size of the fourth portion of the second layer.
5. The data processing apparatus according to claim 1, further comprising an instruction unit configured to instruct an object type, wherein the obtaining unit is further configured to obtain the table corresponding to the instructed object type.
6. The data processing apparatus according to claim 1, wherein the operation unit comprises a first processing unit and a second processing unit which operate in parallel, the first processing unit is configured to calculate the feature data of the third portion of the second layer from the feature data of the first portion of the first layer, and the second processing unit is configured to calculate feature data of the fourth portion of the second layer from the feature data of the second portion of the first layer.
7. The data processing apparatus according to claim 1, wherein a connection parameter is stored in the table, and the connection parameter defines the first portion and the second portion of the first layer in units of channels.
8. The data processing apparatus according to claim 7, wherein the connection parameter defines the first portion and the second portion of the first layer in units of blocks that each includes a plurality of channels.
9. The data processing apparatus according to claim 7, wherein the operation unit is further configured to calculate the feature data of each channel included in the third portion of the second layer using the feature data of all channels included in the first portion of the first layer and without using the feature data of the channels included in the second portion of the first layer.
10. The data processing apparatus according to claim 1, wherein the neural network is a convolutional neural network or a recursive neural network.
11. A training apparatus operable to perform training of a hierarchical neural network, the apparatus comprising: an obtaining unit configured to obtain training data and supervisory data indicating processing results for the training data; a data processing unit configured to obtain a result of processing the training data by inputting the training data to the neural network, the data processing unit comprising an operation unit configured to, in accordance with a connection parameter defining a first portion of a first layer of the neural network to be referenced in order to calculate feature data of a third portion of a second layer of the neural network and defining a second portion of the first layer to be referenced in order to calculate feature data of a fourth portion of the second layer, calculate the feature data of the third portion of the second layer from feature data of the first portion of the first layer and calculate the feature data of the fourth portion of the second layer from feature data of the second portion of the first layer; and a training unit configured to perform training of the connection parameter and weighting coefficients between layers of the neural network based on a result of processing the training data, and the supervisory data.
12. The training apparatus according to claim 10, wherein the training unit is further configured to perform training of the connection parameter based on both a result of processing the training data that the data processing unit obtained according to a first connection parameter and a result of processing the training data that the data processing unit obtained according to a second connection parameter.
13. The training apparatus according to claim 10, wherein the training unit is further configured to determine sizes of the first portion and the second portion of the second layer by training.
14. The training apparatus according to claim 10, wherein the obtaining unit is further configured to acquire a user input indicating a constraint condition on the connection parameter obtained by training, and the training unit is further configured to perform training of the connection parameter according to the constraint condition.
15. A method of detecting an object from an image using a hierarchical neural network including parallel first and second neural networks, comprising: obtaining a table which defines different first and second portions, wherein the first portion comprises both a part of channels of a first layer of the first neural network and a part of channels of a first layer of the second neural network, both of the parts of channels being referenced in order to calculate feature data of a third portion of a second layer of the first neural network, and wherein the second portion comprises both a part of channels of the first layer of the first neural network and a part of channels of a first layer of the second neural network, both of the parts of channels being referenced in order to calculate feature data of a fourth portion of a second layer of the second neural network; and performing calculation of the feature data of the third portion based on feature data of the first portion identified using the table and on a weighting parameter between the first and second layers of the first neural network, and calculation of the feature data of the fourth portion based on feature data of the second portion identified using the table and on a weighting parameter between the first and second layers of the second neural network.
16. A method of training hierarchical neural network, the method comprising: obtaining training data and supervisory data indicating processing results for the training data; obtaining a result of processing the training data by inputting the training data to the neural network, comprising, in accordance with a connection parameter defining a first portion of a first layer of the neural network to be referenced in order to calculate feature data of a third portion of a second layer of the neural network and defining a second portion of the first layer to be referenced in order to calculate feature data of a fourth portion of the second layer, calculating the feature data of the third portion of the second layer from feature data of the first portion of the first layer and calculating the feature data of the fourth portion of the second layer from feature data of the second portion of the first layer; and performing training of the connection parameter and weighting coefficients between layers of the neural network based on a result of processing the training data, and the supervisory data.
17. A non-transitory computer-readable medium storing a program which, when executed by a computer comprising a processor and a memory, causes the computer to perform a method of detecting an object from an image using a hierarchical neural network including parallel first and second neural networks comprising: obtaining a table which defines different first and second portions, wherein the first portion comprises both a part of channels of a first layer of the first neural network and a part of channels of a first layer of the second neural network, both of the parts of channels being referenced in order to calculate feature data of a third portion of a second layer of the first neural network, and wherein the second portion comprises both a part of channels of the first layer of the first neural network and a part of channels of a first layer of the second neural network, both of the parts of channels being referenced in order to calculate feature data of a fourth portion of a second layer of the second neural network; and performing calculation of the feature data of the third portion based on feature data of the first portion identified using the table and on a weighting parameter between the first and second layers of the first neural network, and calculation of the feature data of the fourth portion based on feature data of the second portion identified using the table and on a weighting parameter between the first and second layers of the second neural network.
18. A non-transitory computer-readable medium storing a program which, when executed by a computer comprising a processor and a memory, causes the computer to perform: obtaining training data and supervisory data indicating processing results for the training data; obtaining a result of processing the training data by inputting the training data to the neural network, comprising, in accordance with a connection parameter defining a first portion of a first layer of the neural network to be referenced in order to calculate feature data of a third portion of a second layer of the neural network and defining a second portion of the first layer to be referenced in order to calculate feature data of a fourth portion of the second layer, calculating the feature data of the third portion of the second layer from feature data of the first portion of the first layer and calculating the feature data of the fourth portion of the second layer from feature data of the second portion of the first layer; and performing training of the connection parameter and weighting coefficients between layers of the neural network based on a result of processing the training data, and the supervisory data.
</claims>
</document>

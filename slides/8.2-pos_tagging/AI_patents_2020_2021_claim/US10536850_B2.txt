<document>

<filing_date>
2013-07-18
</filing_date>

<publication_date>
2020-01-14
</publication_date>

<priority_date>
2013-07-18
</priority_date>

<ipc_classes>
H04L29/00,H04L29/06,H04W12/02,H04W12/06
</ipc_classes>

<assignee>
FORTINET
</assignee>

<inventors>
WU, JIANFENG
</inventors>

<docdb_family_id>
52344723
</docdb_family_id>

<title>
Remote wireless adapter
</title>

<abstract>
Systems and methods are described for connecting a private network to the Internet through a remote wireless adapter. According to one embodiment, a remote wireless adapter sets up a tunnel with a network security device through a local area network (LAN) adapter of the remote wireless adapter and sets up a wide area network (WAN) connection through a wireless modem which is connected to the wireless adapter. The remote wireless adapter receives an outgoing data packet sent by the network security device through the tunnel and writes the outgoing data packet to the WAN connection. The remote wireless adapter also receives an incoming data packet through the WAN connection and forwards the incoming data packet to the network security device through the tunnel.
</abstract>

<claims>
1. A method comprising: facilitating independence between a physical location of a remote wireless adapter associated with a private network and a physical location of a network security device associated with the private network by implementing within the remote wireless adapter a Dynamic Host Configuration Protocol (DHCP) client; sending, by the DHCP client, a DHCP request to a DHCP server implemented within the network security device; receiving, by DHCP client, DHCP configuration parameters, including a private Internet Protocol (IP) address assigned to the remote wireless adapter by the network security device; and configuring a local area network (LAN) adapter of the remote wireless adapter based on the DHCP configuration parameters; setting up a tunnel between the remote wireless adapter and the network security device; setting up a wide area network (WAN) connection, by the remote wireless adapter, through a wireless modem associated with the remote wireless adapter; receiving, by the remote wireless adapter, via the tunnel an outgoing data packet sent by the network security device; writing, by the remote wireless adapter, the outgoing data packet to the WAN connection; receiving, by the remote wireless adapter, an incoming data packet through the WAN connection; and forwarding, by the remote wireless adapter, the incoming data packet to the network security device through the tunnel.
2. The method of claim 1, wherein the tunnel comprises a Control And Provisioning of Wireless Access Points (CAPWAP) communication tunnel.
3. The method of claim 1, further comprising: decrypting the outgoing data packet before writing the outgoing data packet to the WAN connection based on an algorithm negotiated with the network security device; and encrypting the incoming data packet before forwarding the incoming data packet to the tunnel based on the algorithm negotiated with the network security device.
4. The method of claim 1, further comprising: receiving, by the remote wireless adapter, a control command from the network security device through the tunnel; and controlling the wireless modem according the control command.
5. The method of claim 1, wherein said setting up WAN connection further comprises: detecting that a Universal Serial Bus (USB) wireless modem is inserted into a USB port of the remote wireless adapter; switching the USB wireless modem to USB modem mode; dialing up through the USB wireless modem to setup the WAN connection.
6. The method of claim 2, further comprising: sending, by the remote wireless adapter, a CAPWAP discovery request to the network security device; receiving, by the remote wireless adapter, a CAPWAP discovery response from the network security device; sending, by the remote wireless adapter, a CAPWAP authentication request to the network security device; receiving, by the remote wireless adapter, a CAPWAP authentication response from the network security device; sending, by the remote wireless adapter, a CAPWAP join request to the network security device; receiving, by the remote wireless adapter, a CAPWAP join response from the network security device; exchanging, by the remote wireless adapter, configuration information with the network security device; and configuring the remote wireless adapter and the wireless modem based on configuration information received from the network security device.
7. A method, comprising: facilitating independence between a physical location of a remote wireless adapter associated with a private network and a physical location of a network security device associated with the private network by implementing within the network security device a Dynamic Host Configuration Protocol (DHCP) server; receiving, by the DHCP server, a DHCP request from a DHCP client implemented within the remote wireless adapter; and causing, by the DHCP server, the remote wireless adapter to configure a local area network (LAN) adapter of the remote wireless adapter by sending to the DHCP client DHCP configuration parameters, including a private Internet Protocol (IP) address assigned to the remote wireless adapter by the network security device; and setting up a tunnel between the network security device and the remote wireless adapter, wherein the remote wireless adapter is connected to a cellular network through a wireless modem; receiving, by the network security device, an outgoing data packet from a local network appliance; forwarding, by the network security device, the outgoing data packet to the remote wireless adapter through the tunnel; receiving, by the network security device, an incoming data packet through the tunnel; and routing, by the network security device, the incoming data packet to a local area network (LAN) interface based on a routing lookup.
8. The method of claim 7, wherein the tunnel comprises a Control And Provisioning of Wireless Access Points (CAPWAP) communication tunnel.
9. The method of claim 7, further comprising: receiving, by the network security device, a public IP address of the remote wireless adapter; and setting up a virtual WAN interface, by the network security device using the public IP address of the remote wireless adapter.
10. The method of claim 7, further comprising: encrypting the outgoing data packet before forwarding the outgoing data packet to the tunnel based on an algorithm negotiated with the remote wireless adapter; and decrypting the incoming data packet before routing the incoming data packet to the LAN adapter based on an algorithm negotiated with the remote wireless adapter.
11. The method of claim 7, further comprising: sending, by the network security device, a control command to the remote wireless adapter through the tunnel; and receiving, by the network security device, state information of the remote wireless adapter through the tunnel.
12. The method of claim 8, further comprising: receiving, by the network security device, a CAPWAP discovery request from the remote wireless adapter; sending, by the network security device, a CAPWAP discovery response to the remote wireless adapter; receiving, by the network security device, a CAPWAP authentication request from the remote wireless adapter; sending, by the network security device, a CAPWAP authentication response to the remote wireless adapter; receiving, by the network security device, a CAPWAP join request from the remote wireless adapter; sending, by the network security device, a CAPWAP join response to the remote wireless adapter; exchanging, by the network security device, configuration information with the remote wireless adapter.
13. The method of claim 9, further comprising: writing, by the network security device, the outgoing data packet from the local network appliance to the virtual WAN interface; and sending, by the network security device, the outgoing data packet via the tunnel to the remote wireless adapter.
14. The method of claim 9, further comprising: writing, by the network security device, the incoming data packet received from the tunnel to the virtual WAN interface; and sending, by the network security device, the incoming data packet to the LAN interface according to the routing lookup.
15. A system comprising: a non-transitory storage device having embodied therein one or more routines implementing a remote wireless adapter and a Dynamic Host Configuration Protocol (DHCP) client; and one or more processors coupled to the non-transitory storage device and operable to execute the one or more routines to perform a method comprising: facilitating independence between a physical location of the system within a private network and a physical location of a network security device associated with the private network by configuring the remote wireless adapter based on DHCP configuration parameters provided by the network security device, including: sending, by the DHCP client, a DHCP request to a DHCP server implemented within the network security device; receiving, by DHCP client, the DHCP configuration parameters, including a private Internet Protocol (IP) address assigned to the remote wireless adapter by the network security device; and configuring a local area network (LAN) adapter of the remote wireless adapter based on the DHCP configuration parameters; setting up a tunnel between the remote wireless adapter and the network security device; setting up a wide area network (WAN) connection, by the remote wireless adapter, through a wireless modem which is connected to the remote wireless adapter; receiving, by the remote wireless adapter, an outgoing data packet sent by the network security device through the tunnel; writing, by the remote wireless adapter, the outgoing data packet to the WAN connection; receiving, by the remote wireless adapter, an incoming data packet through the WAN connection; and forwarding, by the remote wireless adapter, the incoming data packet to the network security device through the tunnel.
16. The system of claim 15, wherein the tunnel comprises a Control And Provisioning of Wireless Access Points (CAPWAP) communication tunnel.
17. The system of claim 15, wherein the method further comprises: decrypting the outgoing data packet before writing the outgoing data packet to the WAN connection based on an algorithm negotiated with the network security device; and encrypting the incoming data packet before forwarding the incoming data packet to the tunnel based on the algorithm negotiated with the network security device.
18. The system of claim 15, wherein the method further comprises: receiving, by the remote wireless adapter, a control command from the network security device through the tunnel; and controlling the wireless modem according the control command.
19. The system of claim 15, wherein said setting up a WAN connection further comprises: detecting that a Universal Serial Bus (USB) wireless modem is inserted into a USB port of the remote wireless adapter; switching the USB wireless modem to USB modem mode; dialing up through the USB wireless modem to setup the WAN connection.
20. The system of claim 16, wherein the method further comprises: sending, by the remote wireless adapter, a CAPWAP discovery request to the network security device; receiving, by the remote wireless adapter, a CAPWAP discovery response from the network security device; sending, by the remote wireless adapter, a CAPWAP authentication request to the network security device; receiving, by the remote wireless adapter, a CAPWAP authentication response from the network security device; sending, by the remote wireless adapter, a CAPWAP join request to the network security device; receiving, by the remote wireless adapter, a CAPWAP join response from the network security device; exchanging, by the remote wireless adapter, configuration information with the network security device; and configuring the remote wireless adapter and the wireless modem based on configuration information received from the network security device.
21. A system comprising: a non-transitory storage device having embodied therein one or more routines implementing a network security device and a Dynamic Host Configuration Protocol (DHCP) server; and one or more processors coupled to the non-transitory storage device and operable to execute the one or more routines to perform a method comprising: facilitating independence between a physical location of the system within a private network and a physical location of a remote wireless adapter associated with the private network by causing the remote wireless adapter to be configured based on DHCP configuration parameters provided by the network security device, including: receiving, by the DHCP server, a DHCP request from a DHCP client implemented within the remote wireless adapter; and causing, by the DHCP server, the remote wireless adapter to configure a local area network (LAN) adapter of the remote wireless adapter by sending to the DHCP client DHCP configuration parameters, including a private Internet Protocol (IP) address assigned to the remote wireless adapter by the network security device; and setting up a tunnel between the network security device and the remote wireless adapter, wherein the remote wireless adapter is connected to a cellular network through a wireless modem; receiving, by the network security device, an outgoing data packet from a local network appliance; forwarding, by the network security device, the outgoing data packet to the remote wireless adapter through the tunnel; receiving, by the network security device, an incoming data packet through the tunnel; and routing, by the network security device, the incoming data packet to a local area network (LAN) interface based on its routing lookup.
22. The system of claim 21, wherein the tunnel comprises a Control And Provisioning of Wireless Access Points (CAPWAP) communication tunnel.
23. The system of claim 21, wherein the method further comprises: receiving, by the network security device, a public IP address of the remote wireless adapter; and setting up a virtual WAN interface, by the network security device using the public IP address of the remote wireless adapter.
24. The system of claim 21, wherein the method further comprises: encrypting the outgoing data packet before forwarding the outgoing data packet to the tunnel based on an algorithm negotiated with the remote wireless adapter; and decrypting the incoming data packet before routing the incoming data packet to the LAN adapter based on an algorithm negotiated with the remote wireless adapter.
25. The system of claim 21, wherein the method further comprises: sending, by the network security device, a control command to the remote wireless adapter through the tunnel; and receiving, by the network security device, state information of the remote wireless adapter through the tunnel.
26. The system of claim 22, wherein the method further comprises: receiving, by the network security device, a CAPWAP discovery request from the remote wireless adapter; sending, by the network security device, a CAPWAP discovery response to the remote wireless adapter; receiving, by the network security device, a CAPWAP authentication request from the remote wireless adapter; sending, by the network security device, a CAPWAP authentication response to the remote wireless adapter; receiving, by the network security device, a CAPWAP join request from the remote wireless adapter; sending, by the network security device, a CAPWAP join response to the remote wireless adapter; exchanging, by the network security device, configuration information with the remote wireless adapter.
27. The system of claim 23, wherein the method further comprises: writing, by the network security device, the outgoing data packet from the local network appliance to the virtual WAN interface; and sending, by the network security device, the outgoing data packet via the tunnel to the remote wireless adapter.
28. The system of claim 23, wherein the method further comprises: writing, by the network security device, the incoming data packet received from the tunnel to the virtual WAN interface; and sending, by the network security device, the incoming data packet to the LAN interface according to the routing lookup.
</claims>
</document>

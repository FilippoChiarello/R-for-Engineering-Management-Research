<document>

<filing_date>
2018-12-28
</filing_date>

<publication_date>
2021-01-12
</publication_date>

<priority_date>
2018-04-23
</priority_date>

<ipc_classes>
G10L19/02,G10L21/02,G10L21/0216,G10L21/0224,G10L21/0232
</ipc_classes>

<assignee>
BAIDU ON-LINE NETWORK TECHNOLOGY (BEIJING) COMPANY
</assignee>

<inventors>
LI CHAO
SUN, JIANWEI
</inventors>

<docdb_family_id>
63536046
</docdb_family_id>

<title>
Method and apparatus for enhancing speech
</title>

<abstract>
A method and an apparatus for enhancing speech are provided. The method includes: obtaining time domain speech of multiple channels acquired by a microphone array; generating frequency domain speech of at least one channel based on the time domain speech of the multiple channels; analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel; enhancing the frequency domain speech of the at least one channel by using the normalized enhancement coefficient of the frequency domain speech of the at least one channel to obtain enhanced frequency domain speech of the at least one channel; and performing an inverse Fourier transform on the enhanced frequency domain speech of the at least one channel to obtain enhanced time domain speech of the at least one channel.
</abstract>

<claims>
1. A method for enhancing speech, the method comprising: obtaining time domain speech of a plurality of channels acquired by a microphone array; generating frequency domain speech of at least one channel based on the time domain speech of the plurality of channels; analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel; enhancing the frequency domain speech of the at least one channel by using the normalized enhancement coefficient of the frequency domain speech of the at least one channel to obtain enhanced frequency domain speech of the at least one channel; and performing an inverse Fourier transform on the enhanced frequency domain speech of the at least one channel to obtain enhanced time domain speech of the at least one channel, wherein the analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel comprises: performing masking threshold estimation on the frequency domain speech of the at least one channel to obtain a masking threshold of the frequency domain speech of the at least one channel; analyzing the masking threshold of the frequency domain speech of the at least one channel to generate a power spectral density matrix of signals and noise in the frequency domain speech of the at least one channel; minimizing a signal-to-noise ratio of output speech corresponding to the time domain speech of the plurality of channels by using the power spectral density matrix of signals and noise in the frequency domain speech of the at least one channel to obtain an enhancement coefficient of the frequency domain speech of the at least one channel; and normalizing the enhancement coefficient of the frequency domain speech of the at least one channel to obtain the normalized enhancement coefficient of the frequency domain speech of the at least one channel.
2. The method according to claim 1, wherein the generating frequency domain speech of at least one channel based on the time domain speech of the plurality of channels comprises: wave-filtering the time domain speech of the plurality of channels to obtain time domain speech of at least one channel; and performing a Fourier transform on the time domain speech of the at least one channel to obtain the frequency domain speech of the at least one channel.
3. The method according to claim 2, wherein the wave-filtering the time domain speech of the plurality of channels to obtain time domain speech of at least one channel comprises: calculating a sum of distances between a channel in the plurality of channels and other channels; and wave-filtering the time domain speech of the plurality of channels based on the calculated sum to obtain the time domain speech of the at least one channel.
4. The method according to claim 2, wherein the performing a Fourier transform on the time domain speech of the at least one channel to obtain the frequency domain speech of the at least one channel comprises: performing windowing and framing processing on the time domain speech of the channel, for time domain speech of each channel in the time domain speech of the at least one channel, to obtain a multi-frame time domain speech segment of the time domain speech of the channel, and performing a short-time Fourier transform on the multi-frame time domain speech segment of the time domain speech of the channel to obtain the frequency domain speech of the at least one channel.
5. The method according to claim 1, wherein the performing masking threshold estimation on the frequency domain speech of the at least one channel to obtain a masking threshold of the frequency domain speech of the at least one channel comprises: inputting sequentially the frequency domain speech of the at least one channel into a pre-trained masking threshold estimation model to obtain the masking threshold of the frequency domain speech of the at least one channel, the masking threshold estimation model being used for estimating the masking threshold of the frequency domain speech.
6. The method according to claim 5, wherein the masking threshold estimation model comprises two one-dimensional convolution layers, two gated recurrent units, and one full-connect layer.
7. The method according to claim 5, wherein the masking threshold estimation model is trained and obtained by: obtaining a training sample set, wherein a training sample comprises sample frequency domain speech and a masking threshold of the sample frequency domain speech; and using the sample frequency domain speech in the training sample set as an input, and using the masking threshold of the input sample frequency domain speech as an output to train and obtain the masking threshold estimation model.
8. An apparatus for enhancing speech, the apparatus comprising: at least one processor; and a memory storing instructions, wherein the instructions when executed by the at least one processor, cause the at least one processor to perform operations, the operations comprising: obtaining time domain speech of a plurality of channels acquired by a microphone array; generating frequency domain speech of at least one channel based on the time domain speech of the plurality of channels; analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel; enhancing the frequency domain speech of the at least one channel by using the normalized enhancement coefficient of the frequency domain speech of the at least one channel to obtain enhanced frequency domain speech of the at least one channel; and performing an inverse Fourier transform on the enhanced frequency domain speech of the at least one channel to obtain enhanced time domain speech of the at least one channel, wherein the analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel comprises: performing masking threshold estimation on the frequency domain speech of the at least one channel to obtain a masking threshold of the frequency domain speech of the at least one channel; analyzing the masking threshold of the frequency domain speech of the at least one channel to generate a power spectral density matrix of signals and noise in the frequency domain speech of the at least one channel; minimizing a signal-to-noise ratio of output speech corresponding to the time domain speech of the plurality of channels by using the power spectral density matrix of signals and noise in the frequency domain speech of the at least one channel to obtain an enhancement coefficient of the frequency domain speech of the at least one channel; and normalizing the enhancement coefficient of the frequency domain speech of the at least one channel to obtain the normalized enhancement coefficient of the frequency domain speech of the at least one channel.
9. The apparatus according to claim 8, wherein the generating frequency domain speech of at least one channel based on the time domain speech of the plurality of channels comprises: wave-filtering the time domain speech of the plurality of channels to obtain time domain speech of at least one channel; and performing a Fourier transform on the time domain speech of the at least one channel to obtain the frequency domain speech of the at least one channel.
10. The apparatus according to claim 9, wherein the wave-filtering the time domain speech of the plurality of channels to obtain time domain speech of at least one channel comprises: calculating a sum of distances between a channel in the plurality of channels and other channels; and wave-filtering the time domain speech of the plurality of channels based on the calculated sum to obtain the time domain speech of the at least one channel.
11. The apparatus according to claim 9, wherein the performing a Fourier transform on the time domain speech of the at least one channel to obtain the frequency domain speech of the at least one channel comprises: perform windowing and framing processing on the time domain speech of the channel, for time domain speech of each channel in the time domain speech of the at least one channel, to obtain a multi-frame time domain speech segment of the time domain speech of the channel, and perform a short-time Fourier transform on the multi-frame time domain speech segment of the time domain speech of the channel to obtain the frequency domain speech of the at least one channel.
12. The apparatus according to claim 8, wherein the performing masking threshold estimation on the frequency domain speech of the at least one channel to obtain a masking threshold of the frequency domain speech of the at least one channel comprises: inputting sequentially the frequency domain speech of the at least one channel into a pre-trained masking threshold estimation model to obtain the masking threshold of the frequency domain speech of the at least one channel, the masking threshold estimation model being used for estimating the masking threshold of the frequency domain speech.
13. The apparatus according to claim 12, wherein the masking threshold estimation model comprises two one-dimensional convolution layers, two gated recurrent units, and one full-connect layer.
14. The apparatus according to claim 12, wherein the masking threshold estimation model is trained and obtained by: obtaining a training sample set, wherein a training sample comprises sample frequency domain speech and a masking threshold of the sample frequency domain speech; and using the sample frequency domain speech in the training sample set as an input, and using the masking thresholds of the input sample frequency domain speech as an output to train and obtain the masking threshold estimation model.
15. A non-transitory computer medium, storing a computer program thereon, the program, when executed by a processor, causes the processor to perform operations, the operations comprising: obtaining time domain speech of a plurality of channels acquired by a microphone array; generating frequency domain speech of at least one channel based on the time domain speech of the plurality of channels; analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel; enhancing the frequency domain speech of the at least one channel by using the normalized enhancement coefficient of the frequency domain speech of the at least one channel to obtain enhanced frequency domain speech of the at least one channel; and performing an inverse Fourier transform on the enhanced frequency domain speech of the at least one channel to obtain enhanced time domain speech of the at least one channel, wherein the analyzing the frequency domain speech of the at least one channel to obtain a normalized enhancement coefficient of the frequency domain speech of the at least one channel comprises: performing masking threshold estimation on the frequency domain speech of the at least one channel to obtain a masking threshold of the frequency domain speech of the at least one channel; analyzing the masking threshold of the frequency domain speech of the at least one channel to generate a power spectral density matrix of signals and noise in the frequency domain speech of the at least one channel; minimizing a signal-to-noise ratio of output speech corresponding to the time domain speech of the plurality of channels by using the power spectral density matrix of signals and noise in the frequency domain speech of the at least one channel to obtain an enhancement coefficient of the frequency domain speech of the at least one channel; and normalizing the enhancement coefficient of the frequency domain speech of the at least one channel to obtain the normalized enhancement coefficient of the frequency domain speech of the at least one channel.
</claims>
</document>

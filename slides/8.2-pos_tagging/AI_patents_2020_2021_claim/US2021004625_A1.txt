<document>

<filing_date>
2020-09-18
</filing_date>

<publication_date>
2021-01-07
</publication_date>

<priority_date>
2018-08-03
</priority_date>

<ipc_classes>
G06K9/32,G06K9/46,G06K9/62,G06T7/11
</ipc_classes>

<assignee>
HUAWEI TECHNOLOGIES COMPANY
</assignee>

<inventors>
JIN XIN
TU, DANDAN
ZHANG, CHANGZHENG
</inventors>

<docdb_family_id>
69425670
</docdb_family_id>

<title>
Object Detection Model Training Method, Apparatus, and Device
</title>

<abstract>
In an object detection model training method, a classifier that has been trained in a first phase is duplicated to at least two copies, and in a training in a second phase, each classifier obtained through duplication is configured to detect to-be-detected objects with different sizes, and train an object detection model based on a detection result.
</abstract>

<claims>
1. An object detection model training method, performed by a computing device, wherein the object detection model training method comprises: obtaining a training image; establishing a backbone network based on the training image; obtaining a plurality of feature maps from the backbone network; inputting the feature maps into a region proposal network; selecting, by the region proposal network based on a region proposal parameter, a plurality of proposal regions from the feature maps ; inputting feature submaps corresponding to the proposal regions into a classifier; detecting, by the classifier, a to-be-detected object in the training image to obtain a detection result based on the feature submaps; comparing the detection result with a prior result of the training image; exciting at least one of a first model parameter of a convolution kernel of the backbone network, a second model parameter of a convolution kernel of the region proposal network, the region proposal parameter, or a parameter of the classifier based on the comparing; duplicating the classifier to obtain at least two classifiers; classifying, by the region proposal network, the proposal regions into at least two proposal region sets, wherein each of the at least two proposal region sets comprises at least one proposal region; inputting, by the region proposal network, a feature submap corresponding to the at least one proposal region of each of the at least two proposal region sets into one of the at least two classifiers; detecting, by each of the at least two classifiers, the to-be-detected object based on another feature submap corresponding to another proposal region comprised in an obtained proposal region set; comparing, by each of the at least two classifiers, the detection result with the prior result; and exciting, by each of the at least two classifiers, at least one of the first model parameter, the second model parameter, the region proposal parameter, or a parameter of each classifier based on the comparing.
2. The object detection model training method of claim 1, further comprising: obtaining a system parameter that comprises a quantity of size clusters of to-be-detected objects in the training image; and determining, based on the system parameter, a quantity of classifiers that are obtained through duplication.
3. The object detection model training method of claim 2, further comprising performing clustering on sizes of the to-be-detected objects in the training image, to obtain the quantity of size clusters of the to-be-detected objects in the training image.
4. The object detection model training method of claim 1, further comprising: obtaining a system parameter that comprises a training computing capability; and determining, based on the system parameter, a quantity of classifiers that are obtained through duplication.
5. The object detection model training method of claim 1, further comprising: obtaining a system parameter that comprises a quantity of size clusters of to-be-detected objects in the training image and a training computing capability; and determining, based on the system parameter, a quantity of classifiers that are obtained through duplication.
6. The object detection model training method of claim 1, wherein the feature maps comprise at least two feature maps.
7. A computing device system comprising: at least one computing device, wherein the at least one computing device comprises: a processor; and a memory coupled to the processor and storing instructions that, when executed by the processor, cause the computing device system to be configured to: obtain a training image; establish a backbone network based on the training image; obtain a plurality of feature maps from the backbone network; input the feature maps into a region proposal network; select, by the region proposal network based on a region proposal parameter, a plurality of proposal regions from the feature maps; input feature submaps corresponding to the proposal regions into a classifier; detect, by the classifier, a to-be-detected object in the training image to obtain a detection result based on the feature submaps; compare the detection result with a prior result of the training image; excite at least one of a first model parameter of a convolution kernel of the backbone network, a second model parameter of a convolution kernel of the region proposal network, the region proposal parameter, or a parameter of the classifier based on the comparing; duplicate the classifier to obtain at least two classifiers; classify, by the region proposal network, the proposal regions into at least two proposal region sets, wherein each of the at least two proposal region sets comprises at least one proposal region; input, by the region proposal network, a feature submap corresponding to the at least one proposal region of each of the at least two proposal region sets into one of the at least two classifiers; detect, by each of the at least two classifiers, the to-be-detected object based on another feature submap corresponding to another proposal region comprised in an obtained proposal region set; compare, by each of the at least two classifiers, the detection result with the prior result; and excite, by each of the at least two classifiers, at least one of the first model parameter, the second model parameter, the region proposal parameter, or a parameter of each classifier based on the comparing.
8. The computing device system of claim 7, wherein the instructions further cause the processor to be configured to: obtain a system parameter that comprises a quantity of size clusters of to-be-detected objects in the training image; and determine, based on the system parameter, a quantity of classifiers that are obtained through duplication.
9. The computing device system of claim 8, wherein the instructions further cause the processor to be configured to perform clustering on sizes of the to-be-detected objects in the training image to obtain the quantity of size clusters of the to-be-detected objects in the training image.
10. The computing device system of claim 7, wherein the instructions further cause the processor to be configured to: obtain a system parameter that comprises a training computing capability; and determine, based on the system parameter, a quantity of classifiers that are obtained through duplication.
11. A computer program product comprising computer-executable instructions for storage on a non-transitory computer-readable medium that, when executed by a processor, cause a computing device to: obtain a training image; establish a backbone network based on the training image; obtain a plurality of feature maps from the backbone network; input the feature maps into a region proposal network; select, by the region proposal network based on a region proposal parameter, a plurality of proposal regions from the feature maps; input feature submaps corresponding to the proposal regions into a classifier; detect, by the classifier, a to-be-detected object in the training image to obtain a detection result based on the feature submaps; compare the detection result with a prior result of the training image; excite at least one of a first model parameter of a convolution kernel of the backbone network, a second model parameter of a convolution kernel of the region proposal network, the region proposal parameter, or a parameter of the classifier based on the comparing; duplicate the classifier to obtain at least two classifiers; classify, by the region proposal network, the proposal regions into at least two proposal region sets, wherein each of the at least two proposal region sets comprises at least one proposal region; input, by the region proposal network, a feature submap corresponding to the at least one proposal region of each of the at least two proposal region sets into one of the at least two classifiers; detect, by each of the at least two classifiers, the to-be-detected object based on another feature submap corresponding to another proposal region comprised in an obtained proposal region set; compare, by each of the at least two classifiers, the detection result with the prior result; and excite, by each of the at least two classifiers, at least one of the first model parameter, the second model parameter, the region proposal parameter, or a parameter of each classifier based on the comparing.
12. The computer program product of claim 11, wherein the instructions further cause the computing device to: obtain a system parameter that comprises a quantity of size clusters of to-be-detected objects in the training image; and determine, based on the system parameter, a quantity of classifiers that are obtained through duplication.
13. The computer program product of claim 12, wherein the instructions further cause the computing device to perform clustering on sizes of the to-be-detected objects in the training image to obtain the quantity of size clusters of the to-be-detected objects in the training image.
14. The computer program product of claim 11, wherein the instructions further cause the computing device to: obtain a system parameter that comprises a training computing capability; and determine, based on the system parameter, a quantity of classifiers that are obtained through duplication.
15. An object detection model training method, performed by a computing device, wherein the object detection model training method comprises: extracting, by a backbone network, a plurality of feature maps from a training image; selecting, by a region proposal network, a plurality of proposal regions from the feature maps; inputting feature submaps corresponding to the proposal regions into a classifier; detecting, by the classifier, a to-be-detected object in the training image to obtain a detection result based on the feature submaps; comparing the detection result with a prior result of the training image; exciting at least one of the backbone network, the region proposal network, or the classifier based on the comparing; establishing at least two classifiers obtained by duplicating the classifier; classifying, by the region proposal network, the proposal regions into at least two proposal region sets, wherein each of the at least two proposal region sets comprises at least one proposal region; inputting a feature submap corresponding to the at least one proposal region comprised in each of the at least two proposal region sets into one of the at least two classifiers; detecting, by each of the at least two classifiers, the to-be-detected object in the training image based on an obtained feature submap; comparing, by each of the at least two classifiers, the detection result with the prior result; and re-exciting, by each of the at least two classifiers, at least one of the backbone network, the region proposal network, or the classifier based on the comparing.
16. The object detection model training method of claim 15, further comprising: obtaining a system parameter that comprises at least one of a quantity of size clusters of to-be-detected objects in the training image or a training computing capability; and determining, based on the system parameter, a quantity of the at least two classifiers obtained through duplication.
17. The object detection model training method of claim 16, further comprising performing clustering on sizes of the to-be-detected objects in the training image to obtain the quantity of size clusters of the to-be-detected objects in the training image.
18. The object detection model training method of claim 15, further comprising: obtaining a system parameter that comprises a training computing capability; and determining, based on the system parameter, a quantity of the at least two classifiers obtained through duplication.
19. The object detection model training method of claim 15, further comprising: obtaining a system parameter that comprises at least one of a quantity of size clusters of to-be-detected objects in the training image and a training computing capability; and determining, based on the system parameter, a quantity of the at least two classifiers obtained through duplication.
20. The object detection model training method of claim 15, wherein the feature maps comprise at least two feature maps.
</claims>
</document>

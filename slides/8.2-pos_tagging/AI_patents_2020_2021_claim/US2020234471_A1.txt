<document>

<filing_date>
2019-01-18
</filing_date>

<publication_date>
2020-07-23
</publication_date>

<priority_date>
2019-01-18
</priority_date>

<ipc_classes>
G06T11/00,G06T7/11
</ipc_classes>

<assignee>
CANON MEDICAL SYSTEMS CORPORATION
</assignee>

<inventors>
LEE, TZU-CHENG
LU, YUJIE
THOMPSON, RICHARD
YU, ZHOU
ZHOU, JIAN
</inventors>

<docdb_family_id>
68917355
</docdb_family_id>

<title>
DEEP-LEARNING-BASED SCATTER ESTIMATION AND CORRECTION FOR X-RAY PROJECTION DATA AND COMPUTER TOMOGRAPHY (CT)
</title>

<abstract>
A method and apparatus are provided for using a neural network to estimate scatter in X-ray projection images and then correct for the X-ray scatter. For example, the neural network is a three-dimensional convolutional neural network 3D-CNN to which are applied projection images, at a given view, for respective energy bins and/or material components. The projection images can be obtained by material decomposing spectral projection data, or by segmenting a reconstructed CT image into material-component images, which are then forward projected to generate energy-resolved material-component projections. The result generated by the 3D-CNN is an estimated scatter flux. To train the 3D-CNN, the target scatter flux in the training data can be simulated using a radiative transfer equation method.
</abstract>

<claims>
1. An apparatus, comprising: processing circuitry configured to obtain projection data representing an intensity of X-ray radiation detected at a plurality of detector elements during a computed tomography (CT) scan, generate, based on the projection data, (i) a first plurality of energy-resolved projection images corresponding to a first material component of the material components and (ii) a second plurality of energy-resolved projection images corresponding to a second material component of the material components, acquire a neural network including weighting coefficients of connections between neuronal nodes of respective layers of a plurality of layers between an input layer and an output layer of the neural network, the neural network being a trained neural network, apply the first plurality of energy-resolved projection images together with the second plurality of energy-resolved projection images to the trained neural network to estimate an X-ray scatter flux of the projection data, and remove, using the estimated X-ray scatter flux, a scatter component from the projection data to generate corrected projection data representing an intensity of a primary X-ray beam isolated from the X-ray scatter flux.
2. The apparatus according to claim 1, wherein the processing circuitry is further configured to generate the first plurality of energy-resolved projection images and the second plurality of energy-resolved projection images by reconstructing, from the projection data, a reconstructed image, segmenting the reconstructed image into material-component images corresponding to respective material components, and forward projecting each of the material-component images to respectively generate the first plurality of energy-resolved projection images and the second plurality of energy-resolved projection images.
3. The apparatus according to claim 2, wherein the processing circuitry is further configured to segment the reconstructed images into material-component images based on radiodensity values of pixels or voxels in the reconstructed images and/or a material decomposition.
4. The apparatus according to claim 1, wherein the trained neural network is a convolutional neural network.
5. The apparatus according to claim 1, wherein training the neural network comprises minimizing a loss function, the loss function being a mean square error between a scatter estimation of a neural network and a scatter estimation of a model-based method.
6. The apparatus according to claim 4, wherein the model-based method is a radiative transfer equation-based method.
7. The apparatus according to claim 5, wherein the radiative transfer equation-based method employs spherical harmonics.
8. The apparatus according to claim 1, wherein the neural network is trained on a spectrum of X-ray energy levels.
9. The apparatus according to claim 1, wherein training the neural network comprises learning on forward projections of segmented training images.
10. The apparatus according to claim 8, wherein the forward projections of the segmented training images are performed by calculation of a propagation path length.
11. The apparatus according to claim 1, wherein training the neural network comprises training on a plurality of training images generated from a training projection database, the training projection database comprising a plurality of phantom training projection dataset and a plurality of patient training projection dataset.
12. The apparatus according to claim 1, wherein the processing circuitry is further configured to generate the first plurality of energy-resolved projection images and the second plurality of energy-resolved projection images by performing material decomposition on the projection data to decompose respective projection views in the projection data into a plurality of material components, and determining, for each projection view and material component, a corresponding plurality of energy-resolved projection images corresponding to respective energy bins of X-ray energies.
13. An apparatus, comprising: processing circuitry configured to train a neural network to estimate, based on a plurality of energy-resolved projection images of respective material components, an X-ray scatter flux corresponding to the plurality of energy-resolved projection images, the neural network being trained by obtaining a training dataset including input images that are paired with respective target images, the respective target images being a desired result of applying the input images to the neural network, the target images representing an X-ray scatter flux of the input images, and the input images representing a plurality of energy-resolved projection images that are resolved according to a plurality of energy bins and that are separated according material component, initializing the neural network, the neural network including neuronal nodes connected by connections having weighting coefficients, and the initializing of the neural network including initializing the weighting coefficients, applying the input images to the neural network to generate an output image, calculating a loss function representing a difference or disagreement between the output image and the target images, updating the weighting coefficients in the neural network to optimize the cost function, and stopping, upon satisfying a predefined stopping criteria, the updating of the weighting coefficients, and then outputting the neural network as a trained neural network.
14. The apparatus according to claim 13, wherein the processing circuitry is further configured to train the neural network by generating the target images of the training dataset from the training projection data by estimating the X-ray scatter flux using a radiative transfer equation (RTE)-based scatter method on the training projection data, the RTE-based scatter method calculating the X-ray scatter flux using an integral equation that is approximated using n lowest-order terms of a spherical harmonic expansion, wherein n is an integer greater than two (one) that provides a predefined precision.
15. The apparatus according to claim 13, wherein the processing circuitry is further configured to train the neural network by generating the input images of the training dataset from the training projection data by reconstructing, based on the training projection data, a computed tomography (CT) image, segmenting the CT image into two or more material-component images corresponding to respective material components, and forward projecting each of the material-component images to generate a respective plurality of energy-resolved projection images that are resolved into energy bins of an X-ray energy.
16. The apparatus according to claim 13, wherein the processing circuitry is further configured to train the neural network, wherein the neural network is a three-dimensional convolutional neural network (3D-CNN) including two spatial dimensions of the energy-resolved projection images and a third dimension of the 3D-CNN being an energy dimension of an angle dimension of a plurality of view angles represented in the training projection data.
17. The apparatus according to claim 13, wherein the processing circuitry is further configured to train the neural network by downsampling the training projection data to generate input images and target images that, relative to a native resolution of the training projection data, have a coarser resolution.
18. The apparatus according to claim 17, wherein the processing circuitry is further configured to train the neural network by upsampling, upon stopping the updating of the weighting coefficients, the neural network such that the neural network has resolution that is the native resolution of the training projection data.
19. A method, comprising: obtaining, via processing circuitry, projection data representing an intensity of X-ray radiation detected at a plurality of detector elements during a computed tomography (CT) scan; generating, via the processing circuitry and based on the projection data, (i) a first plurality of energy-resolved projection images corresponding to a first material component of the material components and (ii) a second plurality of energy-resolved projection images corresponding to a second material component of the material components; acquiring, via the processing circuitry, a neural network including weighting coefficients of connections between neuronal nodes of respective layers of a plurality of layers between an input layer and an output layer of the neural network, the neural network being a trained neural network; applying, via the processing circuitry, the first plurality of energy-resolved projection images together with the second plurality of energy-resolved projection images to the trained neural network to estimate an X-ray scatter flux of the projection data; and removing, via the processing circuitry and using the estimated X-ray scatter flux, a scatter component from the projection data to generate corrected projection data representing an intensity of a primary X-ray beam in an absence of X-ray scatter.
20. A non-transitory computer-readable storage medium storing computer-readable instructions that, when executed by a computer, cause the computer to perform a method of performing a scatter estimation and correction, comprising: obtain projection data representing an intensity of X-ray radiation detected at a plurality of detector elements during a computed tomography (CT) scan; generate, based on the projection data, (i) a first plurality of energy-resolved projection images corresponding to a first material component of the material components and (ii) a second plurality of energy-resolved projection images corresponding to a second material component of the material components; acquire a neural network including weighting coefficients of connections between neuronal nodes of respective layers of a plurality of layers between an input layer and an output layer of the neural network, the neural network being a trained neural network; apply the first plurality of energy-resolved projection images together with the second plurality of energy-resolved projection images to the trained neural network to estimate an X-ray scatter flux of the projection data; and correct, using the estimated X-ray scatter flux, the projection data to generate corrected projection data representing an intensity of a primary X-ray beam in an absence of X-ray scatter.
</claims>
</document>

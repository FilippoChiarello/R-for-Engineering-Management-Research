<document>

<filing_date>
2018-09-28
</filing_date>

<publication_date>
2020-04-02
</publication_date>

<priority_date>
2018-09-28
</priority_date>

<ipc_classes>
G05B13/04,G06Q30/02,G06Q50/06,H02J3/00,H02J3/16,H02J3/38,H02J7/35,H02S40/32,H02S40/38
</ipc_classes>

<assignee>
JOHNSON CONTROLS TECHNOLOGY COMPANY
</assignee>

<inventors>
DREES, KIRK, H.
WENZEL, MICHAEL, J.
AUCOIN, CAMILLE M.
</inventors>

<docdb_family_id>
69946207
</docdb_family_id>

<title>
Photovoltaic energy system with stationary energy storage control and power factor correction
</title>

<abstract>
An energy storage system includes a photovoltaic energy field, a stationary energy storage device, an energy converter, and a controller. The photovoltaic energy field converts solar energy into electrical energy and charges the stationary energy storage device with the electrical energy. The energy converter converts the electrical energy stored in the stationary energy storage device into AC power at a discharge rate and supplies a campus with the AC power at the discharge rate. The controller predicts a required load of the campus and an electrical generation of the photovoltaic energy field across a time horizon and optimizes a cost function subject to a set of constraints to determine a discharge rate of the AC power to achieve a desired power factor. At least one of the set of constraints applied to the cost function ensures that the energy converter can convert the electrical energy stored in the stationary energy storage device into AC power having the determined power factor and discharge rate.
</abstract>

<claims>
1. An energy storage system comprising: a photovoltaic energy field configured to convert solar energy into electrical energy; a stationary energy storage device; an energy converter configured to convert the electrical energy from the photovoltaic energy field and store the converted energy in the stationary energy storage device at a charge rate, convert the electrical energy stored in the stationary energy storage device into AC power and discharge the AC power a discharge rate, and supply a campus with the AC power at the discharge rate; a point of interconnection configured to receive power from an energy grid, the energy converter, and the photovoltaic energy field and configured to supply power to the campus; and a controller configured to: predict a load of the campus over a time horizon; predict an energy generation of the photovoltaic energy field over the time horizon; generate a cost function defining a cost of supplying the power to the campus over the time horizon; identify a current reactive power of the campus; determine a required amount of reactive power from the energy converter to at least partially negate the current reactive power to achieve a target power factor; apply a set of constraints to the cost function, the constraints defining a relationship between the discharge rate of the AC power and one or more variables in the cost function and ensuring that the energy converter has sufficient capacity to supply both the AC power at the discharge rate and the required amount of reactive power; determine a solution to the cost function which satisfies the set of constraints, wherein the solution comprises a minimization of the cost function over the time horizon, a specific discharge rate of the AC power, and at least one of the required amount of reactive power or the target power factor to achieve the solution; and control the energy converter to supply the campus with the AC power at the specific discharge rate and the required amount of reactive power to achieve the target power factor.
2. The energy storage system of claim 1, wherein the cost function comprises: an energy charge defining a cost per unit of energy received from the energy grid; and a demand charge defining a cost based on a maximum rate of energy usage over a demand charge horizon.
3. The energy storage system of claim 2, wherein the cost function comprises a weighting term that normalizes the demand charge horizon to the time horizon.
4. The energy storage system of claim 1, wherein the set of constraints comprise at least one of: an energy balance constraint ensuring that the solution satisfies an energy balance of the energy storage system at the point of interconnection; a set of stationary storage system constraints ensuring that the solution satisfies an energy capacity of the stationary energy storage device and that the solution does not require the stationary energy storage device to provide AC power to the campus at a discharge rate greater than a threshold value; a minimum import constraint ensuring that power is not returned to the energy grid; a maximum import constraint ensuring that the power drawn from the energy grid does not exceed a demand value; or a power factor constraint ensuring at least one of: the solution results in a power factor of the campus meeting a power factor target at all time intervals in the time horizon; or the solution results in an average power factor of the campus meeting an average power factor target over a period of time.
5. The energy storage system of claim 1, further comprising: a campus predictor configured to predict an energy load of the campus; and a photovoltaic predictor configured to predict a rate of energy production by the photovoltaic energy field.
6. The energy storage system of claim 5, wherein the campus predictor is configured to predict the energy load of the campus based on historical load data of the campus and weather data, and wherein the photovoltaic predictor is configured to predict the rate of energy production by the photovoltaic energy field based on historical energy production data of the photovoltaic energy field and weather data.
7. The energy storage system of claim 1, wherein determining the required amount of reactive power comprises measuring a real power of the photovoltaic field, a real power of the campus, a reactive power of the campus, and a real power of the energy converter and calculating the required amount of reactive power based on at least one of the real power of the photovoltaic field, the real power of the campus, the reactive power of the campus, and the real power of the energy converter.
8. A method for decreasing a cost associated with powering a campus, the method comprising: converting solar energy into electrical energy and storing the electrical energy in a stationary energy storage device at a charge rate; converting the electrical energy stored in the stationary energy storage device into AC power at a discharge rate and supplying the AC power at the discharge rate to the campus; generating a cost function defining a cost of supplying the power to the campus over the time horizon; identifying a current reactive power of the campus; determining a required amount of reactive power from the energy converter to at least partially negate the current reactive power to achieve a target power factor; applying a set of constraints to the cost function, the constraints defining a relationship between the discharge rate of the AC power and one or more variables in the cost function and ensuring that the energy converter has sufficient capacity to supply both the AC power at the discharge rate and the required amount of reactive power; determining a solution to the cost function which satisfies the set of constraints, wherein the solution comprises a minimization of the cost function over the time horizon, a specific discharge rate of the AC power, and at least one of the required amount of reactive power or the target power factor to achieve the solution; and controlling the energy converter to supply the campus with the AC power at the specific discharge rate and the required amount of reactive power to achieve the target power factor.
9. The method of claim 8, wherein the cost function comprises: an energy charge defining a cost per unit of energy received from the energy grid; and a demand charge defining a cost based on a maximum rate of energy usage over a demand charge horizon.
10. The method of claim 9, wherein the cost function comprises a weighting term that normalizes the demand charge horizon to the time horizon.
11. The method of claim 10, the method further comprising: applying an energy balance constraint to the cost function that ensures that the solution satisfies an energy balance of an energy storage system at a point of interconnection; applying a set of stationary storage system constraints to the cost function that ensures that the solution satisfies an energy capacity of the stationary energy storage device and that the solution does not require the stationary energy storage device to provide AC power to the campus at a discharge rate greater than a threshold value; applying a minimum import constraint to the cost function that ensures that power is not returned to the energy grid; applying a maximum import constraint to the cost function that ensures that the power drawn from the energy grid does not exceed a demand value; applying a power factor constraint ensuring at least one of: the solution results in a power factor of the campus meeting a power factor target at all time intervals in the time horizon; or the solution results in an average power factor of the campus meeting an average power factor target over a period of time.
12. A controller for an energy storage system having a photovoltaic energy field, a battery, and a battery inverter configured to charge the battery with electrical energy from the photovoltaic energy field, convert stored electrical energy from the battery into AC power, and discharge the AC power at a discharge rate to supply power to a campus, the controller configured to: predict a load of the campus over a time horizon; predict an energy generation of the photovoltaic energy field over the time horizon; generate a cost function defining a cost of supplying the power to the campus over the time horizon; identify a current reactive power of the campus; determine a required amount of reactive power from the battery inverter to at least partially negate the current reactive power to achieve a target power factor; apply a set of constraints to the cost function, the constraints defining a relationship between the discharge rate of the AC power and one or more variables in the cost function and ensuring that the battery inverter has sufficient capacity to supply both the AC power at the discharge rate and the required amount of reactive power; determine a solution to the cost function which satisfies the set of constraints, wherein the solution comprises a minimization of the cost function over the time horizon, a specific discharge rate of the AC power, and at least one of the required amount of reactive power or the target power factor to achieve the solution; and control the battery inverter to supply the campus with the AC power at the specific discharge rate and the required amount of reactive power to achieve the target power factor.
13. The controller of claim 12, wherein the cost function comprises: an energy charge defining a cost per unit of energy received from the energy grid; and a demand charge defining a cost based on a maximum rate of energy usage over a demand charge horizon.
14. The controller of claim 13, wherein the cost function comprises a weighting term that normalizes the demand charge horizon to the time horizon.
15. The controller of claim 14, wherein the set of constraints comprise at least one of: an energy balance constraint ensuring that the solution satisfies an energy balance of the energy storage system at the point of interconnection; a set of battery capacity constraints ensuring that the solution satisfies an energy capacity of the battery and that the solution does not require the battery to provide AC power to the campus at a discharge rate greater than a threshold value; a minimum import constraint ensuring that power is not returned to the energy grid; a maximum import constraint ensuring that the power drawn from the energy grid does not exceed a demand value; and a power factor constraint ensuring at least one of: the solution results in a power factor of the campus meeting a power factor target at all time intervals in the time horizon; or the solution results in an average power factor of the campus meeting an average power factor target over a period of time.
16. The controller of claim 15, further comprising: a campus predictor configured to predict an energy load of the campus over the time horizon; and a photovoltaic predictor module configured to predict a rate of energy production by the photovoltaic energy field over the time horizon.
17. The controller of claim 16, wherein the campus load predictor is further configured to calculate an uncertainty of the predicted energy load of the campus over the time horizon and the photovoltaic predictor is further configured to calculate an uncertainty of the predicted rate of photovoltaic energy production over the time horizon.
18. The controller of claim 16, further comprising a low level controller configured to determine control signals to adjust an operation of the battery inverter to achieve the specific discharge rate and power factor of the battery inverter.
19. The controller of claim 15, wherein the cost function further comprises a power factor term defining a power factor violation term and a penalty cost associated with the power factor violation term.
20. The controller of claim 19, wherein the controller is configured to increase or decrease the power factor violation term based on at least one of a difference of the power factor of the campus and the power factor target and a difference of the average power factor of the campus and the target average power factor over a period of time.
</claims>
</document>

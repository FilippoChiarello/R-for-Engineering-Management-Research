<document>

<filing_date>
2018-07-31
</filing_date>

<publication_date>
2020-12-08
</publication_date>

<priority_date>
2018-07-31
</priority_date>

<ipc_classes>
H04L12/26,H04L12/721,H04L12/725,H04L12/741,H04L12/803,H04L12/851,H04L29/06,H04L29/08,H04W52/02
</ipc_classes>

<assignee>
JUNIPER NETWORKS
</assignee>

<inventors>
DODS, CRAIG
HUANG, GUANGSONG
</inventors>

<docdb_family_id>
73653524
</docdb_family_id>

<title>
Intelligent offloading of services for a network device
</title>

<abstract>
A network device may receive a packet associated with a traffic flow of a session that includes session identification information for the session. The network device may determine to offload subsequent packets associated with the traffic flow using offloading indicators and/or a data model. The network device may store, using a data structure, the session identification information with other session identification information for other sessions that have been selected for offloading, and may provide the packet to a device. The network device may receive another packet associated with the traffic flow, and may determine to offload the other packet by determining that the other packet includes the session identification information. The device may offload the other packet to permit the other packet to traverse through the network device without the network device performing security checks on the other packet, and may provide the other packet to the device.
</abstract>

<claims>
1. A network device, comprising: one or more security processing units (SPUs); one or more memories; and one or more processors to: receive a packet associated with a traffic flow of a session, wherein the packet includes session identification information for the session; determine, after receiving the packet, to offload subsequent packets associated with the traffic flow of the session using: a set of offloading indicators that are used to determine whether to offload the traffic flow of the session, wherein the set of offloading indicators include at least one of: a first indicator that indicates a quantity of packets that have been transmitted during the session, a second indicator that indicates a type of session that is likely to have a threshold amount of throughput, or a third indicator that indicates whether a memory utilization rate associated with an integrated circuit of the network device satisfies a threshold memory utilization rate, and a data model that is used to generate recommendations indicating whether to offload the traffic flow of the session, wherein the data model is trained with information associated with one or more of: historical offloading indicators, historical information indicating whether traffic flow of particular sessions was offloaded, or historical information indicating whether the traffic flow of the particular sessions should have been offloaded, and wherein the data model is used to determine whether a threshold associated with being a high-throughput session is satisfied; store, using a data structure, the session identification information for the session with other session identification information for other sessions that have been selected for offloading; provide the packet to a device after storing the session identification information; receive another packet associated with the traffic flow of the session; determine to offload the other packet by determining that the other packet includes the session identification information for the traffic flow of the session that is to be offloaded; offload the other packet to permit the other packet to traverse through the network device without the one or more SPUs performing one or more security checks on the other packet; and provide the other packet to the device.
2. The network device of claim 1, wherein the session is part of a group of sessions, and wherein a number of sessions in the group of sessions is: at least ten million sessions, at least fifty million sessions, at least one hundred million sessions, or at least five hundred million sessions.
3. The network device of claim 1, wherein the one or more processors, when determining to offload the subsequent packets associated with the session, are to: obtain or determine the set of offloading indicators, wherein the set of offloading indicators further includes: a fourth indicator that indicates a duration of the session, process the set of offloading indicators to determine an overall indicator value that is to be used to determine whether to select the traffic flow of the session for offloading, and determine to offload the subsequent packets based on the overall indicator value satisfying a threshold overall indicator value, wherein the threshold overall indicator value is used as an indicator of when particular traffic flow is to be offloaded.
4. The network device of claim 1, further comprising one or more integrated circuits; and wherein the one or more processors are further to: determine, before determining to offload the traffic flow of the session, that the memory utilization rate satisfies the threshold memory utilization rate, wherein the traffic flow of the session traverses through the first integrated circuit; dynamically modify, based on determining that the memory utilization rate satisfies the threshold memory utilization rate, a threshold overall indicator value that is to be used to determine whether to offload the subsequent packets associated with the traffic flow of the session; and wherein the one or more processors, when determining to offload the subsequent packets associated with the traffic flow of the session, are to: use the threshold overall indicator value when processing the set of offloading indicators to determine to offload the subsequent packets associated with the traffic flow of the session.
5. The network device of claim 1, wherein the one or more processors are further to: identify user preferences information associated with the session after performing one or more security checks on the packet, wherein the user preferences information identifies one or more devices associated with an entity that are to receive priority for offloading; and wherein the one or more processors, when determining to offload the subsequent packets associated with the session, are to: determine to offload the subsequent packets based on the traffic flow being received from a particular device of the one or more devices that is to receive priority for offloading.
6. The network device of claim 1, wherein the one or more processors, when determining to offload the subsequent packets associated with the session, are to: provide the set of offloading indicators as input to the data model to cause the data model to output one or more values associated with a recommendation to select the traffic flow of the session for offloading, and determine to offload the subsequent packets based on the one or more values associated with the recommendation to select the traffic flow of the session for offloading.
7. The network device of claim 1, further comprising one or more integrated circuits; and wherein the one or more processors are further to: monitor, after providing the other packet to the device, one or more memory utilization rates associated with the one or more integrated circuits; determine, based on monitoring the one or more memory utilization rates associated with the one or more integrated circuits, that the memory utilization rate, satisfies the threshold memory utilization rate, wherein the traffic flow of the session is associated with the integrated circuit; and route a portion of the traffic flow of the session to other integrated circuits based on determining that the memory utilization rate satisfies the threshold memory utilization rate.
8. A method, comprising: receiving, by a network device, a packet associated with a traffic flow of a session, wherein the packet includes session identification information for the session; performing, by the network device, one or more security checks on the packet using one or more security processing units (SPUs); determining, by the network device, to offload subsequent packets associated with the traffic flow of the session using: a set of offloading indicators that are used to determine whether to offload the traffic flow of the session, wherein the set of offloading indicators include at least one of: a first indicator that indicates a quantity of packets that have been transmitted during the session, a second indicator that indicates a type of session that is likely to have a threshold amount of throughput, or a third indicator that indicates whether a memory utilization rate associated with an integrated circuit of the network device satisfies a threshold memory utilization rate, and a data model that is used to generate recommendations indicating whether to offload the traffic flow of the session, wherein the data model is trained with information associated with one or more of: historical offloading indicators, historical information indicating whether traffic flow of particular sessions was offloaded, or historical information indicating whether the traffic flow of the particular sessions should have been offloaded, and wherein the data model is used to determine whether a threshold associated with being a high-throughput session is satisfied; providing, by the network device, the packet to a device after performing the one or more security checks on the packet; receiving, by the network device, another packet associated with the traffic flow of the session; offloading, by the network device, the other packet based on determining that the other packet includes the session identification information of the session, wherein offloading the other packet allows the other packet to be routed through the network device without being subject to the one or more security checks; and providing, by the network device, the other packet to the device.
9. The method of claim 8, wherein the other packet travels through an ingress port of the network device and an egress port of the network device without interacting with the one or more SPUs.
10. The method of claim 8, wherein the session is part of a group of sessions, and wherein a number of sessions in the group of sessions is: at least ten million sessions, at least fifty million sessions, at least one hundred million sessions, or at least five hundred million sessions.
11. The method of claim 8, wherein determining to offload the subsequent packets associated with the session comprises: obtaining the set of offloading indicators, processing the set of offloading indicators to determine an overall indicator value that is to be used to determine whether to select the traffic flow of the session for offloading, and determining to offload the subsequent packets based on determining that the overall indicator value satisfies a threshold overall indicator value, wherein the threshold overall indicator value is used as an indicator of when particular traffic flow is to be offloaded.
12. The method of claim 8, further comprising: identifying user preferences information associated with the session after performing the one or more security checks on the packet, wherein the user preferences information identifies one or more devices associated with an entity that are to receive priority for offloading; and wherein determining to offload the subsequent packets associated with the session comprises: determining to offload the subsequent packets based on the traffic flow being received from a particular device of the one or more devices that are to receive priority for offloading.
13. The method of claim 8, further comprising: determining that the traffic flow of the session is no longer eligible for offloading after providing the other packet to the device; receiving an additional packet associated with the traffic flow of the session after determining that the traffic flow of the session is no longer eligible for offloading; performing the one or more security checks on the additional packet; and providing the additional packet to the device.
14. The method of claim 8, further comprising: monitoring, after providing the other packet to the device, one or more memory utilization rates associated with one or more integrated circuits of the network device; determining, based on monitoring the one or more memory utilization rates associated with the one or more integrated circuits, that the memory utilization rate satisfies the threshold memory utilization rate, wherein the traffic flow of the session is associated with the first integrated circuit; and route a portion of the traffic flow of the session to other integrated circuits based on determining that the memory utilization rate satisfies the threshold memory utilization rate.
15. A non-transitory computer-readable medium storing instructions, the instructions comprising: one or more instructions that, when executed by one or more processors, cause the one or more processors to: receive a packet associated with a traffic flow of a session, wherein the packet includes session identification information for the session; perform one or more security checks on the packet using one or more security processing units (SPUs); determine, after receiving the packet, a set of offloading indicators that are to be used to determine whether to offload the traffic flow of the session, wherein the set of offloading indicators include at least one of: a first indicator that indicates a quantity of packets that have been transmitted during the session, a second indicator that indicates a type of session that is likely to have a threshold amount of throughput, or a third indicator that indicates whether a memory utilization rate associated with an integrated circuit of a network device satisfies a threshold memory utilization rate; determine to offload the traffic flow of the session based on analyzing: the set of offloading indicators that are used to determine whether to offload the traffic flow of the session, and a data model that is used to generate recommendations indicating whether to offload the traffic flow of the session, wherein the data model is trained with information associated with one or more of: historical offloading indicators, historical information indicating whether traffic flow of particular sessions was offloaded, or historical information indicating whether the traffic flow of the particular sessions should have been offloaded, and wherein the data model is used to determine whether a threshold associated with being a high-throughput session is satisfied; store, using a data structure, the session identification information for the session with other session identification information for other sessions that have been selected for offloading; provide the packet to a device after performing the one or more security checks on the packet; receive another packet associated with the traffic flow of the session; offload the other packet based on determining that the other packet includes the session identification information of the session, wherein offloading the other packet causes the other packet to bypass the one or more SPUs while traversing through the network device; and provide the other packet to the device.
16. The non-transitory computer-readable medium of claim 15, wherein the session is part of a group of sessions, and wherein a number of sessions in the group of sessions is: at least ten million sessions, at least fifty million sessions, at least one hundred million sessions, or at least five hundred million sessions.
17. The non-transitory computer-readable medium of claim 15, wherein the one or more instructions, when executed by the one or more processors, further cause the one or more processors to: determine, before determining to offload the traffic flow of the session, that the memory utilization rate satisfies the threshold memory utilization rate, wherein the traffic flow of the session traverses through the first integrated circuit; modify a threshold overall indicator value that is to be used to determine whether to select the traffic flow that traverses through the integrated circuit for offloading based on determining that the memory utilization rate associated with the integrated circuit satisfies the threshold memory utilization rate; and wherein the one or more instructions, that cause the one or more processors to determine to offload the traffic flow of the session, cause the one or more processors to: process the set of offloading indicators to determine an overall indicator value that is to be used to determine whether to select the traffic flow of the session for offloading, and determine to offload the traffic flow based on determining that the overall indicator value satisfies the threshold overall indicator value that has been modified.
18. The non-transitory computer-readable medium of claim 15, wherein the one or more instructions, when executed by the one or more processors, further cause the one or more processors to: obtain an updated set of offloading indicators after providing the other packet to the device; process the updated set of offloading indicators to determine an overall indicator value; determine that the overall indicator value does not satisfy a threshold overall indicator value; and determine that the traffic flow of the session is no longer eligible for offloading based on determining that the overall indicator value does not satisfy the threshold overall indicator value, wherein determining that the traffic flow of the session is no longer eligible for offloading causes the one or more SPUs are to perform the one or more security checks on additional packets that are received as part of the traffic flow of the session.
19. The non-transitory computer-readable medium of claim 15, wherein the one or more instructions, when executed by the one or more processors, further cause the one or more processors to: monitor, after providing the other packet to the device, one or more memory utilization rates associated with one or more integrated circuits; determine, based on monitoring the one or more memory utilization rates associated with the one or more integrated circuits, that the memory utilization rate satisfies the threshold memory utilization rate; and perform an action associated with load balancing the traffic flow or improving accuracy of a technique used to determine whether to offload the traffic flow based on determining that the memory utilization rate satisfies the threshold memory utilization rate.
20. The non-transitory computer-readable medium of claim 19, wherein the action includes: a first action to modify a threshold overall indicator value used to analyze the set of offloading indicators, a second action to retrain the data model that is used to generate the recommendations indicating whether to offload the traffic flow of the session, or a third action to route packets to load balance the traffic flow.
</claims>
</document>

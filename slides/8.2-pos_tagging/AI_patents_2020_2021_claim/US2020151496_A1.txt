<document>

<filing_date>
2019-11-08
</filing_date>

<publication_date>
2020-05-14
</publication_date>

<priority_date>
2018-11-09
</priority_date>

<ipc_classes>
G06K9/46,G06K9/62
</ipc_classes>

<assignee>
CANON VIRGINIA
</assignee>

<inventors>
DENNEY, BRADLEY SCOTT
CAO, XIWU
</inventors>

<docdb_family_id>
70552252
</docdb_family_id>

<title>
DEVICES, SYSTEMS, AND METHODS FOR ANOMALY DETECTION
</title>

<abstract>
Devices, systems, and methods obtain one or more training images; obtain a test image; select one or more associated pixels in the training images for a target pixel in the training images; calculate respective value relationships between a value of the target pixel and respective values of the associated pixels in the training images; select one or more associated pixels in the test image for a target pixel in the test image; and detect an anomaly in the target pixel in the test image based on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the training images and on respective value relationships between a value of the target pixel and respective values of the associated pixels in the test image.
</abstract>

<claims>
1. A device comprising: one or more computer-readable storage media; and one or more processors in communication with the one or more computer-readable storage media to cause the device to perform operations comprising: obtaining one or more training images; obtaining a test image; selecting one or more associated pixels in the training images for a target pixel in the training images; calculating respective value relationships between a value of the target pixel and respective values of the associated pixels in the training images; selecting one or more associated pixels in the test image for a target pixel in the test image; and detecting an anomaly in the target pixel in the test image based on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the training images and on respective value relationships between a value of the target pixel and respective values of the associated pixels in the test image.
2. The device of claim 1, wherein detecting the anomaly in the target pixel in the test image based on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the training images and on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the test image includes: calculating a centrality of respective value differences between the value of the target pixel and the respective values of the associated pixels in the training images; and calculating a respective variation of the respective value differences between the value of the target pixel and the respective values of the associated pixels in the training images.
3. The device of claim 2, wherein detecting the anomaly in the target pixel in the test image based on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the training images and on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the test image further includes: detecting the anomaly in the target pixel in the test image based on at least one of the centrality and the variation of the respective value differences and on respective value differences between the value of the target pixel and the respective values of the associated pixels in the test image.
4. The device of claim 1, wherein detecting the anomaly in the target pixel in the test image based on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the training images and on the respective value relationships between the value of the target pixel and the respective values of the associated pixels in the test image includes: generating a predicted target-pixel value for the target pixel in the test image based on the respective values of the associated pixels in the test image and on the value of the target pixel and the respective values of the associated pixels in the training images; generating a target-pixel-value-to-predicted-target-pixel-value difference based on the predicted target-pixel value and on the value of the target pixel in the test image; and detecting the anomaly in the target pixel in the test image based at least in part on the target-pixel-value-to-predicted-target-pixel-value difference.
5. The device of claim 1, wherein selecting one or more associated pixels in the training images for the target pixel in the training images includes: selecting one or more associated pixels in the training images that are located a first distance range away from the target pixel, and selecting one or more associated pixels in the training images that are located a second distance range away from the target pixel, wherein the first distance range is different from the second distance range.
6. The device of claim 1, wherein the one or more training images and the test image both depict instances of an object, wherein a position on the object that is depicted by the target pixel in the training images is similar to a position on the object that is depicted by the respective target pixel in the test image.
7. A method comprising: obtaining training images; obtaining a test image; selecting one or more respective associated pixels in the training images for each of a plurality of corresponding target pixels in the training images, wherein the plurality of corresponding target pixels correspond across the training images, and wherein the one or more respective associated pixels of each target pixel in the plurality of corresponding target pixels are included in a same training image of the one or more training images as the target pixel; selecting one or more respective associated pixels in the test image for a target pixel in the test image, wherein each of the one or more respective associated pixels in the test image correspond to at least one of the one or more respective associated pixels in the training images; and detecting an anomaly in the target pixel in the test image based on respective values of the plurality of corresponding target pixels and respective values of the respective associated pixels of the plurality of target pixels in the training images and on a value of the target pixel and respective values of the respective associated pixels in the test image.
8. The method of claim 7, wherein selecting the one or more respective associated pixels in the training images for each of the plurality of corresponding target pixels in the training images includes: selecting one or more respective candidate associated pixels in the training images for each of the plurality of corresponding target pixels in the training images, calculating respective value differences between values of the plurality of corresponding target pixels and values of the respective candidate associated pixels of the plurality of corresponding target pixels, calculating respective median absolute deviations of the respective value differences, and selecting the one or more respective associated pixels in the training images for each of the plurality of corresponding target pixels in the training images based on the respective median absolute deviations of the respective value differences.
9. The method of claim 7, wherein detecting the anomaly in the target pixel in the test image includes: calculating respective medians of the respective value differences between the respective values of the plurality of corresponding target pixels and the respective values of the associated pixels of the plurality of corresponding target pixels in the training images; and calculating respective median absolute deviations of the respective value differences between the respective values of the plurality of corresponding target pixels and the respective values of the associated pixels of the plurality of corresponding target pixels in the training images.
10. The method of claim 7, wherein detecting the anomaly in the target pixel in the test image includes: generating a predicted target-pixel value based on the respective value of at least one of the plurality of corresponding target pixels and the respective values of the associated pixels of the at least one of the plurality of corresponding target pixels in the training images.
11. The method of claim 10, wherein detecting the anomaly in the target pixel in the test image includes: calculating a target-prediction-to-target-difference for the test image based on the predicted target-pixel value and on the value of the target pixel in the test image; and comparing the target-prediction-to-target-difference in the test image to a centrality and a variation of target-prediction-to-target differences across the training images.
12. The method of claim 7, wherein detecting the anomaly in the target pixel in the test image includes detecting the anomaly in the target pixel in the test image based on respective value differences between the respective values of the plurality of corresponding target pixels and the respective values of the associated pixels of the plurality of corresponding target pixels in the training images and on respective value differences between the value of the target pixel and the respective values of the associated pixels of the target pixel in the test image.
13. The method of claim 7, wherein the at least some of the one or more respective associated pixels of each target pixel in the plurality of corresponding target pixels have different distance ranges from the target pixel.
14. One or more computer-readable storage media storing instructions that, when executed by one or more computing devices, cause the one or more computing devices to perform operations comprising: obtaining training images; selecting a plurality of corresponding target pixels in the training images; selecting, for each corresponding target pixel of the plurality of corresponding target pixels, one or more respective corresponding associated pixels in the training images, wherein each target pixel of the plurality of corresponding target pixels and the one or more respective associated pixels of the target pixel are included in a same training image of the training images and the corresponding target pixels and the corresponding associated pixels correspond across the training images; obtaining a test image; selecting a target pixel in the test image corresponding to one or more of the plurality of corresponding target pixels in the training images; selecting one or more respective associated pixels in the test image for the target pixel in the test image, wherein each of the respective associated pixels in the test image corresponds to a respective one or more of the respective corresponding associated pixels in the training images; and performing anomaly detection on the target pixel in the test image based on a value of the target pixel and respective values of the respective associated pixels in the test image and on respective values of the plurality of corresponding target pixels and respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images.
15. The one or more computer-readable storage media of claim 14, wherein performing anomaly detection on the target pixel in the test image based on the value of the target pixel and the respective values of the respective associated pixels in the test image and on the respective values of the plurality of corresponding target pixels and the respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images includes: performing anomaly detection on the target pixel in the test image based on respective value differences between the value of the target pixel and the respective values of the respective associated pixels in the test image and on respective value differences between the respective values of the plurality of corresponding target pixels and the respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images.
16. The one or more computer-readable storage media of claim 14, wherein selecting, for each corresponding target pixel of the plurality of corresponding target pixels, the one or more respective corresponding associated pixels in the training images includes: selecting, for each corresponding target pixel of the plurality of corresponding target pixels, one or more respective candidate associated pixels in the training images; calculating, for each corresponding target pixel of the plurality of corresponding target pixels, respective value differences between a value of the corresponding target pixel and values of the respective candidate associated pixels of the target pixel; calculating, for each corresponding target pixel of the plurality of corresponding target pixels, respective median absolute deviations of the respective value differences; and selecting, for each corresponding target pixel of the plurality of corresponding target pixels, the one or more respective corresponding associated pixels in the training images based on the respective median absolute deviations of the corresponding target pixel to respective candidate associated pixel differences.
17. The one or more computer-readable storage media of claim 14, wherein the operations further comprise: generating a predicted target-pixel-value model based on the respective values of the plurality of corresponding target pixels and the respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images, and wherein performing anomaly detection on the target pixel in the test image based on a value of the target pixel and respective values of the respective associated pixels in the test image and on respective values of the plurality of corresponding target pixels and respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images includes generating a predicted target-pixel value based on the target-pixel-value model and on the respective values of the respective associated pixels in the test image, and calculating a respective value difference between the value of the target pixel in the test image and the predicted target-pixel value.
18. The one or more computer-readable storage media of claim 17, wherein the predicted target-pixel-value model is an affine model with respect to the associated pixel values in the test image.
19. The one or more computer-readable storage media of claim 17, wherein performing anomaly detection on the target pixel in the test image further comprises: calculating a respective centrality and variation of the respective value difference between the value of the target pixel and the predicted target-pixel value based on the respective values of the plurality of corresponding target pixels and on the respective values of the respective corresponding associated pixels in the training images, generating an anomaly score based at least in part on the respective value difference, the respective centrality, and the respective variation.
20. The one or more computer-readable storage media of claim 14, wherein performing anomaly detection on the target pixel in the test image based on a value of the target pixel and respective values of the respective associated pixels in the test image and on respective values of the plurality of corresponding target pixels and respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images includes: calculating a respective variation of the respective value differences between the respective values of the plurality of corresponding target pixels and the respective values of the respective corresponding associated pixels of the plurality of corresponding target pixels in the training images; and detecting an anomaly in the target pixel in the test image based on the variation of the respective value differences and on the respective value differences between a value of the target pixel and respective values of the respective associated pixels in the test image.
</claims>
</document>

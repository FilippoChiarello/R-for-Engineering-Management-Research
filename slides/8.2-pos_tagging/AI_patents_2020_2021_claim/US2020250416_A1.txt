<document>

<filing_date>
2020-04-21
</filing_date>

<publication_date>
2020-08-06
</publication_date>

<priority_date>
2017-12-28
</priority_date>

<ipc_classes>
G06F40/169,G06K9/00,G06K9/62,G06N3/04,G06N3/08
</ipc_classes>

<assignee>
BAIDU ON-LINE NETWORK TECHNOLOGY (BEIJING) COMPANY
</assignee>

<inventors>
DING, ERRUI
HAN, JUNYU
LIU, JIAMING
ZHANG, CHENGQUAN
</inventors>

<docdb_family_id>
62128721
</docdb_family_id>

<title>
METHOD AND APPARATUS FOR TRAINING A CHARACTER DETECTOR BASED ON WEAK SUPERVISION, SYSTEM AND MEDIUM
</title>

<abstract>
A method and apparatus for training a character detector based on weak supervision, a character detection system and a computer readable storage medium are provided, wherein the method includes: inputting coarse-grained annotation information of a to-be-processed object, wherein the coarse-grained annotation information including a whole bounding outline of a word, text bar or line of the to-be-processed object; dividing the whole bounding outline of the coarse-grained annotation information, to obtain a coarse bounding box of a character of the to-be-processed object; obtaining a predicted bounding box of the character of the to-be-processed object through a neural network model from the coarse-grained annotation information; and determining a fine bounding box of the character of the to-be-processed object as character-based annotation of the to-be-processed object, according to the coarse bounding box and the predicted bounding box.
</abstract>

<claims>
1. A method for training a character detector based on weak supervision, comprising: inputting coarse-grained annotation information of a to-be-processed object, the coarse-grained annotation information including a whole bounding outline of a word, text bar or line of the to-be-processed object; dividing the whole bounding outline of the coarse-grained annotation information, to obtain a coarse bounding box of a character of the to-be-processed object; obtaining a predicted bounding box of the character of the to-be-processed object through a neural network model from the coarse-grained annotation information; and determining a fine bounding box of the character of the to-be-processed object as character-based annotation of the to-be-processed object, according to the coarse bounding box and the predicted bounding box, wherein determining a fine bounding box of the character of the to-be-processed object according to the coarse bounding box and the predicted bounding box comprises: determining whether both a first condition and a second condition are satisfied, the first condition being that a confidence of the predicted bounding box is larger than a preset confidence threshold, and the second condition being that an overlap ratio of the coarse bounding box to the predicted bounding box is larger than a preset overlap ratio threshold; adjusting the coarse bounding box based on the predicted bounding box, to generate the fine bounding box, in a case that both the first condition and the second condition are satisfied; and determining boundaries of the coarse bounding box as boundaries of the fine bounding box, in a case that at least one of the first condition and the second condition is not satisfied.
2. The method according to claim 1, wherein the whole bounding outline comprises a polygon.
3. The method according to claim 2, wherein dividing the whole bounding outline of the coarse-grained annotation information, to obtain a coarse bounding box of a character of the to-be-processed object comprises: equally dividing the polygon of the coarse-grained annotation information into N portions, wherein a direction perpendicular to a long axis of the polygon is an extension direction of a division line; and N is the number of character in the coarse-grained annotation information, or is an integer obtained by rounding a quotient obtained by dividing a length of the long axis of the polygon by a length of the shortest edge of the polygon.
4. The method according to claim 1, wherein adjusting the coarse bounding box based on the predicted bounding box, to generate the fine bounding box comprises: determining whether an angle between a long axis and a transverse axis of the whole bounding outline of the coarse-grained annotation information is less than or equal to 45°; in a case that the angle is less than or equal to 45°, determining upper and lower boundaries of the coarse bounding box as upper and lower boundaries of the fine bounding box respectively, and determining left and right boundaries of the predicted bounding box as left and right boundaries of the fine bounding box respectively; in a case that the angle is larger than 45°, determining upper and lower boundaries of the coarse bounding box as left and right boundaries of the fine bounding box respectively, and determining left and right boundaries of the predicted bounding box as upper and lower boundaries of the fine bounding box respectively.
5. The method according to claim 1, wherein after determining a fine bounding box of the character of the to-be-processed object according to the coarse bounding box and the predicted bounding box, the method further comprises: calculating a loss function of the neural network model according to the fine bounding box; and updating a parameter value of the neural network model through an error backpropagation algorithm, based on the loss function.
6. An apparatus for training a character detector based on weak supervision, the apparatus comprising: one or more processors; and a storage device for storing one or more programs, wherein the one or more programs, when executed by said one or more processors, enable said one or more processors to: input coarse-grained annotation information of a to-be-processed object, the coarse-grained annotation information including a whole bounding outline of a word, text bar or line of the to-be-processed object; divide the whole bounding outline of the coarse-grained annotation information, to obtain a coarse bounding box of a character of the to-be-processed object; obtain a predicted bounding box of the character of the to-be-processed object through a neural network model from the coarse-grained annotation information; and determine a fine bounding box of the character of the to-be-processed object as character-based annotation of the to-be-processed object, according to the coarse bounding box and the predicted bounding box, wherein the one or more programs, when executed by said one or more processors, enable said one or more processors further to: determine whether both a first condition and a second condition are satisfied, the first condition being that a confidence of the predicted bounding box is larger than a preset confidence threshold, and the second condition being that an overlap ratio of the coarse bounding box to the predicted bounding box is larger than a preset overlap ratio threshold; adjust the coarse bounding box based on the predicted bounding box, to generate the fine bounding box, in a case that both the first condition and the second condition are satisfied; and determine boundaries of the coarse bounding box as boundaries of the fine bounding box, in a case that at least one of the first condition and the second condition is not satisfied.
7. The apparatus according to claim 6, wherein the whole bounding outline comprises a polygon.
8. The apparatus according to claim 7, wherein the one or more programs, when executed by said one or more processors, enable said one or more processors further to: equally divide the polygon of the coarse-grained annotation information into N portions, wherein a direction perpendicular to a long axis of the polygon is an extension direction of a division line; and N is the number of character in the coarse-grained annotation information, or is an integer obtained by rounding a quotient obtained by dividing a length of the long axis of the polygon by a length of the shortest edge of the polygon.
9. The apparatus according to claim 6, wherein the one or more programs, when executed by said one or more processors, enable said one or more processors further to: determine whether an angle between a long axis and a transverse axis of the whole bounding outline of the coarse-grained annotation information is less than or equal to 45°; in a case that the angle is less than or equal to 45°, determine upper and lower boundaries of the coarse bounding box as upper and lower boundaries of the fine bounding box respectively, and determine left and right boundaries of the predicted bounding box as left and right boundaries of the fine bounding box respectively; in a case that the angle is larger than 45°, determine upper and lower boundaries of the coarse bounding box as left and right boundaries of the fine bounding box respectively, and determine left and right boundaries of the predicted bounding box as upper and lower boundaries of the fine bounding box respectively.
10. The apparatus according to claim 6, wherein the one or more programs, when executed by said one or more processors, enable said one or more processors further to: calculate a loss function of the neural network model according to the fine bounding box, and update a parameter value of the neural network model through an error back-propagation algorithm, based on the loss function.
11. A non-transitory computer readable storage medium in which a computer program is stored, wherein the computer program, when executed by a processor, enables the processor to: input coarse-grained annotation information of a to-be-processed object, the coarse-grained annotation information including a whole bounding outline of a word, text bar or line of the to-be-processed object; divide the whole bounding outline of the coarse-grained annotation information, to obtain a coarse bounding box of a character of the to-be-processed object; obtain a predicted bounding box of the character of the to-be-processed object through a neural network model from the coarse-grained annotation information; and determine a fine bounding box of the character of the to-be-processed object as character-based annotation of the to-be-processed object, according to the coarse bounding box and the predicted bounding box, wherein the computer program, when executed by the processor, enables the processor further to: determine whether both a first condition and a second condition are satisfied, the first condition being that a confidence of the predicted bounding box is larger than a preset confidence threshold, and the second condition being that an overlap ratio of the coarse bounding box to the predicted bounding box is larger than a preset overlap ratio threshold; adjust the coarse bounding box based on the predicted bounding box, to generate the fine bounding box, in a case that both the first condition and the second condition are satisfied; and determine boundaries of the coarse bounding box as boundaries of the fine bounding box, in a case that at least one of the first condition and the second condition is not satisfied.
12. The non-transitory computer readable storage medium according to claim 11, wherein the whole bounding outline comprises a polygon.
13. The non-transitory computer readable storage medium according to claim 12, wherein the computer program, when executed by the processor, enables the processor further to: equally divide the polygon of the coarse-grained annotation information into N portions, wherein a direction perpendicular to a long axis of the polygon is an extension direction of a division line; and N is the number of character in the coarse-grained annotation information, or is an integer obtained by rounding a quotient obtained by dividing a length of the long axis of the polygon by a length of the shortest edge of the polygon.
14. The non-transitory computer readable storage medium according to claim 11, wherein the computer program, when executed by the processor, enables the processor further to: determine whether an angle between a long axis and a transverse axis of the whole bounding outline of the coarse-grained annotation information is less than or equal to 45°; in a case that the angle is less than or equal to 45°, determine upper and lower boundaries of the coarse bounding box as upper and lower boundaries of the fine bounding box respectively, and determine left and right boundaries of the predicted bounding box as left and right boundaries of the fine bounding box respectively; in a case that the angle is larger than 45°, determine upper and lower boundaries of the coarse bounding box as left and right boundaries of the fine bounding box respectively, and determine left and right boundaries of the predicted bounding box as upper and lower boundaries of the fine bounding box respectively.
15. The non-transitory computer readable storage medium according to claim 11, wherein the computer program, when executed by the processor, enables the processor further to: calculate a loss function of the neural network model according to the fine bounding box, and update a parameter value of the neural network model through an error back-propagation algorithm, based on the loss function.
</claims>
</document>

<document>

<filing_date>
2017-03-30
</filing_date>

<publication_date>
2020-01-28
</publication_date>

<priority_date>
2017-03-30
</priority_date>

<ipc_classes>
G06F17/16,G06F17/50,G06F19/00,G06N3/04,G06N3/08,G06N5/04,G16C20/30,G16C20/70
</ipc_classes>

<assignee>
ATOMWISE
</assignee>

<inventors>
HEIFETS, ABRAHAM SAMUEL
NGUYEN, KONG THONG
WALLACH, IZHAR
</inventors>

<docdb_family_id>
63669668
</docdb_family_id>

<title>
Systems and methods for correcting error in a first classifier by evaluating classifier output in parallel
</title>

<abstract>
Systems and methods for classifying a test object are provided. For each respective target object in a plurality of target objects, a first procedure is performed comprising (a) posing the test object against the respective target thereby obtaining an interaction between the test and target, and (b) scoring the interaction with a first classifier. Each such score across the plurality of targets forms a test vector that is inputted into a second classifier thereby obtaining an indication of a target object. The second classifier is trained on training vectors, each being the output from instances of the first classifier after inputting a corresponding training object in a plurality of training objects in accordance with the first procedure. Each object in one subset of the training objects is uniquely associated with one of the targets. Another subset of the training objects is not associated with the targets.
</abstract>

<claims>
1. A computer system for classification of a test object, the computer system comprising: at least one processor; and nontransitory memory addressable by the least one processor, the nontransitory memory storing one or more programs for execution by the at least one processor, the one or more programs comprising instructions for: (A) obtaining a description of the test object; (B) for each respective target object in a first plurality of target objects, performing a first procedure comprising: (i) posing the description of the test object against the respective target object thereby obtaining a description of an interaction between the test object and the respective target object, and (ii) inputting the description of the interaction between the test object and the respective target object to a first classifier thereby obtaining a corresponding score for the interaction between the test object and the respective target object from the first classifier, wherein each corresponding score for the interaction between the test object and a respective target object across the first plurality of target objects forms a test vector for the test object; and (C) inputting the test vector for the test object to a second classifier thereby obtaining a transformation for the test vector as output from the second classifier, wherein the transformation provides an indication of a single target object in the first plurality of target objects, the second classifier is trained on a plurality of training vectors, each respective training vector in the plurality of training vectors is the output from the first classifier after inputting a corresponding training object in a first plurality of training objects as a test object in accordance with the first procedure, each training object in a first subset of the first plurality training objects is uniquely associated with a corresponding target object in the first plurality of target objects, and each training object in a second subset of the first plurality of training objects is associated with no target object in the first plurality of target objects.
2. The computer system of claim 1, wherein the posing the description of the test object against the respective target object thereby obtaining a description of an interaction between the test object and the respective target object is performed by a second procedure that comprises: modeling the test object with the respective target object in each pose of a plurality of different poses, thereby creating a plurality of voxel maps, wherein each respective voxel map in the plurality of voxel maps comprises the test object in a respective pose in the plurality of different poses, and unfolding each voxel map in the plurality of voxel maps into a corresponding first classifier input vector, thereby creating a plurality of first classifier input vectors, wherein each first classifier input vector in the plurality of first classifier input vectors is the same size, and wherein the inputting the description of the interaction between the test object and the respective target object to a first classifier comprises: inputting each respective first classifier input vector in the plurality of first classifier input vectors to the first classifier.
3. The computer system of claim 2, wherein the first classifier comprises a network architecture that includes (i) an input layer for sequentially receiving respective first classifier input vectors in the plurality of first classifier input vectors, (ii) a plurality of convolutional layers, and (iii) a scorer, wherein the plurality of convolutional layers includes an initial convolutional layer and a final convolutional layer, each layer in the plurality of convolutional layers is associated with a different set of weights, and responsive to the inputting of a respective first classifier input vector in the plurality of first classifier input vectors to the first classifier, the input layer feeds a first plurality of values into the initial convolutional layer as a first function of values in the respective first classifier input vector, each respective convolutional layer, other than the final convolutional layer, feeds intermediate values, as a respective second function of (i) the different set of weights associated with the respective convolutional layer and (ii) input values received by the respective convolutional layer, into another convolutional layer in the plurality of convolutional layers, and the final convolutional layer feeds final values, as a third function of (i) the different set of weights associated with the final convolutional layer and (ii) input values received by the final convolutional layer, into the scorer; wherein the second procedure further comprises: obtaining a plurality of scores from the scorer, wherein each score in the plurality of scores corresponds to the input of a first classifier input vector in the plurality of first classifier input vectors into the input layer, and using the plurality of scores to obtain the description of the interaction between the test object and the respective target object.
4. The computer system of claim 3, wherein the scorer comprises a plurality of fully-connected layers and an evaluation layer, and a fully-connected layer in the plurality of fully-connected layers feeds into the evaluation layer.
5. The computer system of claim 3, wherein the scorer comprises an implementation of a decision tree, a multiple additive regression tree, a clustering algorithm, principal component analysis, a nearest neighbor analysis, a linear discriminant analysis, a quadratic discriminant analysis, a support vector machine, an evolutionary method, a projection pursuit, a logistic regression, or ensembles thereof.
6. The computer system of claim 3, wherein a convolutional layer in the plurality of convolutional layers has a plurality of filters, and each filter in the plurality of filters convolves a cubic input space of N3 with stride Y, wherein N is an integer of two or greater and Y is a positive integer.
7. The computer system of claim 6, wherein the different set of weights associated with the convolutional layer are associated with respective filters in the plurality of filters.
8. The computer system of claim 3, wherein the scorer comprises a plurality of fully-connected layers and a logistic regression cost layer, and a fully-connected layer in the plurality of fully-connected layers feeds into the logistic regression cost layer.
9. The computer system of claim 3, wherein the computer system further comprises a graphical processing unit having a graphical processing memory, and the graphical processing memory comprises the network architecture.
10. The computer system of claim 2, wherein each first classifier input vector in the plurality of first classifier input vectors is one-dimensional.
11. The computer system of claim 2, wherein the plurality of different poses comprises 2 or more poses, 10 or more poses, 100 or more poses, or 1000 or more poses.
12. The computer system of claim 2, wherein the plurality of different poses is obtained using a docking scoring function in one of a Markov chain Monte Carlo sampling, simulated annealing, a Lamarckian Genetic Algorithm, a genetic algorithm, or a deep convolutional neural net sampling.
13. The computer system of claim 2, wherein the plurality of different poses is obtained by incremental search using a greedy algorithm.
14. The computer system of claim 2, wherein the second procedure further comprises: obtaining a plurality of scores from the first classifier, wherein each score in the plurality of scores corresponds to the input of a first classifier input vector in the plurality of first classifier input vectors into the first classifier, and using the plurality of scores to obtain the description of the interaction between the test object and the respective target object, and wherein the test object is a chemical compound, and the using the plurality of scores to obtain the description of the interaction between the test object and the respective target object comprises taking a measure of central tendency of the plurality of scores, wherein when the measure of central tendency satisfies a predetermined threshold value or predetermined threshold value range, the description of the interaction between the test object and the respective target object is deemed to have a first classification, and when the measure of central tendency fails to satisfy the predetermined threshold value or predetermined threshold value range, the description of the interaction between the test object and the respective target object is deemed to have a second classification.
15. The computer system of claim 14, wherein the first classification is a prediction that the test object binds to the respective target object with an IC50, EC50, Kd, KI, or percent inhibition that is below a first binding value, and the second classification is a prediction that the test object binds to the respective target object with an IC50, EC50, Kd, KI or percent inhibition that is above the first binding value.
16. The computer system of claim 15, wherein the first binding value is one micromolar.
17. The computer system of claim 15, wherein the first binding value is ten micromolar.
18. The computer system of claim 2, wherein the second procedure further comprises: obtaining a plurality of scores from the first classifier, wherein each score in the plurality of scores corresponds to the input of a first classifier input vector in the plurality of first classifier input vectors into the first classifier, and using the plurality of scores to obtain the description of the interaction between the test object and the respective target object, and wherein the using the plurality of scores to obtain the description of the interaction between the test object and the respective target object comprises taking a weighted average of the plurality of scores, wherein when the weighted average satisfies a predetermined threshold value or predetermined threshold value range, the test object is deemed to have a first classification, and when the weighted average fails to satisfy the predetermined threshold value or predetermined threshold value range, the test object is deemed to have a second classification.
19. The computer system of claim 18 wherein the weighted average is a Boltzman average of the plurality of scores.
20. The computer system of claim 18, wherein the first classification is an IC50, EC50, Kd, KI, or percent inhibition for the test object with respect to the respective target object that is above a first binding value, and the second classification is an IC50, EC50, Kd, KI or percent inhibition for the test object with respect to the respective target object that is below the first binding value.
21. The computer system of claim 18, wherein the first binding value is one micromolar.
22. The computer system of claim 18, wherein the first binding value is ten micromolar.
23. The computer system of claim 2, wherein a respective target object in the first plurality of target objects is a polymer with an active site, the test object is a chemical composition, the modeling the test object with the respective target object in each pose of a plurality of different poses comprises performing a molecular dynamics run of an atomic representation of the test object bound to an atomic representation of the respective target object thereby forming a trajectory of the test object and the respective target object together over time, and at least a subset of the plurality of different poses is obtained by taking snapshots of the trajectory over a period of time.
24. The computer system of claim 1, wherein each target object in the first plurality of different target objects is a polymer.
25. The computer system of claim 24, wherein the polymer is a protein, a polypeptide, a polynucleic acid, a polyribonucleic acid, a polysaccharide, or an assembly of any combination thereof.
26. The computer system of claim 1, wherein a respective target object in the first plurality of target objects is a polymer, and the posing the description of the test object against the respective target object comprises posing the description of the test object against spatial coordinates for the respective target object in the form of a set of three-dimensional coordinates {x1, . . . , xN} for a crystal structure of the polymer resolved at a resolution of 2.5 Å or better.
27. The computer system of claim 1, wherein a respective target object in the first plurality of target objects is a polymer, and the posing the description of the test object against the respective target object comprises posing the description of the test object against spatial coordinates for the respective target object in the form of a set of three-dimensional coordinates {x1, . . . , xN} for a crystal structure of the polymer resolved of 3.3 Å or better.
28. The computer system of claim 1, wherein a respective target object in the first plurality of target objects is a polymer, and the posing the description of the test object against the respective target object comprises posing the description of the test object of the target object against spatial coordinates for the respective target object in the form of an ensemble of three-dimensional coordinates for the polymer determined by nuclear magnetic resonance, neutron diffraction, or cryo-electron microscopy.
29. The computer system of claim 1, wherein each respective target object in the first plurality of target objects is a polymer with an active site, the test object is a chemical composition, and the posing the description of the test object against the respective target object comprises docking an atomic representation of the test object into an atomic representation of the active site of the polymer.
30. The computer system of claim 1, wherein the first classifier comprises a plurality of weights, the method further comprising, prior to the obtaining (A): (a) acquiring a training data set, the training data set comprising: a second plurality of training objects, a second plurality of target objects, and a plurality of experimentally determined scores, wherein each respective experimentally determined score in the plurality of experimentally determined scores is for the interaction between a corresponding training object in the second plurality of training objects and a corresponding target object in the second plurality of target objects, (b) for each respective training object in the second plurality of training objects, performing a second procedure comprising: (i) posing a description of the respective training object against a corresponding target object in the second plurality of target objects thereby obtaining a description of an interaction between the training object and the corresponding target object, (ii) inputting the description of the interaction between the respective training object and the corresponding target object to the first classifier thereby obtaining a corresponding score for the interaction between the training object and the corresponding target object from the first classifier, (iii) determining a differential between (1) the corresponding score from the first classifier for the description of the interaction between the respective training object and the corresponding target object and (2) the experimentally determined score for the interaction between the respective training object and the corresponding target object from the training data set, and (iv) applying the differential to the plurality of weights.
31. The computer system of claim 30 wherein the second plurality of target objects is the same as the first plurality of target objects.
32. The computer system of claim 30 wherein there is only partial overlap between the second plurality of target objects and the first plurality of target objects.
33. The computer system of claim 30 wherein there is no overlap between the second plurality of target objects and the first plurality of target objects.
34. The computer system of claim 30 wherein the first plurality of target objects is a subset of the second plurality of target objects.
35. The computer system of claim 30, wherein the second plurality of target objects is 50 or more target objects.
36. The computer system of claim 30, wherein the second plurality of target objects is 100 or more target objects.
37. The computer system of claim 30, wherein the second plurality of target objects is 250 or more target objects.
38. The computer system of claim 30, wherein the first plurality of training objects is the same as the second plurality of training objects.
39. The computer system of claim 30, wherein the first plurality of training objects is different than the second plurality of training objects.
40. The computer system of claim 1, wherein the first subset of the first plurality of training objects comprises 1000 training objects, the first plurality of target objects comprises 100 target objects, for each respective target object in the first plurality of target objects, the first subset of the first plurality of training objects includes at least 5 training objects that are uniquely associated with the respective target object, and the second subset of the first plurality of training objects comprises 10000 training objects.
41. The computer system of claim 1, wherein each respective training object in the first plurality of training objects is a chemical compound with a corresponding molecular fingerprint that is dissimilar to the molecular fingerprint of any training object in the first plurality of training objects that is not uniquely associated with the same target object as the respective training object.
42. The computer system of claim 41, wherein the corresponding molecular fingerprint is a Daylight fingerprint, a BCI fingerprint, an ECFP fingerprint, an ECFC fingerprint, an MDL fingerprint, an APFP fingerprint, a TTFP fingerprint, or a UNITY 2D fingerprint of the respective training object.
43. The computer system of claim 41, wherein the corresponding molecular fingerprint of the respective training object is deemed to be dissimilar to the molecular fingerprint of another training object in the first plurality of training objects when the Tanimoto coefficient between the respective training object and the molecular fingerprint of the other training object is less than 0.70.
44. The computer system of claim 41, wherein the corresponding molecular fingerprint of the respective training object is deemed to be dissimilar to the molecular fingerprint of another training object in the first plurality of training objects when the Tanimoto coefficient between the respective training object and the molecular fingerprint of the other training object is less than 0.50.
45. The computer system of claim 1, wherein the first classifier comprises a neural network or a support vector machine.
46. The computer system of claim 1, wherein the second classifier comprises a logistic regression algorithm, a random forest, a nonlinear regression model, a linear regression algorithm, a kernel method, a decision tree, multivariate splines (MARS), or a multiple additive regression tree.
47. The computer system of claim 1, wherein the test object is a chemical compound having a molecular weight of less than 2000 Daltons.
48. The computer system of claim 1, wherein the test object is a chemical compound that satisfies the Lipinski rule of five criterion.
49. The computer system of claim 1, wherein the test object is a chemical compound, and the description of the test object comprises modeled atomic coordinates for the chemical compound.
50. The computer system of claim 1, wherein the test object is a chemical compound, the respective target object comprises a polymer with a binding pocket, and the posing the description of the test object against the respective target object comprises docking modeled atomic coordinates for the chemical compound into atomic coordinates for the binding pocket.
51. The computer system of claim 1, wherein the corresponding score for the interaction between the test object and the respective target object from the first classifier is a numerical score.
52. The computer system of claim 1, wherein the corresponding score for the interaction between the test object and the respective target object from the first classifier is a numerical score between zero and one.
53. The computer system of claim 1, wherein the first plurality of target objects comprises 100 target objects and the test vector for the test object comprises 100 elements, each element for the score for the interaction between the test object and a respective target object in the first plurality of target objects from the first classifier.
54. A method for classification of a test object, the method comprising: (A) obtaining a description of the test object; (B) for each respective target object in a first plurality of target objects, performing a first procedure comprising: (i) posing the description of the test object against the respective target object thereby obtaining a description of an interaction between the test object and the respective target object, and (ii) inputting the description of the interaction between the test object and the respective target object to a first classifier thereby obtaining a corresponding score for the interaction between the test object and the respective target object from the first classifier, wherein each corresponding score for the interaction between the test object and a respective target object across the first plurality of target objects forms a test vector for the test object; and (C) inputting the test vector for the test object to a second classifier thereby obtaining a transformation for the test vector as output from the second classifier, wherein the transformation provides an indication of a single target object in the first plurality of target objects, the second classifier is trained on a plurality of training vectors, each respective training vector in the plurality of training vectors is the output from the first classifier after inputting a corresponding training object in a first plurality of training objects as a test object in accordance with the first procedure, each training object in a first subset of the first plurality training objects is uniquely associated with a corresponding target object in the first plurality of target objects, and each training object in a second subset of the first plurality of training objects is associated with no target object in the first plurality of target objects.
55. A non-transitory computer-readable storage medium having stored thereon instructions, which, when executed by a processor in a system for classification of a test object, cause the processor to perform the operations of: (A) obtaining a description of the test object; (B) for each respective target object in a first plurality of target objects, performing a first procedure comprising: (i) posing the description of the test object against the respective target object thereby obtaining a description of an interaction between the test object and the respective target object, and (ii) inputting the description of the interaction between the test object and the respective target object to a first classifier thereby obtaining a corresponding score for the interaction between the test object and the respective target object from the first classifier, wherein each corresponding score for the interaction between the test object and a respective target object across the first plurality of target objects forms a test vector for the test object; and (C) inputting the test vector for the test object to a second classifier thereby obtaining a transformation for the test vector as output from the second classifier, wherein the transformation provides an indication of a single target object in the first plurality of target objects, the second classifier is trained on a plurality of training vectors, each respective training vector in the plurality of training vectors is the output from the first classifier after inputting a corresponding training object in a first plurality of training objects as a test object in accordance with the first procedure, each training object in a first subset of the first plurality training objects is uniquely associated with a corresponding target object in the first plurality of target objects, and each training object in a second subset of the first plurality of training objects is associated with no target object in the first plurality of target objects.
</claims>
</document>

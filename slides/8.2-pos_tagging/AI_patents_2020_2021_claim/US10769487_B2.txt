<document>

<filing_date>
2018-04-17
</filing_date>

<publication_date>
2020-09-08
</publication_date>

<priority_date>
2018-02-26
</priority_date>

<ipc_classes>
G06K9/00,G06K9/46,G06K9/62,G06T11/20,G06T7/62,G06T7/90
</ipc_classes>

<assignee>
ABC FINTECH COMPANY
ABC FINTECH COMPANY
</assignee>

<inventors>
YANG YONGZHI
YU ZHOU
ZHANG, ZHANQIANG
</inventors>

<docdb_family_id>
63096781
</docdb_family_id>

<title>
Method and device for extracting information from pie chart
</title>

<abstract>
The present application relates to a method and a device for extracting information from a pie chart. The method comprises the following steps: detecting each element in a pie chart to be processed and position information thereof, wherein the elements comprise text elements and legend elements; performing text recognition on the detected text elements and legend elements to obtain text information corresponding to the text elements and legend texts included in the legend elements respectively; and obtaining sector information and legend information according to each detected element and position information thereof and the legend texts, and enabling the sector information to correspond to the legend information one by one, wherein the sector information comprises a sector color and a proportion of the sector in the pie chart, and the legend information comprises a legend color and a corresponding legend text thereof.
</abstract>

<claims>
1. A method for extracting information from a pie chart for display performed by an electronic device having a processor and memory for storing instruction to be executed by the processor, the method comprising: detecting, by the electronic device, each element in a pie chart to be processed and position information thereof, the elements comprising text elements and legend elements; performing, by the electronic device, text recognition on the detected text elements and legend elements to obtain text information corresponding to the text elements and legend texts included in the legend elements respectively; and obtaining, by the electronic device, sector information and legend information according to each detected element and position information thereof and the legend texts, and enabling, by the electronic device, the sector information to correspond to the legend information one by one, wherein the sector information comprises a sector color and a proportion of the sector in the pie chart, and the legend information comprises a legend color and a corresponding legend text thereof, wherein each element in the pie chart to be processed is detected by the electronic device by adopting a target detection method of a Faster R-CNN model and the Faster R-CNN model is pre-stored in the electronic device and derived via the following training method: step 1. randomly initializing learning parameters in the Faster R-CNN model; step 2. inputting a batch of training samples to the Faster R-CNN model to obtain a predicted classification probability pi and a predicted bounding box coordinate vector ti of the ith element box in the training samples under the current model parameters; step 3. performing loss calculation on the output result in step 2 by adopting the following formula, and solving the average loss L of all the element boxes in the batch of training samples, in which L({pi},{ti}) is the loss of the ith element box, Ncls is the value of mini-batch, Nreg is the number of anchor positions, λ is weight, is the logarithmic loss of a target and a non-target, and is a regression loss function; step 4. solving the minimum L, and updating all the learning parameters in the Faster R-CNN model; and step 5. repeatedly executing steps 2 to 4 until reaching a set number of iterations.
2. The method according to claim 1, wherein the legends of the pie chart to be processed are arranged from top to bottom and/or from left to right, and the sectors correspond to the legends one by one clockwise or anticlockwise; and the step of obtaining sector information and legend information according to each detected element and position information thereof and the legend texts and enabling the sector information to correspond to the legend information one by one comprises: obtaining each piece of legend information according to the color and legend text included in each detected legend element; calculating the proportion of each sector in the pie chart to be processed; extracting sector information of at least one sector which has a larger area, and enabling the sector information to correspond to the corresponding legend information; and enabling the sector information of the remaining sectors arranged clockwise or anticlockwise to correspond to the legend information of the legends arranged from top to bottom and/or from left to right one by one in sequence.
3. The method according to claim 2, wherein the pie chart to be processed comprises sector description texts, each sector description text comprises the proportion of each sector in the pie chart, and the step of calculating the proportion of each sector in the pie chart comprises: extracting the sector description text from the recognized text information; and enabling each sector in the pie chart to be processed to correspond to the corresponding sector description text one by one to obtain the proportion of the sector in the pie chart.
4. The method according to claim 3, wherein the sector description texts in the pie chart to be processed correspond to the legends one by one clockwise or anticlockwise; and the step of enabling each sector to correspond to the corresponding sector description text one by one comprises: counting the number of all pixels of the same color except for the background color in the pie chart to be processed in an RGB color space, and arranging the sectors in a descending order, one color representing one sector; selecting at least one color arranged in the front, calculating the center of gravity of the sector represented by the color according to the distribution area of the color pixels, and connecting the center of the pie chart with the center of gravity of the sector by taking the center of the pie chart as an origin to obtain the direction of the sector; by taking the center of the pie chart as the origin, connecting the center of the pie chart with the center of gravity of each sector description text to obtain the direction of the sector description text; matching the direction of the sector with the direction of each sector description text, and enabling the sector description text with minimum angle difference to correspond to the sector; and enabling the remaining sector description texts arranged clockwise or anticlockwise to correspond to the sectors arranged clockwise or anticlockwise one by one in sequence.
5. The method according to claim 2, wherein the step of calculating the proportion of each sector in the pie chart comprises: calculating an angle of each sector occupying in the pie chart by using an image processing algorithm to obtain the proportion of the sector in the pie chart.
6. The method according to claim 2, wherein the step of extracting sector information of at least one sector which has a larger area and enabling the sector information to correspond to the corresponding legend information comprises: counting the number of all pixels of the same color except for the background color in the pie chart to be processed in the RGB color space, and arranging the sectors in a descending order, one color representing one sector; selecting at least one color arranged in the front, and matching the color with the legend color to complete the matching of the extracted color and the corresponding legend information; and determining the proportion of the sector represented by the color which has been corresponding to the legend information in the pie chart to complete the corresponding between the sector information of at least one sector which has a larger area and the corresponding legend information.
7. The method according to claim 4, wherein the pie chart is a circular pie chart, and the center of the pie chart is determined via an image circle detection method.
8. The method according to claim 4, wherein the pie chart is a non-circular pie chart and the center of the pie chart is determined via the following method: determining the center of gravity of each sector description text around the pie chart; and estimating the center of the pie chart according to the center of gravity of each sector description text.
9. The method according to claim 1, wherein the pie chart to be processed further comprises a title, the method further comprising a step of determining a title text and a title position of the pie chart to be processed.
10. The method according to claim 1, further comprising: converting all the extracted elements of the pie chart to be processed into structured data, and visually displaying the structured data to reconstruct the pie chart.
11. An electronic device for extracting information from a pie chart for display, comprising: a processor; memory; and a plurality of computer instructions stored in the memory, wherein the computer instructions, when executed by the processor, cause the electronic device to perform operations including: detecting, by the electronic device, each element in a pie chart to be processed and position information thereof, the elements comprising text elements and legend elements; performing, by the electronic device, text recognition on the detected text elements and legend elements to obtain text information corresponding to the text elements and legend texts included in the legend elements respectively; and obtaining, by the electronic device, sector information and legend information according to each detected element and position information thereof and the legend texts, and enabling, by the electronic device, the sector information to correspond to the legend information one by one, wherein the sector information comprises a sector color and a proportion of the sector in the pie chart, and the legend information comprises a legend color and a corresponding legend text thereof, wherein each element in the pie chart to be processed is detected by the electronic device by adopting a target detection method of a Faster R-CNN model and the Faster R-CNN model is pre-stored in the electronic device and derived via the following training method: step 1. randomly initializing learning parameters in the Faster R-CNN model; step 2. inputting a batch of training samples to the Faster R-CNN model to obtain a predicted classification probability pi and a predicted bounding box coordinate vector ti of the ith element box in the training samples under the current model parameters; step 3. performing loss calculation on the output result in step 2 by adopting the following formula, and solving the average loss L of all the element boxes in the batch of training samples, in which L({pi},{ti}) is the loss of the ith element box, Ncls is the value of mini-batch, Nreg is the number of anchor positions, λ is weight, is the logarithmic loss of a target and a non-target, and is a regression loss function; step 4. solving the minimum L, and updating all the learning parameters in the Faster R-CNN model; and step 5. repeatedly executing steps 2 to 4 until reaching a set number of iterations.
12. The electronic device according to claim 11, wherein the legends of the pie chart to be processed are arranged from top to bottom and/or from left to right, and the sectors correspond to the legends one by one clockwise or anticlockwise; and the step of obtaining sector information and legend information according to each detected element and position information thereof and the legend texts and enabling the sector information to correspond to the legend information one by one comprises: obtaining each piece of legend information according to the color and legend text included in each detected legend element; calculating the proportion of each sector in the pie chart to be processed; extracting sector information of at least one sector which has a larger area, and enabling the sector information to correspond to the corresponding legend information; and enabling the sector information of the remaining sectors arranged clockwise or anticlockwise to correspond to the legend information of the legends arranged from top to bottom and/or from left to right one by one in sequence.
13. A non-transitory computer readable storage medium comprising computer readable instructions that, when executed by a processor of an electronic device having a display, cause the electronic device to perform operations including: detecting, by the electronic device, each element in a pie chart to be processed and position information thereof, the elements comprising text elements and legend elements; performing, by the electronic device, text recognition on the detected text elements and legend elements to obtain text information corresponding to the text elements and legend texts included in the legend elements respectively; and obtaining, by the electronic device, sector information and legend information according to each detected element and position information thereof and the legend texts, and enabling, by the electronic device, the sector information to correspond to the legend information one by one, wherein the sector information comprises a sector color and a proportion of the sector in the pie chart, and the legend information comprises a legend color and a corresponding legend text thereof, wherein each element in the pie chart to be processed is detected by the electronic device by adopting a target detection method of a Faster R-CNN model and the Faster R-CNN model is pre-stored in the electronic device and derived via the following training method: step 1. randomly initializing learning parameters in the Faster R-CNN model; step 2. inputting a batch of training samples to the Faster R-CNN model to obtain a predicted classification probability pi and a predicted bounding box coordinate vector ti of the ith element box in the training samples under the current model parameters; step 3. performing loss calculation on the output result in step 2 by adopting the following formula, and solving the average loss L of all the element boxes in the batch of training samples, in which L({pi},{ti}) is the loss of the ith element box, Ncls is the value of mini-batch, Nreg is the number of anchor positions, λ is weight, is the logarithmic loss of a target and a non-target, and is a regression loss function; step 4. solving the minimum L, and updating all the learning parameters in the Faster R-CNN model; and step 5. repeatedly executing steps 2 to 4 until reaching a set number of iterations.
14. The non-transitory computer readable storage medium according to claim 13, wherein the legends of the pie chart to be processed are arranged from top to bottom and/or from left to right, and the sectors correspond to the legends one by one clockwise or anticlockwise; and the step of obtaining sector information and legend information according to each detected element and position information thereof and the legend texts and enabling the sector information to correspond to the legend information one by one comprises: obtaining each piece of legend information according to the color and legend text included in each detected legend element; calculating the proportion of each sector in the pie chart to be processed; extracting sector information of at least one sector which has a larger area, and enabling the sector information to correspond to the corresponding legend information; and enabling the sector information of the remaining sectors arranged clockwise or anticlockwise to correspond to the legend information of the legends arranged from top to bottom and/or from left to right one by one in sequence.
</claims>
</document>

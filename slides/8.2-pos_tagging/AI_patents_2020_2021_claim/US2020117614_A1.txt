<document>

<filing_date>
2019-12-16
</filing_date>

<publication_date>
2020-04-16
</publication_date>

<priority_date>
2018-02-13
</priority_date>

<ipc_classes>
G06F12/084,G06F12/0871,G06F12/1081,G06F9/30,G06F9/4401,G06F9/54,G06N3/08
</ipc_classes>

<assignee>
SHANGHAI CAMBRICON INFORMATION TECHNOLOGY COMPANY
</assignee>

<inventors>
WANG, BINGRUI
ZHANG, YAO
</inventors>

<docdb_family_id>
70162481
</docdb_family_id>

<title>
COMPUTING DEVICE AND METHOD
</title>

<abstract>
The present disclosure provides a computation device. The computation device is configured to perform a machine learning computation, and includes an operation unit, a controller unit, and a conversion unit. The storage unit is configured to obtain input data and a computation instruction. The controller unit is configured to extract and parse the computation instruction from the storage unit to obtain one or more operation instructions, and to send the one or more operation instructions and the input data to the operation unit. The operation unit is configured to perform operations on the input data according to one or more operation instructions to obtain a computation result of the computation instruction. In the examples of the present disclosure, the input data involved in machine learning computations is represented by fixed-point data, thereby improving the processing speed and efficiency of training operations.
</abstract>

<claims>
1. A computation device, comprising a storage unit, a conversion unit, an operation unit, and a controller unit, wherein: the storage unit comprises a cache and a register; the controller unit is configured to determine a decimal point position of first input data and a bit width of fixed-point data; the bit width of the fixed-point data is the bit width of the first input data converted into the fixed-point data; the operation unit is configured to initialize the decimal point position of the first input data and adjust the decimal point position of the first input data; and store the adjusted decimal point position of the first input data in the cache of the storage unit; the controller unit is configured to obtain the first input data and a plurality of operation instructions from the register, and obtain the adjusted decimal point position of the first input data and the first input data from the cache; and transmit the adjusted decimal point position of the first input data and the first input data to the conversion unit; the conversion unit is configured to convert the first input data into a second input data according to the adjusted decimal point position of the first input data; wherein adjusting the decimal point position of the first input data by the operation unit includes: adjusting the decimal point position of the first input data upwardly by a single step according to a maximum absolute value of the first input data; or adjusting the decimal point position of the first input data upwardly step by step according to the maximum absolute value of the first input data; or adjusting the decimal point position of the first input data upwardly by a single step according to the first input data distribution; or adjusting the decimal point position of the first input data upwardly step by step according to the first input data distribution; or adjusting the decimal point position of the first input data downwardly according to the absolute value of the first input data.
2. The computation device of claim 1, wherein initializing the decimal point position of the first input data by the operation unit includes: initializing the decimal point position of the first input data according to the maximum absolute value of the first input data, initializing the decimal point position of the first input data according to the minimum absolute value of the first input data, initializing the decimal point position of the first input data according to a relationship between different data types of the first input data, or initializing the decimal point position of the first input data according to an empirical constant.
3. The computation device of claim 1, wherein the computation device is configured to execute a machine learning computation, the controller unit is further configured to transmit the plurality of operation instructions to the operation unit, the conversion unit is further configured to transmit the second input data to the operation unit, and the operation unit is further configured to perform operations on the second input data according to the plurality of operation instructions to obtain an operation result.
4. The computation device of claim 3, wherein the machine learning computation includes an artificial neural network operation, the first input data includes an input neuron and a weight, and the computation result is an output neuron.
5. The computation device of claim 3, wherein the operation unit includes a primary processing circuit and a plurality of secondary processing circuits, wherein: the primary processing circuit is configured to perform pre-processing on the second input data and to transmit data and the plurality of operation instructions between the plurality of secondary processing circuits and the primary processing circuit, the plurality of secondary processing circuits is configured to perform an intermediate operation to obtain a plurality of intermediate results according to the second input data and the plurality of operation instructions transmitted from the primary processing circuit, and to transmit the plurality of intermediate results to the primary processing circuit, and the primary processing circuit is further configured to perform post-processing on the plurality of intermediate results to obtain the computation result of the computation instruction.
6. The computation device of claim 5, further comprising a direct memory access (DMA) unit, wherein: the cache includes a scratch pad cache and is configured to store the first input data, and the register is configured to store scalar data in the first input data, and the DMA unit is configured to read data from the storage unit or store data in the storage unit.
7. The computation device of claim 3, wherein when the first input data is fixed-point data, the operation unit further includes: a derivation unit configured to derive a decimal point position of at least one intermediate result according to the decimal point position of the first input data, wherein the at least one intermediate result is obtained by operating according to the first input data.
8. The computation device of claim 7, wherein the operation unit further includes: a data cache unit configured to cache the one or more intermediate results.
9. The computation device of claim 3, wherein the operation unit includes a tree module, wherein: the tree module includes a root port coupled with the primary processing circuit and a plurality of branch ports coupled with the plurality of secondary processing circuits, and the tree module is configured to forward data and the plurality of operation instructions transmitted between the primary processing circuit and the plurality of secondary processing circuits, wherein the tree module is an n-tree structure, the n being an integer greater than or equal to two.
10. The computation device of claim 3, wherein the operation unit further includes a branch processing circuit, wherein: the primary processing circuit is configured to: determine that the input neurons are broadcast data and the weights are distribution data, divide the distribution data into a plurality of data blocks, and transmit at least one of the plurality of data blocks, the broadcast data, and at least one of the plurality of operation instructions to the branch processing circuit, the branch processing circuit is configured to forward the data blocks, the broadcast data, and the plurality of operation instructions transmitted between the primary processing circuit and the plurality of secondary processing circuits, the plurality of secondary processing circuits is configured to perform operations on the data blocks received and the broadcast data received according to the plurality of operation instructions to obtain a plurality of intermediate results, and to transmit the plurality of intermediate results to the branch processing circuit, and the primary processing circuit is further configured to perform post-processing on the plurality of intermediate results received from the branch processing circuit to obtain a computation result of the computation instruction, and to send the computation result of the computation instruction to the controller unit.
11. The computation device of claim 3, wherein the plurality of secondary processing circuits is distributed in an array, wherein: each secondary processing circuit is coupled with adjacent other secondary processing circuits, and the primary processing circuit is coupled with K secondary processing circuits of the plurality of secondary processing circuits, the K secondary processing circuits include n secondary processing circuits in the first row, n secondary processing circuits in the mth row, and m secondary processing circuits in the first column, and the K secondary processing circuits are configured to forward data and instructions transmitted between the primary processing circuit and the plurality of secondary processing circuits, the primary processing circuit is further configured to: determine that the input neurons are broadcast data, the weights are distribution data, divide the distribution data into a plurality of data blocks, and transmit at least one of the plurality of data blocks and at least one of the plurality of operation instructions to the K secondary processing circuits, the K secondary processing circuits are configured to convert the data transmitted between the primary processing circuit and the plurality of secondary processing circuits, the plurality of secondary processing circuits is configured to perform operations on the data blocks according to the plurality of operation instructions to obtain a plurality of intermediate results, and to transmit the plurality of intermediate results to the K secondary processing circuits, and the primary processing circuit is configured to process the plurality of intermediate results received from the K secondary processing circuits to obtain the computation result of the computation instruction, and to send the computation result of the computation instruction to the controller unit.
12. The computation device of claim 9, wherein: the primary processing circuit is configured to perform a combined ranking processing on the plurality of intermediate results received from the plurality of processing circuits to obtain a computation result of the computation instruction, or the primary processing circuit is configured to a combined ranking processing and an activation processing on the plurality of intermediate results received from the plurality of processing circuits to obtain the computation result of the computation instruction.
13. The computation device of claim 9, wherein the primary processing circuit includes one or any combination of an activation processing circuit and an addition processing circuit, wherein: the activation processing circuit is configured to perform an activation operation on data in the primary processing circuit, and the addition processing circuit is configured to perform an addition operation or an accumulation operation, and the plurality of secondary processing circuit includes: a multiplication processing circuit configured to perform a multiplication operation on the data blocks received to obtain a product result, and an accumulation processing circuit configured to perform an accumulation operation on the product results to obtain the plurality of intermediate results.
14. A machine learning operation device, comprising one or more computation devices according to claim 3, wherein the at least one computation device is configured to obtain data to be processed and control information from other processing devices, to perform specified machine learning computations, and to transmit an execution result to the other processing devices through I/O interfaces, wherein: when the machine learning operation device includes a plurality of the computation devices, the plurality of computation devices is configured to couple and transmit data with each other through a specific structure, and the plurality of computation devices is configured to: interconnect and transmit data through a fast external device interconnection PCIE (peripheral component interface express) bus to support larger-scale machine learning computations, share the same one control system or have respective control systems, share the same one memory or have respective memories, and deploy an interconnection manner of any arbitrary interconnection topology.
15. A computation method, comprising: determining, by the controller unit, the decimal point position of the first input data and the bit width of the fixed-point data, wherein the bit width of the fixed-point data is the bit width of the first input data converted into the fixed-point data, initializing, by the operation unit, the decimal point position of the first input data, and adjust, by the operation unit, the decimal point position of the first input data, obtaining, by the conversion unit, the adjusted decimal point position of the first input data, and converting, by the conversion unit, the first input data into the second input data according to the adjusted decimal point position of the first input data; wherein adjusting the decimal point position of the first input data by the operation unit includes: adjusting the decimal point position of the first input data upwardly by a single step according to the maximum absolute value of the first input data, or adjusting the decimal point position of the first input data upwardly step by step according to the maximum absolute value of the first input data, or adjusting the decimal point position of the first input data upwardly by a single step according to the first input data distribution, or adjusting the decimal point position of the first input data upwardly step by step according to the first input data distribution, or adjusting the decimal point position of the first input data downwardly according to the absolute value of the first input data.
16. The method of claim 15, wherein the method is configured to execute the machine learning computation, and further includes: performing, by the operation unit, the operations on the second input data according to the plurality of operation instructions to obtain the computation result.
17. The method of claim 16, wherein the machine learning computation includes the artificial neural network operation, the first input data includes the input neuron and the weight, and the computation result is the output neuron.
18. The method of claim 17, wherein when the first input data is the fixed-point data, the method further includes: deriving a decimal point position of one or more intermediate results according to the decimal point position of the first input data, wherein the one or more intermediate results are obtained by operating according to the first input data.
</claims>
</document>
